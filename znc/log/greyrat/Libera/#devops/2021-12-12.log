[01:47:57] *** Joins: Umbra (uid67136@user/umbra)
[02:07:36] *** Quits: phost (~phost@162.198.54.77.rev.vodafone.pt) (Ping timeout: 256 seconds)
[02:29:18] *** edk is now known as demiurge
[03:09:28] *** Joins: Brainium (~brainium@user/brainium)
[04:19:19] *** Quits: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de) (Ping timeout: 250 seconds)
[04:46:01] *** Quits: predmijat (~predmijat@mail.strogopro.com) (Quit: bye)
[04:47:37] *** Joins: predmijat (~predmijat@mail.strogopro.com)
[05:23:06] *** Quits: Brainium (~brainium@user/brainium) (Quit: Konversation terminated!)
[05:41:33] *** Joins: AsenMx (~AsenMx@user/asenmx)
[05:41:37] <AsenMx> Hello, I have a blog/forum hosted on AWS that is using cloudfront. Sadly I have to do a lot of invalidations when someone is editing their post/comment. The price I pay for invalidations per month is insane any idea how to avoid invalidations?
[07:46:59] *** launchd is now known as BuddyTheElf
[12:49:18] <rawtaz> i dont use cloudfront but i dont get what you mean. what "invalidations" (of what?) are you talking about, and how is that related to people editing posts/comment on the website?
[13:37:22] *** Joins: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de)
[13:44:22] *** Joins: menace (~someone@ppp-93-104-175-20.dynamic.mnet-online.de)
[13:44:43] *** Quits: menace (~someone@ppp-93-104-175-20.dynamic.mnet-online.de) (Changing host)
[13:44:43] *** Joins: menace (~someone@user/menace)
[15:13:28] *** Joins: Brainium (~brainium@user/brainium)
[16:16:47] *** Joins: ajunior (~ajunior@189-49-228-177.user3p.veloxzone.com.br)
[17:01:30] *** Joins: phost (~phost@162.198.54.77.rev.vodafone.pt)
[17:41:46] *** Quits: Brainium (~brainium@user/brainium) (Quit: Konversation terminated!)
[17:48:30] *** Quits: ajunior (~ajunior@189-49-228-177.user3p.veloxzone.com.br) (Ping timeout: 260 seconds)
[17:56:47] *** Quits: viq|w (~viq@user/viq) (Quit: WeeChat 3.3)
[18:18:00] *** Joins: Nex6 (~Nex6@cpe-45-51-244-112.socal.res.rr.com)
[18:24:26] *** Quits: Nex6 (~Nex6@cpe-45-51-244-112.socal.res.rr.com) (Ping timeout: 260 seconds)
[18:55:31] *** Quits: AsenMx (~AsenMx@user/asenmx) (Ping timeout: 250 seconds)
[18:55:47] *** Joins: AsenMx (~AsenMx@user/asenmx)
[19:12:39] *** Quits: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de) (Remote host closed the connection)
[20:25:42] *** Quits: bedroller (~fling@user/fling) (Quit: ZNC 1.8.2+deb2+b1 - https://znc.in)
[20:38:00] *** Joins: fling (~fling@user/fling)
[20:48:34] *** Joins: jenhsun (uid342237@id-342237.hampstead.irccloud.com)
[20:49:26] *** Quits: jenhsun (uid342237@id-342237.hampstead.irccloud.com) (Client Quit)
[21:14:37] <slaughter> Yeah that doesn't make a ton of sense. Are you creating like new pages for posts and comments? If you're using JS or something to read from a DB to display comments/posts you shouldn't need any invalidations AsenMx 
[21:25:25] *** Joins: viq|w (~viq@user/viq)
[21:26:46] *** Joins: bn_work (uid268505@id-268505.uxbridge.irccloud.com)
[21:44:59] <AsenMx> rawtaz, well invalidations is just forcing to renew the cache
[21:45:53] <rawtaz> ah ok
[21:53:40] *** Joins: lilgopher (~textual@2601:241:8000:38f0:499:a498:84f3:5d6f)
[21:53:43] <slaughter> AsenMx what does your setup look like that you need to do invalidations for new posts/comments. Literally never had to do that for any app I've run through cloudfront
[22:01:05] <Joel> AsenMx stop repeating questions over and over.
[22:01:40] <Joel> whoops, I'm the dick, I thought this was ##aws
[22:01:45] <Joel> he was given a pile of solutions over there
[22:02:16] <lantech19446> are you even an op over there Joel you certainly seem to think you run the channel
[22:02:41] <Joel> lantech19446 are you seeking a reaction?
[22:03:11] <lantech19446> I asked you a legitimate question, we've already established you take offence to any question i ask
[22:03:37] <Joel> slaughter makes sense to cache blog posts, which may have comments, if they're pulled in via json, it's pretty trivial to cache them separately, which also makes sense, comments can load in while someone's reading/skimming the blog
[22:03:46] <Joel> lantech19446 are you seeking a reaction?
[22:04:01] <lantech19446> Joel: stop repeating the same questions over and over
[22:04:18] <rawtaz> :D
[22:04:19] <Joel> lantech19446 I legitimately want to know
[22:04:29] <lantech19446> i gave you an answer
[22:04:31] <slaughter> Ah ok yeah if it's a high traffic blog or whatever I can see that. Seems like a misconfig on cache timeout/lack of functionality to handle the cache 
[22:04:32] <Joel> lantech19446 what are you hoping to achieve right now?
[22:04:37] <rawtaz> guys, let's just be friends :3 life is just too short and problematic to argue over things that doesnt matter
[22:04:45] * rawtaz learnt the hard way
[22:04:55] <slaughter> It's Sunday y'all we're not even getting paid to argue right now
[22:04:56] <Joel> rawtaz he clearly wants a reaction, just trying to make sure I give him the one he wants *shrug* lol
[22:05:01] *** Quits: lilgopher (~textual@2601:241:8000:38f0:499:a498:84f3:5d6f) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[22:05:14] <lantech19446> I just want to know who you are if you even have the authority to talk to me the way you do since even other users in the room told you to shut up
[22:05:19] <rawtaz> Joel: gotcha :) dont waste your energy though
[22:05:28] <Joel> slaughter that was one of the pile of ideas I gave him over in ##aws
[22:05:29] <rawtaz> lantech19446: same to you, focus on something more important in life :D
[22:05:33] <Joel> slaughter different expireys based on routes
[22:05:42] <rawtaz> look at this smiley face ------> :DD
[22:06:03] <lantech19446> rawtaz: if he's just a nobody i'll put him on ignore and be done with it
[22:06:29] <rawtaz> lantech19446: you dont have to care at all
[22:07:06] <Joel> I gave him the reaction he wanted.
[22:07:48] <rawtaz> bet it was something sexual like poking him with a cactus
[22:08:21] <lantech19446> there now i'm done with him
[22:08:27] <rawtaz> good :3
[22:08:44] <Joel> rawtaz prickly pear!
[22:08:50] <lantech19446> he's kind of a douche, I asked an honest question about the aws cert training and he's trying to rake me over the coals for it
[22:08:54] <slaughter> Y'all know the internet isn't real, right?
[22:09:03] <rawtaz> lol yeah that one
[22:09:06] <lantech19446> like even other users in the channel were telling him to calm his tits
[22:09:15] <slaughter> This place literally doesn't exist
[22:09:20] <rawtaz> slaughter: i sure hope not! wouldnt want to live in some kind of reality.
[22:09:30] <slaughter> lmfao nice
[22:09:36] <slaughter> rawtaz I like the cut of your jib 
[22:09:43] <slaughter> Whatever that means
[22:09:51] <rawtaz> it's thanks to your splendid openings :3
[22:10:11] <Joel> gotta collect all the interwebz poitns
[22:10:35] <rawtaz> and to think that we were on a streak, when andrew lee just spoiled it all :<
[22:10:35] <slaughter> Wait we get points here? I love collecting pixels
[22:10:41] <rawtaz> the momentum we had built on that network
[22:11:09] <Joel> slaughter I have more mitten lint than you!!
[22:11:56] <lantech19446> lol lil bitch banned me in the channel
[22:12:37] <Joel> slaughter not sure if his commenting was on a separate page, but the third solution i suggested was adjusting the uri string after commenting
[22:12:43] <Joel> since that's how cloudfront determines cache
[22:13:18] <Joel> though, I think that could work when backed by ajax, as well
[22:14:03] <slaughter> Yeah caching on params is probably a good approach
[22:14:16] <slaughter> I don't recall specifics but I've setup something similar in the past
[22:15:57] <slaughter> And apparently don't still have the repo, that's a real bummer
[22:16:54] <Joel> I had the wrong impression for a long time, or maybe things changed, I don't know. I used to think you paid per FILE for invalidation, but you actually only per invalidation REQUEST in aws.
[22:17:05] <Joel> but yeah, invaliding to get new comments to show up seems bad
[22:17:23] *** Joins: Nex6 (~Nex6@cpe-45-51-244-112.socal.res.rr.com)
[22:17:25] <Joel> I haven't done front end in over a decade, is iframing still a thing? lol
[22:18:36] <slaughter> Unfortunately yes, sometimes it's the only way to do it
[22:18:57] <slaughter> Especially if you're using AEM - working with that was just iframes for days
[22:22:01] <Joel> rawtaz is Pomerium like saml+vpn server?
[22:22:42] <kubblai> its a zero trust proxy afaik Joel sorry for answering for you rawtaz 
[22:23:03] <Joel> hrm interesting
[22:23:14] <kubblai> we used it at my last place
[22:23:33] <kubblai> we'd proxy oidc google auth via it for say gitlab
[22:23:50] <kubblai> all running in k8s was quite nice
[22:24:05] <Joel> why not use google as an idp, and log into gitlab via saml? why reach for the middle piece? is there extra benefits?
[22:24:33] <kubblai> because we had lots of other stuff behind it too like for example xwiki
[22:24:43] <Joel> gotchya, one umbrella is something I support
[22:24:58] <Joel> I'm fortunate to be dropping any need for vpn like crazy thanks to fargate
[22:25:32] <kubblai> the annoying thing about it is it doesnt support multiple providers at once
[22:25:39] <rawtaz> Joel: i wouldnt say that, it's an authentication gateway to so speak :o
[22:25:44] <rawtaz> kubblai: no, thanks!
[22:25:54] <Joel> kubblai multiple identity providers?
[22:26:21] <kubblai> so if part of your company uses okta and google then you need to use something else in the middle we figured that out with something else but i forget what sorry
[22:26:29] <rawtaz> kubblai: have you tried both pomerium and authelia (and possibly others)?
[22:26:33] *** Quits: Nex6 (~Nex6@cpe-45-51-244-112.socal.res.rr.com) (Ping timeout: 250 seconds)
[22:26:35] <Joel> ah, yeah
[22:27:07] <kubblai> only pomerium rawtaz we did look into authelia but i think it didnt fit our usecase
[22:27:12] <rawtaz> oh ok
[22:27:50] <kubblai> we also looked at pritunl zero which is super easy to get started with
[22:27:53] <egy> Joel: can you elaborate on the fargate part ?
[22:28:00] <kubblai> i had a poc in like an hour
[22:28:17] <egy> (wrt to needing a vpn connection)
[22:28:51] <kubblai> the problem we had with pritunl zero is its a one man band and after some comms with the dev we felt we might have security issues in a defense env
[22:29:04] <kubblai> its a really nice product tho
[22:29:47] <Joel> egy you have a background in aws?
[22:29:50] <kubblai> the pricing is super attractive too
[22:29:57] <egy> Joel: i do
[22:30:08] <Joel> egy ecs/eks can be backed by fargate, so there's no ec2 instances to manage.
[22:30:15] <Joel> egy nothing to ssh to.
[22:30:18] <egy> kubblai: looking into Pomerium, thanks for pointing it out in the open!
[22:30:36] <kubblai> egy have a look at printul zero too
[22:30:42] <Joel> kubblai I used the pritunl vpn stuff, the one band man thing was ugh, and he was not supportive of saml
[22:30:47] <kubblai> pritunl *
[22:30:52] <egy> aha, because fargate does the management
[22:31:04] <Joel> egy exactly, there's no exposure, tech or compliance wise, to manage
[22:31:31] <Joel> egy and in cases where you do have ec2 instances running, i HIGHLY recommend ssm, as a port is never left open, you can log everything run to s3, etc.
[22:32:05] <kubblai> we used ssm for high security environments its really awesome
[22:32:12] <Joel> yes, love it.
[22:32:15] <egy> oh right, i remember that trick. use session manager to log into your instance
[22:32:29] <Joel> yeah, and you can configure it on your computer, so it feels just like ssh
[22:32:30] <egy> but how do you elevate the need for logging into the aws console ?
[22:32:39] <Joel> ^ doesn't compute
[22:32:39] <rawtaz> Joel: you use saml for something?
[22:32:42] <egy> unless the aws cli is updated somehow
[22:32:44] <Joel> rawtaz all the things
[22:32:48] <rawtaz> nice
[22:32:53] <rawtaz> have you also used SCIM ?
[22:33:06] <Joel> rawtaz all my devs can go into gmail, click the icon thing, scroll past their calendar down to staging, prod, etc aws accounts
[22:33:15] <Joel> rawtaz I have not used SCIM
[22:33:23] <rawtaz> ice nice
[22:33:24] <rawtaz> +n
[22:33:39] <kubblai> joel do you work at the same place as my last job :P
[22:34:05] <Joel> kubblai hahaha, let's get ready to do an awkward stand off where we try not to identify ourselves or our last company O.O
[22:34:10] <egy> Joel: how do you avoid going to the aws console just to ssh into your ec2 machines ?
[22:34:25] <Joel> rawtaz I can see why SCIM is important though, the deprovisioning piece missing from saml is a pita
[22:34:26] <egy> s/ssh/log in/
[22:34:42] <Joel> egy https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html
[22:34:43] <kubblai> egy you portforward the ssh connection via the api
[22:35:12] <Joel> egy then you do this https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-start.html#sessions-start-ssh
[22:35:33] <egy> ok, let me have a look
[22:35:40] <kubblai> ssm_port_forward() {
[22:35:40] <kubblai> aws ssm start-session --document-name AWS-StartPortForwardingSession --parameters '{"portNumber":["'${1}'"],"localPortNumber":["'${4:-$1}'"]}' --target "$2" --profile "${3:-$AWS_PROFILE}"}
[22:35:40] <kubblai> alias ssmpf=ssm_port_forward
[22:35:56] <kubblai> stick that in your zshrc
[22:36:06] <egy> oh, i swear aws cli did not have support for ssm. neat
[22:36:21] <Joel> it's an easy thing to get any boss to buy into
[22:36:22] <kubblai> you need to have it enabled in iam for those instances tho
[22:36:57] <egy> wait, let me absorb that alias
[22:37:28] <kubblai> $2 is the instance id
[22:38:13] <egy> ok so $4 is the local port, $1 is the port on the machine
[22:38:27] <egy> ($4 is $1 by default)
[22:38:46] <egy> and you connect (via ssh client) locally on $1, right ?
[22:39:04] <kubblai> that one is mainly for rdp
[22:39:21] <kubblai> with the .sshconfig you can simply ssh instanceid
[22:39:37] <kubblai> with the right ssh config that is
[22:39:47] <kubblai> and providing you awsume the account
[22:40:09] <egy> aha
[22:40:28] <egy> neat alias
[22:40:41] <egy> unfortuantely logging is not support for sesssions w/ port forwarding
[22:40:42] <egy> > Logging isn't available for Session Manager sessions that connect through port forwarding or SSH
[22:40:51] <Joel> yeah, if your nodes aren't in an ASG the ssh config is the way to go
[22:40:54] <egy> bummer
[22:41:16] <Joel> Also, I don't mind that ssm is a little painful
[22:41:24] <Joel> because people shouldn't :)
[22:42:08] <egy> have you got around the logging issue ?
[22:43:46] <Joel> egy I no longer use ec2, so it's a non issue for me
[22:44:19] <egy> right
[22:45:47] <egy> ok another question, how do you live-debug a faulty instance/container on ecs ?
[22:46:43] <egy> i know you said you were using fargate, so there's no management overhead but i'd like to know your opinion
[22:47:12] <Joel> egy as of recently you can connect to them now, but I don't publish this.
[22:47:21] <Joel> It's up to my devs to implement proper logging and APM
[22:48:00] <Joel> https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/
[22:49:10] <Joel> legit conversation I've had "Why did my application stop?", "I don't know, you don't log much of anything, I said this was likely to be an issue when you where moving through staging", "How do I tell what's wrong then??", "Add logging and look at our doc on APM"
[22:52:08] <Joel> "I want to check how many of the records in elasticsearch have X in field Y", "Implement an endpoint that does this, send it through code review so others can verify you're not missing something you didn't think of, and deploy it."
[22:53:48] <egy> i see
[22:54:11] <egy> and you give them access to w/e your logging solution is, right ?
[22:54:42] <Joel> cloudwatch logs, yes.
[22:54:53] <Joel> as long as they log in structured json, and follow our guidelines there, it's trivial to use
[22:55:27] <Joel> if you're logging an error, and not setting {"error":1} then there's a special place in hell for you :)
[22:55:42] <egy> hahaha
[22:56:21] <egy> alright, thanks for the answers Joel 
[22:58:06] <Joel> egy take it all with salt, I'm sure others in here have other awesomeness I haven't got exposure to yet
[22:58:22] <Joel> time for me to go and try to collect cool points in real life so I can be way more awesomer than rawtaz 
[22:58:57] * egy gives +10 Kudos to Joel 
