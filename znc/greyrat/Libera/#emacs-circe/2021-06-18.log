[00:29:35] *** Quits: rememberYou (~someone@user/rememberyou) (Remote host closed the connection)
[00:55:18] *** Joins: trocado (~trocado@bl18-243-251.dsl.telepac.pt)
[05:28:35] *** Quits: notzmv (~zmv@user/notzmv) (Ping timeout: 244 seconds)
[07:28:21] *** Joins: notzmv (~zmv@user/notzmv)
[07:33:50] *** Quits: notzmv (~zmv@user/notzmv) (Ping timeout: 268 seconds)
[08:34:58] *** Joins: notzmv (~zmv@user/notzmv)
[10:37:26] *** Joins: irek (~irek@public-gprs177573.centertel.pl)
[12:21:12] *** Quits: trocado (~trocado@bl18-243-251.dsl.telepac.pt) (Ping timeout: 268 seconds)
[16:03:18] <greyrat> I have an emacs dedicated to IRC, and it is using more CPU than any other process on my system. Is this normal? 
[16:03:49] <wasamasa> I guess you're not running browsers
[16:04:34] <greyrat> wasamasa: I am! But browsers start many processes, thus any one of them still consumes less
[16:05:00] <wasamasa> https://github.com/lastquestion/explain-pause-mode
[16:05:07] <wasamasa> use this, maybe you'll find something worth fixing
[16:05:18] <bremner> greyrat: do you have any limits on buffer size?
[16:05:27] <wasamasa> I fixed the circe-color-nicks module performing badly with ZNC playbacks
[16:06:06] <greyrat> bremner: I don't have buffer size limits. Should I add one?
[16:06:36] <bremner> yes. Although that is more likely to help with memory consumption. But maybe you are triggering gc
[16:06:41] <greyrat> Currently emacs consumes 18% of CPU on my MBP, which is quite a bit.
[16:07:26] <greyrat> bremner: How do I add limits?
[16:08:44] <bremner> greyrat: customize lui-max-buffer-size
[16:08:48] <bremner> or set it
[16:09:22] <bremner> 40000 seems OK to me (about 600 lines worth in most channels)
[16:11:14] <greyrat> Thanks, I set it.
[16:14:58] <greyrat>   wasamasa: It seems the offedning fn is `irc--filter'
[16:15:09] <wasamasa> you need a full trace
[16:15:29] <wasamasa> that alone says as much as claiming that the CPU is the offending part of the computer
[16:16:02] <greyrat> Hmm. Here is that explain-pause buffer:
[16:16:06] <wasamasa> pastebin
[16:16:13] <greyrat> http://ix.io/3qkG
[16:16:18] <wasamasa> thanks
[16:16:30] <wasamasa> now repeat this, with the profiles expanded
[16:16:41] <wasamasa> â–º
[16:17:02] <greyrat> how do I expand them? pressing tab says the buffer is read-only
[16:17:29] <wasamasa> there's a few more keys to try, like RET, mouse-1, SPC, ...
[16:19:23] <wasamasa> hover over the thing, see if it changes appearance or even gives you a tooltip advertising the keys
[16:20:16] <greyrat> wasamasa: I think it's buggy. Clicking on the buffer throws an exception: https://github.com/lastquestion/explain-pause-mode/issues/95
[16:20:28] <greyrat> After that exception, nothing reacts to RET etc
[16:20:40] <wasamasa> you're using the terminal?
[16:20:50] <greyrat> I am
[16:20:54] <wasamasa> please don't
[16:21:18] <wasamasa> I mean, unless you like subjecting yourself to missing features, bugs and unnecessary pain in general
[16:21:24] <greyrat> I started a normal profiler/start
[16:21:56] <wasamasa> yeah, now do things and M-x profiler-report
[16:25:35] <wasamasa> wow: https://github.com/lastquestion/explain-pause-mode/issues/57
[16:28:08] <greyrat> wasamasa: http://sprunge.us/kS3oK3
[16:28:30] <greyrat> Is there a way to expand all entries in the profilerr report? I manually expanded most of them :facepalms:
[16:28:39] <wasamasa> prefix argument before hitting TAB
[16:28:49] <wasamasa> anyway, the greatest offender in this one is tab completion
[16:29:00] <wasamasa> there shouldn't be any need to use company in a circe buffer
[16:29:06] <wasamasa> circe provides inline completion
[16:29:35] <wasamasa> also, you use doom
[16:29:46] <wasamasa> that alone is reason enough for me to not give you any support
[16:29:48] <greyrat> wasamasa: So I should disable company for circe buffers?
[16:29:58] <wasamasa> you should not enable them in them in the first place
[16:30:06] <wasamasa> enable company with prog-mode-hook, maybe text-mode-hook
[16:30:11] <greyrat> I haven't. Must be a doom thing.
[16:30:13] <wasamasa> and a few other select modes not derived from them
[16:30:13] <wasamasa> yes
[16:30:21] <wasamasa> that's exactly why I don't want to give you any support
[16:30:30] <wasamasa> because I can't help you with doom or any other starter kit
[16:31:40] <wasamasa> the other performance drop I see here is with `lui-insert-with-text-properties'
[16:31:55] <wasamasa> which adds those and for some reason flycheck is run
[16:32:01] <wasamasa> again, no need for that to be enabled everywhere
[16:32:27] <wasamasa> but at this point I'm repeating myself
[16:32:36] <wasamasa> run a vanilla emacs config with just circe set up and compare CPU usage
[16:32:42] <wasamasa> it might be wildly different
[16:36:02] <greyrat> wasamasa: Well, I need doom and my config when I work with IRC, so I still need to find the offending parts and disable them. Just using the vanilla emacs doesn't help me. I will disable flycheck as well. Thanks!
[16:36:06] <wasamasa> consider going to their discord and asking them
[16:36:25] <wasamasa> I keep reading something about it being optimized and everything
[16:36:53] <wasamasa> sure, you can claim that for the parts of emacs you care about, but for every possible usage of emacs with that config, good luck
[16:40:48] *** Parts: greyrat (~greyrat@ip202.ip-51-178-215.eu) (linux)
[16:45:21] <greyrat> These changes helped a lot. Now emacs consumes around 1-7%.
[16:46:50] *** Joins: greyrat (~greyrat@ip202.ip-51-178-215.eu)
[16:46:50] *** Server sets mode: +nt 
[16:49:07] <greyrat> These changes helped a lot. Now emacs consumes around 1-7%.
[16:49:56] <wasamasa> nice
[16:50:16] <wasamasa> it would be great if you'd let the doom people know
[16:50:47] <greyrat> I will tell them
[16:50:56] <wasamasa> it might help beyond circe
[16:51:10] <wasamasa> generally, I'd try to be careful with global minor modes
[16:51:32] <greyrat> I am getting `Can not send to channel` on some channels, not sure if it's related to these changes or not. What can cause sucha message?
[16:51:49] <bremner> try a different client
[16:51:58] <wasamasa> that's the 404 numeric
[16:51:58] <bremner> (i.e hexchat or mac equivalent)
[16:52:12] <wasamasa> it's triggered by IRC things
[16:52:20] <wasamasa> like being banned on a channel and trying to change your nickname
[16:52:34] <greyrat> rejoining the channel solved that error
[16:53:12] <wasamasa> https://modern.ircdocs.horse/#errcannotsendtochan-404
[19:08:18] *** Quits: irek (~irek@public-gprs177573.centertel.pl) (Ping timeout: 240 seconds)
[20:35:09] *** Quits: bremner (~bremner@notmuch/developer/bremner) (Remote host closed the connection)
[21:35:19] *** Joins: bremner (~bremner@notmuch/developer/bremner)
[23:31:32] *** Joins: irek (~irek@public-gprs177573.centertel.pl)
[23:53:06] *** Quits: irek (~irek@public-gprs177573.centertel.pl) (Ping timeout: 264 seconds)
