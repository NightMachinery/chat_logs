[00:38:30] *** Quits: gh34 (~textual@cpe-184-58-181-106.wi.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[01:29:46] *** Joins: AbleBacon (~AbleBacon@user/AbleBacon)
[01:50:08] <rawtaz> ABLE BACON \o/
[02:11:39] *** Quits: spaceangel (~spaceange@ip-78-102-216-202.net.upcbroadband.cz) (Remote host closed the connection)
[02:45:24] *** Quits: pmercado (~pmercado@190.22.73.57) (Ping timeout: 260 seconds)
[03:05:21] *** Quits: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de) (Ping timeout: 256 seconds)
[03:09:53] *** Quits: kusanagi (~kusanagi@user/kusanagi) (Read error: Connection reset by peer)
[03:11:10] *** Joins: kusanagi (~kusanagi@user/kusanagi)
[03:56:11] *** Joins: epony (epony@user/epony)
[04:30:02] *** Quits: phaise (~phaise@gateway/tor-sasl/phaise) (Remote host closed the connection)
[04:30:59] *** Joins: phaise (~phaise@gateway/tor-sasl/phaise)
[04:46:01] *** Quits: predmijat (~predmijat@mail.strogopro.com) (Quit: bye)
[04:47:36] *** Joins: predmijat (~predmijat@mail.strogopro.com)
[05:33:35] *** Joins: kusanagi_ (~kusanagi@user/kusanagi)
[05:37:32] *** Quits: kusanagi (~kusanagi@user/kusanagi) (Ping timeout: 260 seconds)
[05:43:07] *** Quits: Church (~aleph@68.161.207.188) (Ping timeout: 256 seconds)
[05:59:04] *** Joins: Church (~aleph@68.161.207.188)
[06:44:31] *** Joins: pmercado (~pmercado@190.22.73.57)
[09:18:55] *** Quits: fling (~fling@user/fling) (Ping timeout: 240 seconds)
[09:36:07] *** Quits: pmercado (~pmercado@190.22.73.57) (Ping timeout: 246 seconds)
[11:58:33] *** Joins: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de)
[13:50:34] *** Quits: AbleBacon (~AbleBacon@user/AbleBacon) (Read error: Connection reset by peer)
[14:54:08] *** Joins: fling (~fling@user/fling)
[15:12:30] *** Quits: Pies (~Pies@314es.pl) (Ping timeout: 272 seconds)
[15:16:22] *** Joins: Pies (~Pies@314es.pl)
[15:52:21] *** Joins: spaceangel (~spaceange@ip-78-102-216-202.net.upcbroadband.cz)
[16:48:14] *** Joins: pmercado (~pmercado@190.22.73.57)
[17:11:08] *** Quits: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de) (Ping timeout: 252 seconds)
[18:13:52] *** Joins: Windy (~windy@user/windy)
[18:16:21] *** Joins: gh34 (~textual@cpe-184-58-181-106.wi.res.rr.com)
[18:17:52] <Windy> any traefik users here?  I'm working on a stack with 2.6 in front of 1.7 so that I can gradually upgrade apps to v2.  My apps use traefik.frontend.whiteList.sourceRange, but currently when the request hits v1.7 the X-FORWARDED-FOR and X-REAL-IP headers show the IP of the traevik v2 container...
[18:40:35] *** Joins: menace (~someone@ppp-93-104-190-25.dynamic.mnet-online.de)
[18:40:52] *** Quits: menace (~someone@ppp-93-104-190-25.dynamic.mnet-online.de) (Changing host)
[18:40:52] *** Joins: menace (~someone@user/menace)
[18:40:58] *** menace is now known as Deknos
[18:41:33] <rawtaz> are you saying that when the request is first seen by the 1.7, those headers contain the ip of the 2.0 traefik instead of the original client? thats odd
[18:52:47] <Windy> rawtaz: yeah.  i think the issue is that the 1.7 config had entrypoint.http.forwardedHeaders configured for our physical load balancer, which was precluding it from accepting the headers from the traefik v2 instance.
[18:54:59] <Windy> after allowing "insecure = true" on forwardedHeaders, it's correctly forwarding X-FORWARDED-FOR (appending the traefik v2 container address in position 2), and setting X-REAL-IP correctly.  I'm not sure how to do this securely still because the IP of the traefik v2 container isn't fixed, but if the v1.7 service doesn't actually expose any ports then the risk seems minimal
[19:37:52] *** Joins: justsomeguy (~justsomeg@user/justsomeguy)
[20:14:48] *** Quits: spaceangel (~spaceange@ip-78-102-216-202.net.upcbroadband.cz) (Remote host closed the connection)
[20:25:23] *** Quits: gh34 (~textual@cpe-184-58-181-106.wi.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[20:38:22] *** Joins: uvolmer (~uvolmer@2001-4dd0-212c-82-e069-f5f7-ab7b-8443.ipv6dyn.netcologne.de)
[21:05:52] *** Quits: epony (epony@user/epony) (Read error: Connection reset by peer)
[21:06:45] *** Joins: epony (epony@user/epony)
[21:22:22] *** Quits: justsomeguy (~justsomeg@user/justsomeguy) (Ping timeout: 272 seconds)
[21:23:36] *** Joins: justsomeguy (~justsomeg@user/justsomeguy)
[21:34:35] *** Quits: justsomeguy (~justsomeg@user/justsomeguy) (Quit: WeeChat 3.4)
[22:24:16] *** bn_work is now known as b
[22:24:46] *** b is now known as Guest9323
[22:25:14] *** Guest9323 is now known as bn_work
[22:52:04] <kubblai> anyone wanna share some desktop porn? i'll kick it off https://usercontent.irccloud-cdn.com/file/NT4F3kHH/Screenshot%202022-04-01%20at%2019.18.56.png
[23:21:06] <lantech19446> welp I got a call this morning that my boss thought one of our switches was down because nothing at the front desk would work and one of the employees computers was down and when he restarted the server he got weird errors. fucked if we didn't get hit by ransomware
[23:21:23] <lantech19446> sorry I didn't mean to curse
[23:21:36] <lantech19446> i always forget i'm not allowed to in here
[23:21:54] <dodo> just restore the backups
[23:22:38] <lantech19446> that's what i'm doing right now
[23:23:14] <lantech19446> I had a heck of a fight because it wiped out my domain controller and the credentials for the nas were domain credentials but i did finally manage to get around that
[23:24:03] <rawtaz> lantech19446: you did get hit with ransomware? what did it encrypt?
[23:25:16] <lantech19446> everything on the domain controller including the vhdx for the domain controller and website 2 employees computers and 2 circ computers the 2 circ computers are dead simple they're just a straight rebuild once i get the dc back up i can restore the other two computers no problem
[23:25:36] <lantech19446> there was no decryption tool for it it everything was a .eight filetype
[23:26:10] <lantech19446> all i know is some idiot must have opened something they shouldn't have and clearly I didn't do my job well enough or it never would have spread
[23:34:13] <kubblai> if he dc is encryped hen yu've
[23:34:16] <kubblai> ps
[23:34:27] <kubblai> oops
[23:34:42] <rawtaz> wait what. how did the ransomware reach your virtualization *host*?
[23:34:44] <kubblai> if the dc is encrypted then you have a DA level compromise
[23:36:12] <lantech19446> the dc got encrypted because the host got encrypted and it encrypted the virtual hard drive, to the best of my knowledge it didn't directly impinge the DC but I don't have the forensic knowledge to trace it 
[23:37:05] <kubblai> a firm i worked at had an accountant with DA access. one time i came in and everyone was screaming all the data is gone from the fileshare. i looked and it sure was gone. then i asked him if he'd done anything and after a bit he admitted to go on the server and moving the root of the fileshare into another folder by dragging and dropping accidentally
[23:37:38] <kubblai> oh so lantech19446 why did an employee have creds for the virt host?
[23:38:24] <lantech19446> none of the computers that got rekt have those credentials the only people who do are me and the director 
[23:38:31] <rawtaz> i dont understand how it could reach the *host* for that DC. that should be a separate netowrk, for starters. is it not?
[23:38:59] <lantech19446> how am I going to separate it when my network needs access to it to function
[23:39:13] <rawtaz> huh?
[23:39:24] <rawtaz> are you using hyper-v or vmware stuff?
[23:39:28] <lantech19446> it provides dns and dhcp as well as network authentication
[23:39:30] <rawtaz> oh, hyper-v of course
[23:39:31] <lantech19446> hyper-v
[23:40:08] <rawtaz> your hyper-v SERVER, which should have only one purpose which is to run VMs, should be on its own closed down network. theres no services on it that any of your users or other servers need. then your VMs and any other user-facing servers should be on other networks.
[23:40:15] <lantech19446> I don't claim to have all the answers a lot of this stuff I learn as I go and i'm a one man show so that's not always optimal
[23:40:24] <rawtaz> so if theres a compromise on the "user" networks, or server networks, they should not be able to reach the hyper-v host.
[23:40:50] <lantech19446> so essentially you're saying don't virtualize the domain controller
[23:41:24] <rawtaz> no. the DC can be a VM just fine. but that VM should on the regular network, and your hyper-v HOST should be on a closed down one thats only used for more core infrastructure
[23:41:40] <rawtaz> are you saying that your DC and hyper-v virtualization host that runs other VMs is the same OS?
[23:41:47] <lantech19446> yes
[23:41:50] <rawtaz> that is a big no no
[23:41:54] <dodo> ouch
[23:41:54] <lantech19446> hmm ok
[23:42:02] <rawtaz> you shoudl separate things more :)
[23:42:23] <rawtaz> do you have many VMs? do you have more than that one server (physical)?
[23:42:33] <lantech19446> well I might be able to get the budget to do that now but remind me to come back to you guys and get the resources I need to learn how to separate them correctly
[23:42:42] <rawtaz> sure
[23:42:52] <lantech19446> I have one physical server running my dc and a website as 2 vms
[23:43:08] <rawtaz> perhaps you can use THIS event to show them that you need budget for refactoring this infra into <plan here>
[23:43:13] <rawtaz> golden opportunity
[23:43:23] <lantech19446> yea that's kinda what i meant by that comment
[23:43:27] <rawtaz> ok. what do the two VMs do more precisely?
[23:43:32] <dodo> or just trip over the power wire repeatedly for a similar effect ;)
[23:44:24] <lantech19446> the dc is dns dhcp adcs and adds all in one and holds all the server roles the other is linux and runs apache 
[23:44:56] <rawtaz> right but there were two VMs you said, and the apache one is just the first, right? whats the other?
[23:45:19] <lantech19446> the dc is one vm the apache is the other
[23:45:59] <rawtaz> im confused. at one time you say that the DC is a VM on that virtualization host. but before you said that the DC and the virtualization host is the same OS
[23:46:12] <rawtaz> i mean, the same instance of an OS, or rather thats what i meant earlier
[23:46:49] <lantech19446> then I misunderstood what you meant the dc and the website are individual vm's that ride on top of server2k19
[23:47:37] <rawtaz> right
[23:48:01] <rawtaz> and all im saying is; put the server2k19 on one network, and the two VMs on other network(s), so that they are separated
[23:49:21] <rawtaz> (for a start) :)
[23:49:59] <lantech19446> right but my point is that the local network still needs access to the dc so if one of them gets infected it's still going to hit the dc, there has to be some way to prevent that. I don't know if the answer is better firewall rules heuristics both etc 
[23:51:17] <rawtaz> dude, you or i are missing something entirely here
[23:51:32] <rawtaz> if your *DC* is stil on that same network that your clients are, then that is fine, no?
[23:51:39] <rawtaz> im saying the HOST should be on a separate network, not the DC
[23:52:10] <rawtaz> the host is one system/server, the DC is another one[D[D[D[D[D[D[D (a VM in this case)
[23:52:15] <rawtaz> they are separate and can be on their own networks
[23:52:25] <lantech19446> it has to be or they lose dns etc but that's exactly what i'm saying, I understand that this will prevent it from hitting the host and potentially spreading to other vm's but how do I prevent it from wiping out the domain controller in general
[23:52:27] <rawtaz> where the network the DC is on happen to be the same as the clients are on
[23:53:06] <rawtaz> you can never do that. but you for sure want to prevent the malware from getting at your virtualization host, because thats just silly :)
[23:53:08] <lantech19446> yea like i'm way more concerned with keeping the domain controller safe than the host
[23:53:16] <lantech19446> ok
[23:53:45] <rawtaz> theres also the matter of backups.. your backup thingie that makes backups of your VMs, should be on a separate network too (separate from the one the DC and clients are on). that will make it less likely that a malware corrupts your backups as wel
[23:53:55] <rawtaz> yeah i understand you want to keep the DC safe, thats for sure.
[23:53:58] <lantech19446> so I fucked up in what's kind of a small way because i couldn't have prevented the big thing that fucked up and i had the backups so i did most of what i was supposed too
[23:54:23] <rawtaz> thats a matter of how ransomware works basically. some can be stopped by the DC being on a separate network from the clients, but generally its more down to patching etc
[23:55:07] <rawtaz> yep, having good and known-restorable backups is the absolute priority
[23:55:33] <lantech19446> I have 2 things I need to really improve, get more separation / improve my firewall rules so that only essential traffic gets through zero trust would be nice but i don't see it happening and I also want to stop using domain credentials on the backup for the domain controller because that was my biggest headache so far
[23:55:52] <rawtaz> yeah sounds good
[23:56:00] <rawtaz> what backu psoftware is it?
[23:56:05] <lantech19446> msp360
[23:56:13] <rawtaz> ok, never used that :o
[23:56:33] <lantech19446> used to be something berry I forget but it came well recommended
[23:56:48] <rawtaz> fruitberry++ probably
[23:57:00] <lantech19446> no definitely not fruitberry
[23:57:05] <rawtaz> :(
[23:57:09] <lantech19446> cloudberry or some shit
[23:57:55] <lantech19446> if this had happened 6mos ago i'd be so fucked though we didn't even have backups 6mos ago
[23:58:44] <lantech19446> we did some sort of plan that identified weaknesses that was one of the only ones they called me out on so I fixed it asap the goal was disaster recovery within 24hrs and we're going to hit that
[23:59:10] <rawtaz> great :)
