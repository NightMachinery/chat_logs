[00:03:17] *** Joins: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com)
[00:18:53] *** Quits: genom (~g@37.214.77.199) (Remote host closed the connection)
[00:32:23] *** Quits: deltab (~deltab@user/deltab) (Ping timeout: 250 seconds)
[00:42:18] *** Joins: deltab (~deltab@user/deltab)
[00:55:24] *** Quits: jellyknight (~gelignite@55d43abc.access.ecotel.net) (Quit: Stay safe!)
[01:01:26] *** kevr is now known as deadvr
[01:02:23] *** deadvr is now known as kevr
[01:12:07] *** Quits: Alex8532 (~Alex8532@user/alex8532) (Quit: Going offline, see ya! (www.adiirc.com))
[01:19:19] *** Quits: Akimb (~Akimb@86.100.13.100) (Read error: Connection reset by peer)
[01:19:54] *** Joins: Xaldafax (~xaldafax@cpe-198-72-160-101.socal.res.rr.com)
[01:39:47] *** Joins: Poboy (~Poboy@user/poboy)
[02:03:27] *** Quits: fukawi2 (~quassel@archlinux/support/fukawi2) (*.net *.split)
[02:03:36] *** Joins: fukawi2 (~quassel@archlinux/support/fukawi2)
[02:08:51] *** Quits: RoyK (~roy@user/royk) (Ping timeout: 258 seconds)
[02:45:26] *** Quits: whoever (~trevor@cpe-70-112-235-224.austin.res.rr.com) (Read error: No route to host)
[02:57:23] *** Joins: DuckThom (~luna@2001:41f0:3fe:3:157:e388:1357:25e0)
[02:59:47] *** Quits: aloy (~luna@2001:41f0:3fe:3:70cf:f123:6cb0:4b56) (Ping timeout: 240 seconds)
[03:01:55] *** Joins: skep (~antimony@user/skep)
[03:03:31] *** Quits: LucaTM (~LucaTM@user/lucatm) (Quit: Textual IRC Client: www.textualapp.com)
[03:05:38] *** Parts: skep (~antimony@user/skep) ()
[03:17:10] *** Quits: Icedream (~icedream@hzn-b.serverkomplex.de) (Ping timeout: 240 seconds)
[03:54:40] *** Quits: freeworld (~vit@chello085216193138.chello.sk) (Ping timeout: 240 seconds)
[04:18:02] *** Quits: nrr (sid20938@id-20938.tooting.irccloud.com) (Ping timeout: 250 seconds)
[04:19:09] *** Joins: ferdna (~ferdna@user/ferdna)
[04:25:11] *** Joins: nrr (sid20938@tooting.irccloud.com)
[04:34:22] *** Quits: Poboy (~Poboy@user/poboy) (Quit: Client closed)
[04:46:37] *** Joins: Icedream (~icedream@hzn-b.serverkomplex.de)
[05:00:07] *** Quits: TML (~tml@user/tml) (Ping timeout: 252 seconds)
[05:13:18] *** LXGHTNXNG is now known as lxghtnxng
[05:26:39] *** Quits: christianPHP (~christian@190.232.168.110) (Quit: Client closed)
[05:31:40] *** Quits: vlm (~vlm@user/vlm) (Quit: "")
[05:35:34] *** Joins: vlm (~vlm@user/vlm)
[06:09:52] *** Joins: christianPHP (~christian@190.232.168.110)
[06:14:34] *** Quits: ferdna (~ferdna@user/ferdna) (Remote host closed the connection)
[06:15:14] *** lxghtnxng is now known as AmyMalik
[06:18:07] *** Quits: shailangsa (~shailangs@host86-185-102-120.range86-185.btcentralplus.com) (Ping timeout: 240 seconds)
[06:20:14] *** Quits: keypusher (keypusher@user/keypusher) (Remote host closed the connection)
[06:20:46] *** Joins: keypusher (keypusher@user/keypusher)
[06:25:33] *** Joins: The_Blode_ (~Blode@user/the-blode/x-7164444)
[06:25:55] *** Quits: The_Blode (~Blode@user/the-blode/x-7164444) (Ping timeout: 252 seconds)
[06:30:09] <SleePy> What would cause ucfirst to fail to upper case a english word?  I've got a ucfirst that is failing, resulting in a require_once that fails.  Its a english word ('index') being passed into ucfirst.  But the result is still index.  I don't get it
[06:30:39] <__adrian> https://3v4l.org/gYElF
[06:30:47] <SleePy> Its only happening for users on my site from places like turkey.  So i'm wondering if something is mucking around with php?
[06:31:01] <SleePy> Yea.  I know.. It should work
[06:31:02] <__adrian> unlikely
[06:31:23] <__adrian> where's this word coming from?
[06:31:34] <SleePy> -error_log:6089:[Sat Aug 28 07:17:09.471987 2021] [php7:error] [pid 26220] [client XXXX:0] PHP Fatal error:  require_once(): Failed opening required '/index.english.php' (include_path='.:/usr/local/lib/php') in /Subs-Language.php on line 67
[06:32:05] <SleePy> require_once($languages . '/' . ucfirst($section) . '.' . $lang . '.php');
[06:32:15] <SleePy> Thats the line of code.  I'm very confused as to what..
[06:32:41] <__adrian> yes, but where does the value come from
[06:32:46] <__adrian> e.g., is it input?
[06:32:52] <SleePy> Entirely from internals.
[06:33:09] <__adrian> bin2hex() it
[06:33:11] <SleePy> No user input.  The app is calling that file
[06:33:36] <SleePy> Will try that
[06:34:11] <__adrian> "only happens for specific users" makes me question that there's no input involved
[06:34:39] <__adrian> how do you know they're from turkey? is there anything special that happens for users from turkey?
[06:34:57] <SleePy> The guy who said it says others from turkey are all getting it.
[06:34:59] <__adrian> e.g., do you screw with locale settings?
[06:35:50] <SleePy> Umm.. I'm trying to think..  maybe.  But I have to recall what PHP function does that
[06:35:57] <__adrian> setlocale
[06:35:57] <SleePy> Big site, lots of code
[06:36:04] <__adrian> just grep "locale"
[06:36:19] <__adrian> well, bin2hex first
[06:36:26] <SleePy> Yes, we do a setlocale in the site code
[06:36:40] <SleePy> Can that break ucfirst?
[06:36:58] <__adrian> https://www.php.net/ucfirst  second sentence
[06:37:04] <SleePy> If its expecting to upper case non english characters but Turkish characters instead?
[06:37:16] <__adrian> it's not "breaking" it, but it's making it work correctly in a different way
[06:37:47] <SleePy> Uggh.. So to "fix" it, I need to either revert the setlocale.  Or come up with my own ucfirst
[06:37:49] <__adrian> this is a guess
[06:37:55] <__adrian> you should confirm
[06:38:07] <__adrian> no - i'd say you should simply not be setting the locale
[06:38:16] <SleePy> Will do..  Added some code to log the error.  Just need a user to trigger it
[06:38:37] *** Joins: shailangsa (~shailangs@host86-186-127-196.range86-186.btcentralplus.com)
[06:38:48] <SleePy> I have to dig into why, but it looks to be time related reasons.  Any reason we shouldn't?
[06:38:51] <__adrian> you can trigger it. just send a request with a suitable Accept-language header (or however you're deciding on the locale)
[06:39:08] <__adrian> (or just set it explicitly)
[06:39:43] <__adrian> "SleePy> Any reason we shouldn't?"  well for one it might be breaking your strategy for requiring files
[06:39:51] <SleePy> Well it looks like its entirly for handling time formats.
[06:40:00] <__adrian> https://php.net/intl
[06:40:31] <SleePy> https://github.com/SimpleMachines/SMF2.1/blob/release-2.1/Sources/Subs.php#L857
[06:40:40] <SleePy> Thats the code (which is public), which does our setlocale
[06:41:02] <__adrian> re: require startegy: i'd also recommend explicit mappings instead of trying to determine it dynamically
[06:41:21] <SleePy> Ok, well I will have to look into this.
[06:42:09] <SleePy> Yea.   Its just setup so I can call loadLanguage('index') and that function handles figuring out what language the user has and loads the correct sections language strings up for translation on pages
[06:42:25] <__adrian> re: setting locale: this generally shouldn't be a runtime thing. set the locale to what YOU want, not to what each request wants. handle l10n in different way that don't completely change the server env (e.g., intl)
[06:42:41] <__adrian> *i18n/l10n
[06:43:16] <__adrian> s/don't/doesn't/
[06:44:20] <SleePy> Ok.  Well thats a bug that we will have to correct.
[06:44:50] <SleePy> Thanks for the help with that.
[06:45:10] <__adrian> np
[06:46:16] <SleePy> Explains why I was confused as to why ucfirst decided, no I won't cap this
[06:46:27] <__adrian> :)
[06:47:00] <Blondie101010> long live 7 bit ASCII
[06:48:59] <SleePy> Also explains why I couldn't reproduce in my test envs.  I only test in english and german.  I guess I need to test in a language I can't read, but breaks out of the latin base
[06:49:55] <__adrian> should test in any language you support
[06:50:15] <__adrian> you have automated tests?
[06:50:41] <SleePy> Not for this.  Its a site.  So I just test the code.  No CI on it :(
[06:51:28] <SleePy> Although I do issue a syntax check since my dev env is PHP 8.0 and the production site is still 7.4.  Don't want to use a 8.0 only feature.
[06:51:49] <__adrian> your dev env should match  :)
[06:52:06] <__adrian> so go upgrade prod  :p
[06:52:14] <Blondie101010> you can test most of the code without using HTTP
[06:52:32] <Blondie101010> and for http test, you build functional tests
[06:52:59] <SleePy> __adrian: Its in the next phase of the plans.
[06:53:05] <__adrian> :)
[06:53:11] <SleePy> Testing on 8.0 for a few months here.  Then get the site on 8.0
[06:53:31] <SleePy> Its production.  Slow moving and fixing things to get us up to speed on releases
[06:54:16] <__adrian> if your dev is testing for 8, it should not also be dev'ing for 7.4
[06:54:19] <__adrian> make a second dev
[06:55:38] <SleePy> Yea.  Will get there.  But the site is working fine on 8.0.  So I should be able to move to it without issues.  Then do the next phase of 8.1..
[06:56:41] <Byteflux> 8.1 is releasing soon, may as well push for that instead of 8.0.
[06:57:51] <SleePy> Always wait for the first service pack
[06:58:38] <Blondie101010> very good habit :)
[06:59:50] <SleePy> Been a sysadmin for too many years.. I know not to jump ship until that boat looks stable
[07:00:06] <SleePy> And that only when its released as final, do people report bugs
[07:00:29] <Byteflux> which is still going to be "soon" :)
[07:01:38] <Byteflux> Bugs reported and fixed in one or two updates before the end of the year, I mean.
[07:03:00] <Byteflux> I say it because I know how this so often goes... "let's spend all this energy on X version and then not care about Y version for another 5 years" :)
[07:03:55] <Blondie101010> imo PHP has had a lot of new features lately
[07:04:14] *** Quits: de-facto (~de-facto@user/de-facto) (Quit: See you around. ðŸ’¤)
[07:04:25] <Blondie101010> that's not something I find appealing in a programming language
[07:05:40] *** Joins: de-facto (~de-facto@user/de-facto)
[07:05:49] <SleePy> And a lot of deprecated features.  7.x was fun because it seemed like every release had a new deprecated feature we where using..
[07:06:05] <SleePy> But to be fair, it was legacy old code nobody had touched in years
[07:06:29] <Byteflux> Nothing really major except performance and quality-of-life stuff. Most of the new features are things you opt into, not things you're forced to use.
[07:06:58] <Byteflux> Perhaps with 8.1 the biggest thing is Fibers, that will be somewhat gamechanging and make PHP more relevant outside of the web.
[07:08:13] <SleePy> Yea, not relevant to me though since I only use it really for web stuff
[07:08:30] <SleePy> Although sometimes have used it because it was easier than remembering how to do some stuff in bash
[07:10:01] *** Joins: Poboy (~Poboy@user/poboy)
[07:20:14] *** Joins: sabasedigh (~sabasedig@109.125.175.36)
[07:20:59] <sabasedigh> hello. I was tweaking nginx to run with php and saw different kind of help pages.
[07:21:40] <sabasedigh> two of them was important php-fpm and uswgi.
[07:21:57] <sabasedigh> first what are the diffs and ...
[07:22:32] <sabasedigh> could you please explain what uswgi is and does it do the same as php-fpm?
[07:23:55] <__adrian> never looked at it. recommend asking on an on-topic channel/forum, or just doing more research to compare.
[07:26:11] <Byteflux> uwsgi is not used for PHP, or if it is, it's extremely uncommon. it's something you see more with python web apps.
[07:26:55] <Byteflux> i'd stick to fastcgi/php-fpm (or mod_php if using apache).
[07:27:31] <__adrian> apache supports fpm. don't use mod_php
[07:27:54] <sabasedigh> wait what happed? mod_php?
[07:28:11] <__adrian> mod_php is old and comparatively slow
[07:28:35] <Blondie101010> that depends!
[07:28:46] <__adrian> sure
[07:29:29] <__adrian> either way, you should definitely be aware that mod_php is not your only choice when it comes to apache
[07:29:52] <Blondie101010> fpm is a good default choice
[07:31:21] <sabasedigh> So fpm for both nginx and apache?
[07:31:53] <Byteflux> should work with most modern web servers
[07:32:38] <Byteflux> caddy is another good webserver choice
[07:34:44] <__adrian> night
[07:48:18] *** Joins: keypushe- (keypusher@user/keypusher)
[07:48:58] *** Quits: keypusher (keypusher@user/keypusher) (Ping timeout: 252 seconds)
[07:50:59] <BadAdviceCat> sabasedigh, I would consider making use of Nginx's UNIT. UNIT is basically an alternative to using PHP-FPM, where UNIT can use PHP and it supports more languages https://unit.nginx.org/#supported-app-languages
[07:51:31] *** keypushe- is now known as keypusher
[07:54:00] <BadAdviceCat> Why UNIT? Because you've mentioned PHP and uswgi. UNIT can make PHP and Pthon available. What is unique about it is its ability to seamlessly enable you to work with different languages, upgrade languages, make available/change apps, etc without having to reboot UNIT.
[07:55:56] <BadAdviceCat> Where you usually configure PHP FPM, you would instead point the reverse proxy settings to an ip/port or socket running UNIT, instead of PHP-FPM.
[08:08:15] *** Joins: Cyberg33k (~Cybergeek@91.216.101.170)
[08:14:12] *** Quits: christianPHP (~christian@190.232.168.110) (Quit: Client closed)
[08:19:37] *** Joins: Rockwood (~Rocky@user/rocky)
[08:28:11] *** Joins: cferry (~etuel@8.242.205.35)
[08:28:43] <cferry> To define multiple consts, would you be OK with an approach like this: https://github.com/beryldb/php-beryl/blob/unstable/src/Connection/Protocol.php
[08:28:47] <cferry> any way to optimize the code?
[08:29:00] *** Joins: guidoc (~guido@151.37.143.134)
[08:31:56] *** Quits: cferry (~etuel@8.242.205.35) (Client Quit)
[08:34:28] <Rockwood> looks fine
[08:36:03] <Rockwood> just you need to describe the meaning of const functioning
[08:37:17] <Rockwood> https://www.php.net/manual/en/language.oop5.constants.php and you can also define property types
[08:56:02] *** Joins: pmercado (~pmercado@186.107.39.248)
[09:27:14] *** Quits: pmercado (~pmercado@186.107.39.248) (Quit: Konversation terminated!)
[09:27:31] *** Quits: Norkle (~norkle@admin.nasa-g0v.com) (Quit: Lost terminal)
[09:53:26] *** Quits: Rockwood (~Rocky@user/rocky) (Ping timeout: 250 seconds)
[09:53:43] *** Joins: Rockwood (~Rocky@user/rocky)
[09:58:51] *** Quits: Poboy (~Poboy@user/poboy) (Quit: Client closed)
[10:30:27] *** Quits: Rockwood (~Rocky@user/rocky) (Read error: Connection reset by peer)
[10:33:31] *** Joins: Rockwood (~Rocky@user/rocky)
[10:38:55] *** Quits: Bencraft (~Bencraft@111.227.187.81.in-addr.arpa) (Ping timeout: 252 seconds)
[10:45:25] *** Quits: Xaldafax (~xaldafax@cpe-198-72-160-101.socal.res.rr.com) (Quit: Bye...)
[10:45:48] *** Joins: Rockwood_ (~Rocky@user/rocky)
[10:47:36] *** Quits: Rockwood (~Rocky@user/rocky) (Ping timeout: 250 seconds)
[10:56:24] *** Joins: Bencraft (~Bencraft@111.227.187.81.in-addr.arpa)
[10:58:09] *** Joins: genom (~g@37.214.77.199)
[11:00:57] *** Quits: guidoc (~guido@151.37.143.134) (Ping timeout: 248 seconds)
[11:04:13] *** Quits: Rockwood_ (~Rocky@user/rocky) (Read error: Connection reset by peer)
[11:04:13] *** Joins: guidoc (~guido@151.43.81.38)
[11:18:12] *** Quits: guidoc (~guido@151.43.81.38) (Quit: WeeChat 3.2)
[11:20:10] *** Quits: Bencraft (~Bencraft@111.227.187.81.in-addr.arpa) (Ping timeout: 252 seconds)
[11:29:16] *** Joins: guidoc (~guido@151.43.81.38)
[11:58:40] *** Quits: dimbag (~Couture@62.76.35.194) (Ping timeout: 250 seconds)
[12:05:07] *** Joins: Akimb (~Akimb@86.100.13.100)
[13:01:34] *** Joins: ferdna (~ferdna@user/ferdna)
[13:13:35] *** Joins: DevAntoine (~DevAntoin@91-169-148-162.subs.proxad.net)
[13:21:23] *** Joins: Karatsuba (~jamer05@user/karatsuba)
[13:23:21] *** Quits: DevAntoine (~DevAntoin@91-169-148-162.subs.proxad.net) (Remote host closed the connection)
[13:37:51] *** Joins: Alex8532 (~Alex8532@user/alex8532)
[13:39:07] *** Joins: DevAntoine (~DevAntoin@91-169-148-162.subs.proxad.net)
[13:43:37] *** Quits: DevAntoine (~DevAntoin@91-169-148-162.subs.proxad.net) (Ping timeout: 248 seconds)
[13:53:15] *** Quits: ferdna (~ferdna@user/ferdna) (Quit: Leaving)
[13:53:30] *** gxt_ is now known as gxt
[14:08:07] *** Quits: acidsys (~LSD@2.lsd.systems) (Excess Flood)
[14:09:15] *** Joins: freeworld (~vit@chello085216193138.chello.sk)
[14:12:25] *** Joins: LSD (~LSD@2.lsd.systems)
[14:14:38] *** Quits: LSD (~LSD@2.lsd.systems) (Excess Flood)
[14:18:16] *** Joins: LSD (~LSD@2.lsd.systems)
[14:50:18] *** LSD is now known as acidsys
[15:05:07] *** Quits: guidoc (~guido@151.43.81.38) (Ping timeout: 240 seconds)
[15:07:25] *** Joins: guidoc (~guido@151.57.8.81)
[15:38:46] *** Joins: Naktibalda (~Naktibald@88.135.22.17)
[15:45:37] *** Joins: magla (~gelignite@55d4cf57.access.ecotel.net)
[15:46:51] *** Joins: Ducki (~ducki@user/ducki)
[15:48:25] *** Quits: Ducki_ (~ducki@user/ducki) (Ping timeout: 248 seconds)
[15:54:08] *** Quits: Karatsuba (~jamer05@user/karatsuba) (Quit: WeeChat 2.8)
[16:05:03] *** Quits: jetchisel (jetchisel@user/jetchisel) (Quit: Unfortunately time is always against us -- [Morpheus])
[16:11:58] *** Joins: mIk3_08 (~Thunderbi@user/mik3-08/x-2852566)
[16:13:26] *** Joins: jetchisel (jetchisel@user/jetchisel)
[16:20:33] *** Joins: LucaTM (~LucaTM@user/lucatm)
[16:38:33] *** Quits: Naktibalda (~Naktibald@88.135.22.17) (Ping timeout: 248 seconds)
[16:42:33] *** Quits: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com) (Quit: WeeChat 3.0.1)
[16:42:57] *** Quits: LucaTM (~LucaTM@user/lucatm) (Ping timeout: 245 seconds)
[16:52:39] *** Joins: WishBoy (~WishBoy@user/wishboy)
[16:52:51] *** Joins: dukenukem3d (~dukenukem@xdsl-78-35-155-102.nc.de)
[16:54:07] *** Joins: LucaTM (~LucaTM@user/lucatm)
[16:54:45] *** Quits: WishBoy (~WishBoy@user/wishboy) (Client Quit)
[16:55:16] <dukenukem3d> Hello! I passed a var to a function as value, getting "...expected to be a reference, value given". Now I added '&' bevor var and I don't understand what to do with this error now: Parse error: syntax error, unexpected '&', expecting ')'
[16:56:14] <dukenukem3d> ...changed foo(..., $this, ...) into foo(..., &$this, ...)
[16:57:29] <dukenukem3d> "foo" is call_user_func btw, if that matters
[16:57:40] *** Quits: Pixi (~Pixi@user/pixi) (Ping timeout: 240 seconds)
[17:12:57] <AllenJB> dukenukem3d: Pastebin your actual code (or code that reproduces the issue) please. It's possible you have another error / one we cannot see in your contracted example.
[17:14:55] *** Quits: sabasedigh (~sabasedig@109.125.175.36) (Ping timeout: 252 seconds)
[17:15:47] <dukenukem3d> AllenJB I understand.. It's difficult for code comes from db and such. I will therefore try to make an example code
[17:24:05] *** Quits: mIk3_08 (~Thunderbi@user/mik3-08/x-2852566) (Quit: mIk3_08)
[17:25:10] <dukenukem3d> OK, here we go: https://termbin.com/ah6fh
[17:25:56] <dukenukem3d> The second approach does not work because $par1 is not a reference. If you change it into = function(&$par1) then you get where I started above
[17:32:21] <AllenJB> That code is not producing any errors: https://3v4l.org/GdijR
[17:33:01] <AllenJB> From what you've shown I think the way you fixed the first error is correct, but you have another problem that's causing the second error you mentioned (unexpected &)
[17:33:38] <AllenJB> It's possible the error occurs on a line before the one mentioned in the error message (and the parser just doesn't realize something is wrong until it reaches the &)
[17:40:25] *** Parts: velix (~velix@user/velix) (Leaving)
[17:41:00] *** Quits: Cyberg33k (~Cybergeek@91.216.101.170) (Ping timeout: 250 seconds)
[17:41:24] *** Quits: Donitz (~Donitz@85-156-203-108.elisa-laajakaista.fi) (Read error: Connection reset by peer)
[17:41:29] <dukenukem3d> AllenJB I don't understand you. The code does not produce an error but it does not work as expected! The second way of increasing the variable by using a closure should be made working somehow, I need this. And there can't be any other error in no other line, all lines work without adding the second &. Just to make sure: I want THIS https://termbin.com/cc1d code to run!
[17:43:15] *** Joins: Donitz (~Donitz@85-156-203-108.elisa-laajakaista.fi)
[17:47:17] <dukenukem3d> Thanks for you eyes anyway :)
[17:47:19] <AllenJB> You cannot see changes to values of function parameters unless you use references (use &) or return the value from the function. See https://www.php.net/manual/en/language.variables.scope.php and https://www.php.net/references
[17:47:44] <dukenukem3d> I know what references are and I need this reference
[17:48:58] <dukenukem3d> thats why I want his code https://termbin.com/cc1d to run without throwing this error I don't understand. php does not want the & sign in combination with call_user_func or something else I don't understand.
[17:55:01] *** Joins: Bencraft (~Bencraft@111.227.187.81.in-addr.arpa)
[17:57:52] <biberu> globals, eval, call_user_func, references... why?
[17:58:38] <AllenJB> Right, I've worked out where your "unexpected &" error is coming from - you're trying to use call time pass by reference ( https://php-legacy-docs.zend.com/manual/php4/en/language.references.pass ) which was deprecated some time in PHP 5 and removed shortly after
[17:58:39] <AllenJB> (I'm guessing in the move to PHP 7, but can't actually find mention in the migrating guides)
[18:00:11] <AllenJB> You can no longer force function to use a parameter as a reference - there's no way to do that any more.
[18:00:54] <biberu> is this old code that you inherited, or for something you're building?
[18:01:55] <AllenJB> Oh, found it. Removed in PHP 5.4: https://www.php.net/manual/ro/migration54.incompatible.php
[18:02:31] <dukenukem3d> OK we're getting closer. Answering biberu: global is just for this example code. eval is for executing what I have read from the database (how else to do this? Temporary files ending with .php and requiring them? Why?) call_user_func because the function name is dynamic. Refrerences because I give class instances.
[18:03:01] <dukenukem3d> biberu, old code that i built ages ago, migrating from php3 to php7. this is FUN (no it's not)
[18:03:13] <biberu> dukenukem3d: 3 :o
[18:03:24] <AllenJB> Objects are basically passed by reference in ("modern") PHP. You don't need to explicitly pass them as references
[18:03:34] <dukenukem3d> I have an idea! Instead of remembering the dynamic function name that just eval()s I could instead save the this to evaluate :)
[18:03:36] <AllenJB> (I use the term "modern" very loosely here - we're talking PHP 5+)
[18:05:04] <dukenukem3d> ...mh just remove all references when I pass objects? I could try
[18:07:17] <AllenJB> This code was obviously designed to run on PHP 5.3 or earlier (with notices / deprecations disabled most likely - don't ignore deprecations / notices!). It sounds to me like it was originally written for PHP 4 (or shortly after)
[18:08:10] <biberu> dukenukem3d: regarding call_user_func you might be able to just use anonymous or arrow functions instead, see https://3v4l.org/gdXnB
[18:08:13] <AllenJB> And with some of the code apparently stored in a database, this sounds like a Fun migration!
[18:08:50] <biberu> dukenukem3d: as for code in the database... generally, don't, but since you already have a system that does that...
[18:09:23] <biberu> dukenukem3d: that can easily introduce problems with versioning, analysis, security etc etc
[18:09:24] *** Joins: sebbu2 (~sebbu@user/sebbu)
[18:09:43] <dukenukem3d> AllenJB, as I said, it was php3 back then :)
[18:10:11] <dukenukem3d> please dont give me hints that ignore the fact that CODE is within a variable, I have to execute this code! I cannto get arround eval!
[18:10:56] <AllenJB> Some code written for PHP 5.3 or earlier is simply not going to run on PHP 7+. There's no way around that.
[18:11:18] <biberu> that could go for the code in the db too
[18:11:39] <biberu> ofc, and since it's in there i suppose it might be tricky to test it for a migration
[18:11:41] <AllenJB> Also, most people here likely haven't had to deal with <= PHP 5.3 code in a long time (if ever) and we've forgotten things.
[18:11:54] <dukenukem3d> biberu, you are right of cause. I still just want to make it run again before I maybe some day I think of another approach
[18:12:09] <biberu> dukenukem3d: yeah, sure, not trying to be difficult with you
[18:12:10] *** Quits: sebbu (~sebbu@user/sebbu) (Ping timeout: 240 seconds)
[18:12:47] <dukenukem3d> :)
[18:12:52] <biberu> i may have used 3 briefly, i don't even remember any more :)
[18:13:19] <dukenukem3d> Remember when php became broadly used? No? Well, that was php3 :-D
[18:14:46] <biberu> dukenukem3d: what is the code in the db doing? and how much is it?
[18:14:55] <dukenukem3d> before php we had Coldfusion if I recall correctly
[18:15:02] <biberu> some sort of user editable template thing?
[18:15:08] <dukenukem3d> Gladly it is not much in lines!
[18:15:20] <dukenukem3d> nobody edits it of cause.
[18:16:17] <biberu> if it's static perhaps you can migrate it to files?
[18:16:35] <dukenukem3d> static since the beginning but different "rows" for different user actions
[18:16:44] <biberu> get it running on php 3, add some tests, then migrate version by version?
[18:16:54] *** Quits: Alex8532 (~Alex8532@user/alex8532) (Quit: Going offline, see ya! (www.adiirc.com))
[18:17:46] <dukenukem3d> version by version: Could be a way but I already came so far (last weeks), I will now get to the end. I am already testing the main function of the whole website :)
[18:19:12] <AllenJB> There are tools that can help you with upgrading old code including the PHPCompatibility ruleset for PHP CodeSniffer and Rector (tho they may not help you will with some of the really old changes / removals)
[18:24:20] <dukenukem3d> PHPCompatibility? PHP CodeSniffer? Rector? I am glad that for most Problems php prints out an error or warning that I understand
[18:29:46] <dukenukem3d> Why the hell did anybody write ugly lines like this: while (list(,$act) = each($arr)) Was there a time we didn't have foreach?
[18:31:24] *** Joins: Cyberg33k (~Cybergeek@91.216.101.170)
[18:34:53] <biberu> i think it was added in 4
[18:35:13] *** Quits: Akimb (~Akimb@86.100.13.100) (Ping timeout: 252 seconds)
[18:35:24] <biberu> note that you don't need list() any more either
[18:35:43] <Robdgreat> looks like each was added in 4 as well
[18:36:50] *** Joins: Pixi (~Pixi@user/pixi)
[18:37:20] <dukenukem3d> Then maybe the code was using php4 when it ran?
[18:38:05] <biberu> dukenukem3d: https://stitcher.io/blog/array-destructuring-with-list-in-php
[18:39:40] <dukenukem3d> ->saved
[18:50:24] *** Joins: WishBoy (~WishBoy@user/wishboy)
[18:51:49] <AllenJB> dukenukem3d: Unless it's you, someone on reddit seems to be in a similar predicament: https://www.reddit.com/r/PHP/comments/pdvmnc/lets_say_you_get_an_old_php5_mysql_horrible/
[18:52:05] <dukenukem3d> not me :)
[18:59:26] <biberu> i hope he's got it under version control with a scripted environment
[19:06:01] *** Quits: guidoc (~guido@151.57.8.81) (Ping timeout: 252 seconds)
[19:07:55] *** Joins: guidoc (~guido@151.43.9.38)
[19:59:45] *** Quits: Cyberg33k (~Cybergeek@91.216.101.170) (Quit: This computer has gone to sleep)
[20:02:48] *** Joins: Poboy (~Poboy@user/poboy)
[20:42:39] *** Quits: Poboy (~Poboy@user/poboy) (Quit: Client closed)
[20:45:16] *** Joins: Vision (~Vision@024-178-231-173.res.spectrum.com)
[20:46:11] *** Joins: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com)
[20:58:13] *** Joins: brentaarnold (~brentaarn@24.112.61.90)
[21:02:34] *** Joins: lall- (~alek@2001:44c8:4327:c78b:715a:df55:c324:fbfd)
[21:04:24] *** sebbu2 is now known as sebbu
[21:09:07] *** Joins: ferdna (~ferdna@user/ferdna)
[21:45:13] *** Quits: freeworld (~vit@chello085216193138.chello.sk) (Ping timeout: 248 seconds)
[21:52:22] *** Quits: kenoba (~kenoba@user/kenoba) (Quit: The Lounge - https://thelounge.chat)
[21:54:31] *** Joins: molt (~molt@178-222-245-206.static.isp.telekom.rs)
[21:55:57] *** Quits: molt (~molt@178-222-245-206.static.isp.telekom.rs) (Read error: Connection reset by peer)
[22:05:19] *** Quits: mysteryhunter (~Mysteryhu@213-225-33-221.nat.highway.a1.net) (Ping timeout: 252 seconds)
[22:13:17] *** Quits: magla (~gelignite@55d4cf57.access.ecotel.net) (Quit: Stay safe!)
[22:17:39] *** Joins: kenoba (~kenoba@user/kenoba)
[22:55:55] *** Quits: wilk (~wilk@user/wilk) (Ping timeout: 252 seconds)
[23:06:07] *** Quits: guidoc (~guido@151.43.9.38) (Ping timeout: 240 seconds)
[23:08:31] *** Joins: guidoc (~guido@151.57.62.62)
[23:10:34] *** Joins: Akimb (~Akimb@86.100.13.100)
[23:13:19] *** Joins: puff (~user@S0106d4ca6d80a83c.vs.shawcable.net)
[23:14:19] <puff> Hi, I'm thinking about making some simple php apps, and it's been awhile since I've done php, so I'm wondering about current state of the art for database tools, etc.
[23:21:43] <TinoDidriksen> Hasn't changed much. PDO, php-fpm, etc.
[23:27:47] <puff> One issue I have is that most ORMs, etc, end up being more hassle than their worth.  Though PHP's database stuff is relatively hassle free to begin with (ugh, java).
[23:27:58] <puff> Which makes it hard to improve on :-).
[23:28:41] *** Joins: freeworld (~vit@chello085216193138.chello.sk)
[23:30:00] <Byteflux> Java has "hassle-free" database libraries, too. Arguably most PHP development revolves around frameworks like Laravel or Symfony which will use ORMs (such as Doctrine) that are just as powerful or complex as Hibernate for Java.
[23:31:17] <Byteflux> Though for simpler apps in Java where I wouldn't want to pull in Hibernate, I'd probably just use something like Jdbi.
[23:32:42] <TinoDidriksen> Don't bother with an ORM. Just use PDO.
[23:35:06] <Byteflux> Use whatever you're comfortable and productive with. Doesn't have to be a full blown ORM, doesn't have to be low level like PDO, either. Plenty of Composer libraries on packagist.org to choose from.
[23:42:57] *** Joins: Alex8532 (~Alex8532@user/alex8532)
[23:47:17] <puff> Byteflux: Eh, I haven't been doing much java database work the past few years, but up until then I've been pretty unimpressed with the frameworks/libraries. But this a bit off-topic for #php, sorry, didn't mean to take us there.
[23:47:45] <puff> Composer libraries?  Googling...
[23:48:10] <puff> Ah, a dependency manager. Nice.
[23:49:16] <puff> I wrote a database library for java that I really liked, haven't seen anything else like it, for java or php.  Is there something like the following out there?
[23:49:27] <puff> You feed it your schema and it generates source code for:
[23:49:32] <puff>  a) a bunch of simple beans, e.g. data classes with getters and setters and a dirty flag
[23:49:45] *** Joins: magla (~gelignite@55d4cf57.access.ecotel.net)
[23:49:51] *** Quits: guidoc (~guido@151.57.62.62) (Quit: WeeChat 3.2)
[23:50:32] <puff> b) a bunch of query methods; intantiate a bean, set some values, hand it to the query method and it generates and executes a select, or an update, etc.  Same can be done with a bean loaded from the query method, i.e. make a change, then pass it to the update query method.
[23:50:32] *** Quits: Akimb (~Akimb@86.100.13.100) (Read error: Connection reset by peer)
[23:50:54] <Stanley> man
[23:50:59] <puff> c) a bunch of mapper methods, so you can do custom SQL queries and then feed the result set into the mapper to get back beans, etc.
[23:51:11] <Stanley> i use a 3rd party auth provider to handle SSO in my app
[23:51:14] <puff> In java that was very helpful.  In php, a lot of the cruft is already taken care of, so maybe less helpful.
[23:51:41] <Stanley> it's not cheap, I pay them about $150/m, and they're totally unwilling to help find a bug either in my implementation or their SDK
[23:51:44] <puff> Er, that is, php is less bureaucratic, in my experience, so the utility of something like my library isn't as necessary.
[23:51:50] <puff> Stanley: That sucks.
[23:52:05] <Byteflux> Code generation is kinda meh, and objects don't map 1-to-1 against relational data structures so code generation is less useful is practical implementations.
[23:52:08] <Stanley> support says "create an issue on github" and github issue people say "can't help, talk to support?"
[23:52:14] <Stanley> it's been going on for 1.5 years now
[23:52:17] <Stanley> -_-
[23:52:52] <Byteflux> While using beans to represent some aspect of your data is normal and okay, mapping the bean to some structure in your database *automatically* doesn't really work out very well.
[23:53:24] <Byteflux> Which is why you see applications writing tailored DAOs
[23:53:31] <Byteflux> s/writing/using/
[23:54:09] <puff> Byteflux: Yeah, the whole raison d'etre of my library was *not* to try to autoamte it to much, just to automate the repetitive stuff, and then get out of your way.
[23:54:15] <puff> too much, that is.
[23:55:13] <puff> Ie. for stupid-simple queries, you just instantiate a bean, call the setter for the column/value you want to match, pass it to the query method.
[23:55:15] <puff> Query method too simple for you?  Write your own query and then pass the result set to the mapper method to map it to a row bean.
[23:55:20] *** Quits: WishBoy (~WishBoy@user/wishboy) ()
[23:55:30] <puff> Etc.
[23:55:49] <puff> Stanley: Who's this vendor, btw?
[23:55:57] <Stanley> AUth0
[23:55:59] <Stanley> Auth0
[23:56:01] <puff> Thanks.
[23:57:02] <Stanley> Their support is a bit of a headache, I would be using WorkOS of FusionAuth but somehow neither of them support logging out (it's just the way they've implemented SSO/Sessions) so I'm stuck with Auth0 because there's no way in hell i'm implementing SAML sign on directly, lol
[23:57:09] <puff> Byteflux: Hm, come to think of it, your phrasing might be the most succinct description of my library (or at least my intent): a library that helps you write a tailored DAO.
[23:57:25] <Byteflux> As far as Java goes, Jdbi (jdbi.org) sounds pretty close minus the code generation. Not sure if something similar exists in PHP, maybe Doctrine DBAL: https://www.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/introduction.html
[23:59:38] <puff> Byteflux: Thanks, I'll check it out.
