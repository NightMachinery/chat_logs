[00:02:03] <jwr> is there anything i can do about `bundle lock` getting killed OOM, other than just resizing the server? that doesn't seem like it would be particularly memory intensive. https://pastebin.com/raw/h6wPZXp4
[00:07:14] <adam12> jwr: `free -m`?
[00:07:23] <adam12> jwr: and `bundle -v`
[00:14:29] <jwr> adam12: https://pastebin.com/raw/8Xe5yf94 it's legitimately running out of memory, the whole server becomes basically useless until the kernel kills it. but i've never known fetching gems to be resource intensive.
[00:15:03] <adam12> jwr: Ancient version of Bundler. Could you try latest in the 2.x series?
[00:17:29] <jwr> i can, but this is in the context of servers running `bundle lock` via automation, not humans on laptops, so it's a bit more trouble to change versions. is 2.x known to handle memory better (or 1.x known to handle it poorly)?
[00:19:17] <adam12> jwr: I don't know, but 1.x is essentially in maintenance mode for the last while. You could try reproducing locally on a laptop with similar specs (4gb ram, no swap) to see if updating bundler would help. But if you open a ticket to the bundler project, I _presume_ they'd want to see you on latest 2.x as well.
[00:20:23] <jwr> yeah, fair, that makes sense.
[00:21:59] <jwr> adam12: the specific gem that we're trying to update is being pulled from a git repo. would the size of the repository affect RAM usage, as more and more commits get added over time? i've never seen that behavior with plain old git, but i've also never seen bundler get killed like this before either.
[00:22:33] <adam12> jwr: I've never seen it either. What does the gemspec look like for that project? Anything out of the ordinary?
[00:23:04] <adam12> jwr: Does the gemspec for that project reach out to anything? require any files, call git, etc?
[00:23:25] <adam12> jwr: What does the line look like in your Gemfile that refers to that gem? does it use a glob for matching gemspecs?
[00:26:10] *** Quits: jwr (~jwr@pool-71-182-194-5.pitbpa.fios.verizon.net) (Ping timeout: 240 seconds)
[00:38:01] *** Quits: _ht (~quassel@82-169-194-8.biz.kpn.net) (Remote host closed the connection)
[00:50:34] *** Joins: jwr (~jwr@pool-71-182-194-5.pitbpa.fios.verizon.net)
[00:51:06] <jwr> adam12: woops, power outage knocked me offline. did you happen to have any input on my question about bundle/git?
[01:00:16] <adam12> <adam12> jwr: I've never seen it either. What does the gemspec look like for that project? Anything out of the ordinary?
[01:00:17] <adam12> <adam12> jwr: Does the gemspec for that project reach out to anything? require any files, call git, etc?
[01:00:17] <adam12> <adam12> jwr: What does the line look like in your Gemfile that refers to that gem? does it use a glob for matching gemspecs?
[01:00:25] *** Quits: AriT93 (~AriT93@173.226.103.218) (Read error: Connection reset by peer)
[01:00:44] <adam12> jwr: I gotta run tho. Good luck.
[01:00:50] <jwr> thanks
[01:21:50] *** Joins: graywolf (~wolf@user/graywolf)
[01:22:05] *** Joins: drincruz_ (~drincruz@ool-44c748be.dyn.optonline.net)
[01:23:47] *** Quits: drincruz (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com) (Read error: Connection reset by peer)
[01:30:12] *** Joins: AriT93 (~AriT93@173.226.103.218)
[01:40:10] *** Quits: drincruz_ (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 246 seconds)
[01:42:24] *** Joins: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com)
[01:47:26] *** Quits: chonkbit (~chonkbit@2600:1700:2150:1d40:86c5:a6ff:fe3b:ae7a) (Ping timeout: 252 seconds)
[02:00:15] *** Joins: ur5us (~ur5us@2406:e002:6b09:8901:dc29:12ba:98a9:f1d4)
[02:25:04] <nakilon> IIRC there is some command to download only the HEAD of git repo, without history
[02:25:27] <nakilon> not sure if it cuts after it downloads it all or downloads fewer bytes though
[02:26:07] <nakilon> oh, if it's a repo that is a Gemfile dependency then it's probably already applied
[02:40:43] *** Quits: jwr (~jwr@pool-71-182-194-5.pitbpa.fios.verizon.net) (Remote host closed the connection)
[02:44:38] *** Quits: Ziyan (~ziyan@112.134.170.234) (Ping timeout: 252 seconds)
[02:46:34] *** Joins: Ziyan (~ziyan@112.134.171.17)
[02:46:44] *** Joins: bandithijo (~bandithij@fedora/bandithijo)
[02:58:32] *** Quits: AriT93 (~AriT93@173.226.103.218) (Remote host closed the connection)
[03:09:04] *** Joins: dibber (~altdev@c-73-14-187-235.hsd1.co.comcast.net)
[03:09:35] *** Quits: weyhmueller (~weyhmuell@blofeld.nc.w9r.de) (Ping timeout: 268 seconds)
[03:10:07] *** Joins: weyhmueller (~weyhmuell@blofeld.nc.w9r.de)
[03:14:11] *** Joins: AriT93 (~AriT93@173.226.103.218)
[03:16:26] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[03:18:51] *** Quits: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com) (Ping timeout: 252 seconds)
[03:25:33] *** Quits: AriT93 (~AriT93@173.226.103.218) (Remote host closed the connection)
[03:28:08] *** Quits: Ziyan (~ziyan@112.134.171.17) (Quit: Textual IRC Client: www.textualapp.com)
[03:43:31] *** Quits: graywolf (~wolf@user/graywolf) (Quit: WeeChat 3.2)
[03:51:04] *** Quits: Garb0 (~Garb0@user/garb0) (Quit: Garb0)
[03:51:56] <riceandbeans> Is there a better way to say, `foobar = foo || bar || baz || biff` ?
[03:58:45] *** Joins: gr33n7007h (~gr33n7007@user/gr33n7007h)
[04:12:39] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 258 seconds)
[04:46:56] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[04:52:10] *** Joins: mtr (~mtr@136-24-229-190.cab.webpass.net)
[04:52:14] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 252 seconds)
[05:08:50] *** Quits: ur5us (~ur5us@2406:e002:6b09:8901:dc29:12ba:98a9:f1d4) (Ping timeout: 252 seconds)
[05:12:04] *** Joins: ur5us (~ur5us@2406:e002:6b09:8901:dc29:12ba:98a9:f1d4)
[05:23:19] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[05:27:59] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 252 seconds)
[06:05:28] *** Quits: gr33n7007h (~gr33n7007@user/gr33n7007h) (Ping timeout: 265 seconds)
[06:13:30] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[06:14:37] *** Quits: lunarkitty (uid501895@user/pyra) (Quit: Connection closed for inactivity)
[06:24:36] *** Joins: finsternis (~X@23.226.237.192)
[06:25:19] *** Joins: jetchisel (jetchisel@user/jetchisel)
[06:38:52] *** Quits: leah2 (~leah@vuxu.org) (Read error: Connection reset by peer)
[06:42:10] *** Joins: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com)
[06:42:53] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 252 seconds)
[06:47:24] <bandithijo> riceandbeans: `["foo", "bar", "baz", "biff"].include? foobar` ?
[06:54:31] <rg> maybe also.. foobar = [foo, bar, baz, biff].find(&:itself)
[06:54:53] <rg> i think the longer form is going to be clearest.
[06:57:52] *** Quits: mtr (~mtr@136-24-229-190.cab.webpass.net) (Quit: Leaving...)
[07:02:05] <newton> TIL itself
[07:03:18] <newton> though you lose the short circuiting of || if any of foo bar baz biff were long running methods
[07:20:02] *** Quits: Tempesta (Tempesta@user/tempesta) (Quit: See ya!)
[07:20:13] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[07:22:24] *** Quits: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com) (Ping timeout: 258 seconds)
[07:22:29] <rg> i always thought itself was weird but yeah it has its place i guess
[07:35:26] *** Joins: Tempesta (Tempesta@user/tempesta)
[07:48:47] *** Joins: easbarbosa (~user@2804:1b2:83:ec7c:4c70:d701:fec6:a14b)
[08:09:12] *** Quits: easbarbosa (~user@2804:1b2:83:ec7c:4c70:d701:fec6:a14b) (Remote host closed the connection)
[08:09:56] *** Joins: easbarbosa (~user@2804:1b2:83:ec7c:4c70:d701:fec6:a14b)
[08:11:04] *** Joins: lunarkitty (uid501895@user/pyra)
[09:01:44] *** Joins: postmodern (~postmoder@user/postmodern)
[09:09:46] *** Quits: easbarbosa (~user@2804:1b2:83:ec7c:4c70:d701:fec6:a14b) (Ping timeout: 240 seconds)
[09:34:23] *** Quits: Rounin (~david@cm-84.212.130.215.getinternet.no) (Ping timeout: 252 seconds)
[09:37:30] *** Quits: ged (~deveiant@deveiate.org) (Quit: WeeChat 3.1)
[09:38:45] *** Joins: ged (~deveiant@deveiate.org)
[09:44:34] *** Quits: ur5us (~ur5us@2406:e002:6b09:8901:dc29:12ba:98a9:f1d4) (Ping timeout: 246 seconds)
[09:50:29] *** Joins: gr33n7007h (~gr33n7007@user/gr33n7007h)
[09:57:41] *** Quits: ged (~deveiant@deveiate.org) (Quit: I don't settle for anything less than zebras.)
[09:57:54] *** Joins: ged (~ged@deveiate.org)
[10:09:32] *** Joins: jhawthorn_ (~jhawthorn@user/jhawthorn)
[10:10:07] *** Quits: jhawthorn (~jhawthorn@user/jhawthorn) (Ping timeout: 246 seconds)
[10:12:55] *** Quits: dibber (~altdev@c-73-14-187-235.hsd1.co.comcast.net) (Ping timeout: 246 seconds)
[10:14:37] *** Quits: lunarkitty (uid501895@user/pyra) (Quit: Connection closed for inactivity)
[10:23:34] *** Quits: jmcgnh (~jmcgnh@c-98-229-233-252.hsd1.nh.comcast.net) (Ping timeout: 265 seconds)
[10:27:16] *** Joins: jmcgnh (~jmcgnh@c-98-229-233-252.hsd1.nh.comcast.net)
[10:46:19] *** Joins: _ht (~quassel@82-169-194-8.biz.kpn.net)
[11:11:40] *** Joins: unyu (~pyon@user/pyon)
[11:11:40] *** unyu is now known as isekaijin
[11:20:09] *** Quits: lucf117 (~lucf117@user/lucf117) (Remote host closed the connection)
[11:33:01] *** Quits: sagax (~sagax@213.138.71.146) (Excess Flood)
[11:54:15] *** Quits: postmodern (~postmoder@user/postmodern) (Quit: Leaving)
[11:57:40] *** Joins: teclator (~quassel@85.155.180.70.dyn.user.ono.com)
[12:40:50] *** Quits: gr33n7007h (~gr33n7007@user/gr33n7007h) (Ping timeout: 252 seconds)
[12:45:51] *** Quits: bandithijo (~bandithij@fedora/bandithijo) (Quit: WeeChat 3.2-rc1)
[12:49:40] *** Joins: leah2 (~leah@vuxu.org)
[13:14:40] *** Joins: Garb0 (~Garb0@user/garb0)
[13:28:00] *** Joins: nolesswrong (~nolesswro@45.32.1.17)
[13:51:29] *** Quits: Garb0 (~Garb0@user/garb0) (Remote host closed the connection)
[13:55:46] *** Quits: sam113101 (~sam@modemcable229.128-202-24.mc.videotron.ca) (Remote host closed the connection)
[13:58:20] *** Joins: sam113101 (~sam@modemcable229.128-202-24.mc.videotron.ca)
[14:09:54] *** Joins: Garb0 (~Garb0@user/garb0)
[14:33:55] *** Quits: Garb0 (~Garb0@user/garb0) (Quit: Garb0)
[14:37:16] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 272 seconds)
[14:48:13] *** Joins: gr33n7007h (~gr33n7007@user/gr33n7007h)
[15:03:29] *** Quits: gr33n7007h (~gr33n7007@user/gr33n7007h) (Quit: WeeChat 3.2)
[15:22:06] *** Joins: unmanbearpig (~unmanbear@user/unmanbearpig)
[15:48:50] *** Joins: Rounin (~david@cm-84.212.130.215.getinternet.no)
[16:05:18] *** Joins: Garb0 (~Garb0@user/garb0)
[16:18:04] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[16:21:41] *** Joins: bandithijo (~bandithij@fedora/bandithijo)
[16:22:10] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 246 seconds)
[16:36:40] *** Quits: isekaijin (~pyon@user/pyon) (Quit: WeeChat 3.2)
[16:51:40] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[16:56:13] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 256 seconds)
[17:12:52] *** Joins: drincruz (~drincruz@ool-44c748be.dyn.optonline.net)
[17:19:30] *** Quits: bandithijo (~bandithij@fedora/bandithijo) (Quit: WeeChat 3.2-rc1)
[17:27:54] *** Joins: bandithijo (~bandithij@fedora/bandithijo)
[18:20:24] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 268 seconds)
[18:27:19] *** Quits: bandithijo (~bandithij@fedora/bandithijo) (Quit: WeeChat 3.2-rc1)
[18:33:36] *** Joins: bandithijo (~bandithij@fedora/bandithijo)
[18:48:10] *** Quits: Garb0 (~Garb0@user/garb0) (Ping timeout: 265 seconds)
[18:50:52] *** Joins: crawler (~crawler@user/crawler)
[18:51:54] *** Joins: Garb0 (~Garb0@user/garb0)
[19:10:54] *** Quits: Garb0 (~Garb0@user/garb0) (Quit: Garb0)
[19:21:52] *** Quits: crawler (~crawler@user/crawler) (Ping timeout: 252 seconds)
[19:22:12] *** Joins: crawler (~crawler@user/crawler)
[19:22:14] *** Quits: crawler (~crawler@user/crawler) (Excess Flood)
[19:22:33] *** Joins: crawler (~crawler@user/crawler)
[19:22:35] *** Quits: crawler (~crawler@user/crawler) (Excess Flood)
[19:22:54] *** Joins: crawler (~crawler@user/crawler)
[19:22:56] *** Quits: crawler (~crawler@user/crawler) (Excess Flood)
[19:23:14] *** Joins: crawler (~crawler@user/crawler)
[19:23:16] *** Quits: crawler (~crawler@user/crawler) (Excess Flood)
[19:27:47] *** Joins: gr33n7007h (~gr33n7007@user/gr33n7007h)
[19:31:06] *** Joins: Guest6 (~Guest6@2001:8a0:63a4:8500:6472:e21f:dd50:aa25)
[19:31:41] *** Quits: Guest6 (~Guest6@2001:8a0:63a4:8500:6472:e21f:dd50:aa25) (Client Quit)
[19:51:04] *** Quits: bandithijo (~bandithij@fedora/bandithijo) (Quit: WeeChat 3.2-rc1)
[20:06:50] *** Quits: unmanbearpig (~unmanbear@user/unmanbearpig) (Read error: Connection reset by peer)
[20:16:05] *** Joins: AriT93 (~AriT93@173.226.103.218)
[20:18:00] <jidar> jwr adam12, yall could init the repo bare I think? so it doesn't contain all the old commits https://github.blog/2020-12-21-get-up-to-speed-with-partial-clone-and-shallow-clone/ maybe can help with something like, `git clone --filter=tree:0 <url>` or similar? curious though
[20:19:11] <jidar> --depth=1 rather
[20:22:21] *** Joins: jetchisel (jetchisel@user/jetchisel)
[20:42:37] *** Joins: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com)
[20:45:19] *** Quits: drincruz (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 268 seconds)
[21:04:34] *** Quits: teclator (~quassel@85.155.180.70.dyn.user.ono.com) (Remote host closed the connection)
[21:06:24] *** Quits: drincruz_ (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com) (Ping timeout: 265 seconds)
[21:07:26] *** Joins: drincruz_ (~drincruz@ool-44c748be.dyn.optonline.net)
[21:13:01] *** Joins: ur5us (~ur5us@2406:e002:6b09:8901:dc29:12ba:98a9:f1d4)
[21:26:39] *** Joins: bonhoeffer (~tim@068-113-196-027.res.spectrum.com)
[21:26:50] <bonhoeffer> anyone get mach-o but wrong architecture rails on m1 when trying to run stuff
[21:39:12] *** Quits: jetchisel (jetchisel@user/jetchisel) (Quit: Unfortunately time is always against us -- [Morpheus])
[21:48:07] *** Joins: orbyt (~textual@172.92.4.78)
[21:48:13] <orbyt> Hey folks
[21:48:15] <orbyt> https://pastebin.com/1dR6Wp0M
[21:48:59] <orbyt> My Ruby skills are quite rusty - is there any scenario where `primary_search_term` would already have a value if this is the first reference to it in a module?
[21:49:24] <orbyt> My understanding of ||= is "if variable has no existing variable assign it this"
[21:49:35] <adam12> orbyt: primary_search_term is a local, so likely not.
[21:50:02] <adam12> bonhoeffer: exact error?
[21:50:32] <adam12> orbyt: and your understanding is _slightly_ wrong. It's basically if variable is nil or false.
[21:51:45] <adam12> orbyt: Show more code and we could probably look into it a bit more deeply, since a lot of context is lost by just showing the single statement.
[21:51:56] <orbyt> So if `primary_search_term` was null or a boolean == false, assign the following?
[21:52:33] <orbyt> Yea, I just saw that operator in a PR and it struck me as an error because I couldn't find how it could possible already have a value
[21:52:56] <orbyt> Wanted to check here before bringing it up in the PR
[21:53:43] <adam12> orbyt: Correct. It's often used for memoizing a value of a method call. `def foo; @foo ||= expensive_call_to_get_foo; end`.
[21:54:30] <orbyt> Cool, thanks
[21:54:44] <orbyt> We'll see what the PR submitter thinks
[21:54:51] <adam12> orbyt: If it's not passed into the method, and this is the first time it's being used, the ||= is probably unnecessary. But again, we lose a lot of context just seeing the small piece of the puzzle.
[21:55:57] <orbyt> Yea, I did a path search in rubymine and it's only used twice; there and then used again to reference a property: `term_display_name: primary_search_term.provider_description`
[21:56:11] <adam12> The `||=` is likely not hurting anything over just `=`, but it's definitely a source of indirection.
[21:56:53] <adam12> Maybe the entire method you pulled it from is wrong? The use of `#map` there looks wrong...
[21:59:05] <adam12> I'd expect `find` there.. since presumably the assignment would be a single value and not an array of nil's.
[21:59:23] <orbyt> Hmm, okay let me post more code
[22:00:54] <orbyt> https://pastebin.com/Ad81Uw8V
[22:01:12] *** Joins: Garb0 (~Garb0@user/garb0)
[22:01:31] <orbyt> L12-29 are the new additions
[22:01:42] <orbyt> +63
[22:01:44] <adam12> primary_search_term definitely doesn't need an or-equals
[22:02:08] <orbyt> Cool, figured as much.
[22:02:45] <adam12> I think the #map is working because it always returns a value.
[22:03:16] <adam12> if it was `#find` and never matched, line 63 would crash with NoMethodError.
[22:03:31] <adam12> So it's a happy accident that it works
[22:03:59] <adam12> (if it was `#map` and never matched it would be an error too)
[22:05:09] <adam12> This whole file would benefit of being a class with smaller methods, imho.
[22:06:06] *** Quits: bonhoeffer (~tim@068-113-196-027.res.spectrum.com) (Ping timeout: 268 seconds)
[22:10:19] <orbyt> Ok, made some comments and noted the issue with map
[22:11:33] <orbyt> Thanks for taking a look - I don't do server dev at this company but have a very small amount of ruby experience from years ago
[22:43:03] *** Joins: drincruz (~drincruz@ec2-18-235-23-153.compute-1.amazonaws.com)
[22:44:45] *** Quits: Garb0 (~Garb0@user/garb0) (Quit: Garb0)
[22:45:38] *** Quits: drincruz_ (~drincruz@ool-44c748be.dyn.optonline.net) (Ping timeout: 255 seconds)
[23:05:13] *** Joins: lunarkitty (uid501895@user/pyra)
[23:12:12] *** Joins: altdev (~altdev@c-73-14-187-235.hsd1.co.comcast.net)
[23:14:37] *** Quits: altdev (~altdev@c-73-14-187-235.hsd1.co.comcast.net) (Client Quit)
[23:35:45] *** Joins: postmodern (~postmoder@user/postmodern)
