[00:17:32] *** Quits: Naktibalda (~Naktibald@88.135.22.17) (Quit: There's nothing dirtier than a giant ball of oil)
[00:28:25] <skyfall> I'm trying to use specialization for the "person" table https://bpa.st/Q57A I followed the steps from the reference book but for some reason the SELECT query throws an error. Am I doing something incorrect there? Or is it right way of querying the subclass/superclass tables? My example is similar to EMPLOYEE table in this picture:
[00:28:25] <skyfall> https://ibb.co/Fq1Z7rm and I followed Option 8A here: https://ibb.co/3Yh3BWR Could someone please help me with this?
[01:02:27] <thumbs> skyfall: what error do you get?
[01:20:02] <skyfall> thumbs: ERROR 1066 (42000) at line 75: Not unique table/alias: 'student'
[01:24:14] <thumbs> skyfall: so define unique aliases. See AS
[01:24:44] <thumbs> FROM tblname AS t1 JOIN tblname AS t2 ON ...
[01:24:47] <Xgc> skyfall: Remove all this mess:   FROM person, student, professors
[01:24:47] <Xgc> .  Leave just person
[01:25:06] <thumbs> ugh, and don't use commas in the FROM clause either
[01:25:33] <Xgc> skyfall: The JOIN / ON form is ok.  But you added the comma list of tables too, which is redundant.
[01:26:11] <Xgc> skyfall: https://dbfiddle.uk/?rdbms=mysql_8.0&fiddle=d047dbd148bb6269c2693724a6278be1
[01:27:05] <Xgc> skyfall: student was in the FROM clause twice, leading to that error.
[01:27:06] <skyfall> Yeah, I entered `SELECT * FROM person JOIN student ON person.person_id = student.person_id JOIN professors ON person.person_id = professors.person_id JOIN workers ON person.person_id = workers.person_id` However, this returns a 0 tuples.
[01:27:25] <Xgc> skyfall: That's fine.  That just means you have no data matching that criteria.
[01:28:03] <Xgc> skyfall: Remember, inner joins will return only matches.  So if there isn't a match in each join, the result is empty.
[01:28:19] <skyfall> But isn't specialization involve JOINing all the subclasses with the superclass?
[01:28:41] <Xgc> skyfall: I'm talking about your query logic, not about your concept of specialization.
[01:29:07] <skyfall> I see.
[01:29:19] <Xgc> skyfall: It's possible you want outer join behavior, if you expect some joins will find no matches and still want the base table rows.
[01:29:34] <skyfall> The reference says: "an EQUIJOIN operation on the primary key between subclass and superclass is performed"
[01:30:04] <Xgc> skyfall: For instance, a person might be only one of the special types.  That means the other joins will fail for that person and return no results for that person.
[01:30:07] <skyfall> Here: https://ibb.co/3Yh3BWR
[01:30:23] <Xgc> skyfall: Try left join.
[01:31:36] <skyfall> Yeah, exactly. LEFT JOIN is something I was looking for. I was confused since the source mentioned "EQUIJOIN".
[01:31:45] <skyfall> s/source/reference/
[01:33:11] <skyfall> Xgc: In general, my implementation of person as superclass and student, professor and worker as subclass as a valid implementation of SQL Specialization, right?
[01:33:34] <thumbs> it can be a mistake to associate classes to tables, be careful
[01:33:41] <skyfall> Meaning, I'm in the right path with my DDL statements, right?
[01:34:09] <thumbs> tables are closer to entities than object oriented classes
[01:38:20] <Xgc> skyfall: You can do that.  But the way you joined required a person to be every type or the person would not be in the result.
[01:38:42] <Xgc> skyfall: LEFT JOIN would resolve that.
[01:39:03] <thumbs> are you an employee, manager, owner at the same time?
[01:39:27] <skyfall> thumbs: No, in my example, it's a disjoint.
[01:39:31] <Xgc> or in this case, student, worker and professor at the same time.
[01:39:51] <Xgc> skyfall: That's the cause of the empty result.
[01:40:16] <Xgc> skyfall: https://dbfiddle.uk/?rdbms=mysql_8.0&fiddle=41290f6b4d958f3c80c990b86713f84c
[01:40:17] <thumbs> sure, some folks might be very busy, but not everyone, surely
[01:40:54] <Xgc> skyfall: None of your data matches.
[01:41:03] <skyfall> Is there a way I can restrict that disjoint condition such that INSERT operation would result in an error preventing us from accidentally mapping FK of person into at most one of the subclasses?
[01:41:27] <Xgc> skyfall: Better done with a different design.
[01:42:52] <Xgc> skyfall: Unique constraint doesn't operate across multiple tables.  It's much better to have a person_type mapping table and then add UNIQUE INDEX (person_id) to restrict each person to one row/mapping.
[01:43:13] <skyfall> So, in this design, if I wanted to know the category each person belongs, how will I know that? (without having that SELECT and LEFT JOIN and checking for NULLs)? Should I need to include another attribute within person with VARCHAR for explicitly saying which one of the categories the person belongs?
[01:43:24] <Xgc> skyfall: or just add a type_id in the person table, to a type table.
[01:43:59] <skyfall> type_id VARCHAR in person table right? Like, type_id would contain "student", "professor" or "worker" right?
[01:45:08] <thumbs> type_id can be a FK reference to another table as well
[01:45:25] <thumbs> depending on the level of normalization you want to achieve
[01:45:51] <Xgc> skyfall: Something like that.  But a key, as thumbs suggests, could refer to more useful detail.
[01:47:53] <skyfall> Yeah, that makes sense. Thank you both of you!
[01:48:02] <Xgc> skyfall: Use single quotes for literals which require quoting.  Double quotes are for identifiers in the standard, even though MySQL doesn't go by the standard with default configuration.
[01:48:57] <Xgc> Better to just use single quotes.  It'll make your life easier.
[01:49:44] <thumbs> Xgc: I also cringe when I see MSSQL folks use single quotes for aliases
[01:50:45] <skyfall> Xgc: Hmm, interesting. I didn't know that.
[02:03:52] *** Quits: forgotmynick (uid24625@id-24625.hampstead.irccloud.com) (Quit: Connection closed for inactivity)
[02:06:46] *** Quits: lamneth (~IceChat95@2607:fa49:2107:c900:5152:db00:b557:f816) (Ping timeout: 260 seconds)
[02:32:01] *** Joins: lamneth (~IceChat95@2607:fa49:2107:c900:4c67:2143:2cce:6f02)
[04:01:04] *** Quits: freeworld (~vit@chello085216193138.chello.sk) (Ping timeout: 272 seconds)
[04:15:24] *** Quits: rvalue (~rvalue@user/rvalue) (Ping timeout: 265 seconds)
[04:19:46] *** Joins: rvalue (~rvalue@user/rvalue)
[04:20:29] *** Quits: shibboleth (~shibbolet@user/shibboleth) (Quit: shibboleth)
[04:50:11] *** Joins: forgotmynick (uid24625@id-24625.hampstead.irccloud.com)
[05:20:26] *** Joins: ryp (cjp@user/ryp)
[05:40:23] *** Quits: ryp (cjp@user/ryp) ()
[05:46:58] *** Quits: lamneth (~IceChat95@2607:fa49:2107:c900:4c67:2143:2cce:6f02) (Quit: Easy as 3.14159265358979323846...)
[06:19:31] *** Joins: ryp (~ryp@user/ryp)
[06:22:00] *** Quits: highrate (~presonic@111-22-237-24.gci.net) (Changing host)
[06:22:00] *** Joins: highrate (~presonic@user/highrate)
[06:53:26] *** Quits: Vacuity (~Vacuity@user/vovo) (Ping timeout: 252 seconds)
[06:55:06] *** Joins: Vacuity (~Vacuity@user/vovo)
[07:01:50] *** Joins: David-- (~none@5750642f.skybroadband.com)
[07:02:26] *** Quits: David- (~none@5750642f.skybroadband.com) (Ping timeout: 245 seconds)
[07:07:44] *** Joins: Azem (~haise01@user/haise01)
[07:10:55] *** Quits: Emet-Selch (~haise01@user/haise01) (Ping timeout: 256 seconds)
[07:28:57] *** Quits: ryp (~ryp@user/ryp) (Quit: leaving)
[07:29:39] *** Quits: forgotmynick (uid24625@id-24625.hampstead.irccloud.com) (Quit: Connection closed for inactivity)
[07:48:19] *** Joins: ryp (~ryp@user/ryp)
[09:13:18] *** Joins: forgotmynick (uid24625@id-24625.hampstead.irccloud.com)
[09:39:02] *** Quits: rvalue (~rvalue@user/rvalue) (Read error: Connection reset by peer)
[09:39:15] *** Joins: rvalue (~rvalue@user/rvalue)
[09:41:57] *** Quits: brentaarnold (~brentaarn@24.112.56.42) (Ping timeout: 240 seconds)
[10:05:24] *** Quits: tercaL (~tercaL@user/tercal) (Remote host closed the connection)
[10:33:36] *** Quits: mickey8 (~user@user/mickey) (Remote host closed the connection)
[10:34:56] *** Joins: mickey8 (~user@user/mickey)
[11:00:31] <thumbs> !tell me backup
[11:00:31] <ubiquity_bot> thumbs: Choices for backing up MySQL data include: stopping the server and copying the files :: mysqldump (-F|--single-transaction) :: LVM snapshot :: innobackup/xtrabackup :: replication AND one of the previous.
[11:18:51] <Isotopp> thumbs: and https://dev.mysql.com/doc/refman/8.0/en/clone-plugin.html for mysql 8
[11:19:03] <Isotopp> it comes with its own set of restrictions, but nothing is faster
[11:21:46] <thumbs> someone in Maria wants to magically resync a slave with missing binlogs
[11:21:49] <thumbs> hah
[11:22:23] <thumbs> a TARDIS would be handy here
[11:24:23] *** Joins: greenriot (~greenriot@user/gr33nr10t)
[11:24:26] <Isotopp> Hm. Yeah.
[11:24:47] *** Quits: gr33nR10t (~greenriot@user/gr33nr10t) (Ping timeout: 256 seconds)
[11:25:06] <Isotopp> I am still looking for a solution that ships binlogs live to an external storage. Best idea so far is a replica that has all blackholed tables and does not delete relay log.
[11:27:13] <thumbs> that is the only space-conscencious approach
[11:28:17] <Isotopp> The disadvantage being that this renumbers, so GTID is mandatory. A proper binlog relay would not, so even dumb non-gtid replicas could profit. Well, ...
[11:28:24] <Isotopp> that did't happen ever in mysql space.
[11:31:11] <thumbs> you can't exactly rsync the files either
[11:39:39] *** Quits: forgotmynick (uid24625@id-24625.hampstead.irccloud.com) (Quit: Connection closed for inactivity)
[11:55:57] *** Quits: ryp (~ryp@user/ryp) (Ping timeout: 256 seconds)
[12:26:53] *** Joins: ryp (~ryp@user/ryp)
[13:58:46] *** Joins: Naktibalda (~Naktibald@88.135.22.17)
[14:15:27] *** Quits: Naktibalda (~Naktibald@88.135.22.17) (Quit: Never put off till tomorrow, what you can do the day after tomorrow)
[14:37:34] *** Joins: magga (magga@ti0036a400-3577.bb.online.no)
[14:49:08] *** Joins: tercaL (~tercaL@user/tercal)
[15:32:02] *** Quits: dslegends (~dslegends@user/dslegends) (Quit: ZNC 1.8.2 - https://znc.in)
[15:34:12] *** Joins: dslegends (~dslegends@user/dslegends)
[15:39:53] *** Joins: bm (~bm@user/bm)
[15:56:11] *** Quits: bm (~bm@user/bm) (Quit: bm)
[17:12:45] *** Quits: tercaL (~tercaL@user/tercal) (Quit: halt -p)
[17:30:02] *** Quits: Kuraokami (unit193@libera/staff/unit193) (Ping timeout: 268 seconds)
[17:36:27] *** Quits: PeGaSuS (WeeChat@user/pegasus) (Remote host closed the connection)
[17:40:36] *** Joins: PeGaSuS (WeeChat@user/pegasus)
[18:28:38] *** Quits: jwash (~jwash@c-73-254-46-148.hsd1.wa.comcast.net) (Read error: Connection reset by peer)
[18:32:33] *** Joins: jwash (~jwash@c-73-254-46-148.hsd1.wa.comcast.net)
[18:57:28] *** Parts: Mushfiq[m] (~mushfiqma@2001:470:69fc:105::1:b3f7) ()
[18:58:10] *** Quits: passage (~passage@user/passage) (Quit: Lost terminal)
[19:26:15] *** Joins: Naktibalda (~Naktibald@88.135.22.17)
[19:46:15] *** Quits: Naktibalda (~Naktibald@88.135.22.17) (Quit: Excess flood. Did someone see an ark float by?)
[20:14:29] *** Joins: ferdna (~ferdna@user/ferdna)
[22:10:38] *** Quits: magga (magga@ti0036a400-3577.bb.online.no) (Remote host closed the connection)
[22:10:54] *** Joins: magga (magga@ti0036a400-3577.bb.online.no)
[22:55:38] <skyfall> I'm trying to INSERT into a table where the the primary key is also a referenced as a foreign key within the same table. For example, in `employee` table, the PK is `employee_SSN` but that table has a FK `employee_manager_SSN` which is a foreign key referencing to itself (employee_SSN). I'm not sure how I can INSERT values into such a table. Could
[22:55:38] <skyfall> someone help me out?
[22:56:47] <thumbs> the parent row must exist prior to insertion
[22:57:40] <skyfall> But how could that be possible? Here is the DDL for `employee` table: https://bpa.st/PSJA
[22:58:11] <thumbs> if the manager ID is 2, then the employee is 3, then 2 must be in the table prior
[22:59:15] <thumbs> then you can insert specifying 2 as the employee_manager_SSN
[22:59:53] <skyfall> I'm trying to load it from a raw CSV like file. Here's the sample: https://bpa.st/raw/XAIQ
[22:59:58] <skyfall> My LOAD statement was:
[23:00:00] <skyfall> LOAD DATA INFILE 'employee.dat' INTO TABLE employee FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n';
[23:01:14] <thumbs> you can skip the constraints for those insertions, if you have to
[23:01:44] <skyfall> Hmm, I'm not sure I could do that.
[23:01:50] <skyfall> *how I could do that.
[23:02:08] <thumbs> SET FOREIGN_KEY_CHECKS=0;
[23:06:02] <skyfall> But setting that flag and loading the data using LOAD DATA writs NULL values on the 1st and other columns: https://ibb.co/zr069TS
[23:06:17] <skyfall> Not sure why it fills NULLs.
[23:12:28] *** Joins: brentaarnold (~brentaarn@24.112.92.157)
[23:13:12] <thumbs> how many levels do you have?
[23:14:33] *** Quits: brentaarnold (~brentaarn@24.112.92.157) (Read error: Connection reset by peer)
[23:15:54] <Xgc> skyfall: Who is the top level manager?  For that manager, what would be the manager reference?  Usually, we use NULL for that.  Now all you need to do is be sure to insert them in the right order, top down.
[23:17:35] *** Joins: brentaarnold (~brentaarn@24.112.56.42)
[23:18:37] <Xgc> skyfall: There are various ways to do that. If your csv is not well ordered, just load that into a table without constraints and then INSERT INTO final_table ... SELECT ... FROM staging_table ... ORDER BY superssn IS NOT NULL;
[23:20:58] *** Joins: tercaL (~tercaL@user/tercal)
[23:22:28] <Xgc> skyfall: If you've imported 'null', the string literal, to mean "top level manager", just use that to order the inserts.  ORDER BY superssn <> 'null'
[23:31:45] <skyfall> This is the schema: https://ibb.co/fNQvjrD
[23:31:46] <skyfall> Oh
[23:32:01] <skyfall> The top level manager seem to have NULL value.
[23:32:17] <skyfall> I was puzzled.
[23:36:08] *** Joins: lara99 (~lara99@93-36-163-139.ip61.fastwebnet.it)
[23:38:16] <Xgc> skyfall: The exported csv could have been ordered better as well... or you could order that before loading.
[23:44:06] *** Quits: lara99 (~lara99@93-36-163-139.ip61.fastwebnet.it) (Quit: Client closed)
