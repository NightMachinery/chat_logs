[14:05:03] *** Joins: greyrat (~greyrat@ip202.ip-51-178-215.eu)
[14:05:03] *** Server sets mode: +nt 
[14:05:24] <greyrat> How do I get `curl --head ...` as JSON? 
[14:11:16] *** Joins: cedric (~cedric@2a01:cb11:821:7c00:8126:9ac6:18bc:223)
[14:18:02] *** Quits: cedric (~cedric@2a01:cb11:821:7c00:8126:9ac6:18bc:223) (Quit: Konversation terminated!)
[14:25:34] *** Joins: Xaldafax (~xaldafax@cpe-198-72-160-101.socal.res.rr.com)
[14:29:15] *** Joins: betelgeuse (~betelgeus@94-225-47-8.access.telenet.be)
[14:35:14] *** Quits: beeza (sid53872@id-53872.tinside.irccloud.com) (Quit: Connection closed for inactivity)
[14:56:03] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 265 seconds)
[14:57:27] *** Joins: Vonter (~Vonter@user/vonter)
[15:12:35] <Piru> greyrat: can you elaborate what you mean by that?
[15:55:12] *** Quits: icing (~stefan@user/icing) (Remote host closed the connection)
[15:55:51] *** Joins: icing (~stefan@p200300c92701db0029b6fb29cf9116da.dip0.t-ipconnect.de)
[15:55:51] *** Quits: icing (~stefan@p200300c92701db0029b6fb29cf9116da.dip0.t-ipconnect.de) (Changing host)
[15:55:51] *** Joins: icing (~stefan@user/icing)
[16:04:16] *** Quits: icing (~stefan@user/icing) (Ping timeout: 252 seconds)
[16:07:54] *** Joins: gh34 (~textual@cpe-184-58-181-106.wi.res.rr.com)
[16:20:00] <greyrat> Piru: I want to get the HTML headers parsed as JSON. I am currently using regexes to extract info from them, and as I just noticed, this is a rather fragile business.
[16:25:07] <bagder> that sounds a bit backwards
[16:25:16] <bagder> and they'r http headers, not html =)
[16:27:49] <greyrat> bagder: Oh yes, sorry. My goal is to get the `content-disposition: filename` from the site. How do you do this in a "not backwards" way?
[16:28:10] <bagder> by not involving json to start with
[16:28:35] <bagder> the data comes in a http header, better just parse that header as best as possible
[16:28:38] <greyrat> JSON is just an example of a machine-readable format that I can readily manipulate on the CLI.
[16:29:40] <bagder> http header is another machine readable format
[16:30:10] <greyrat> bagder: So what are some tools that can read it?
[16:30:48] <bagder> everything?
[16:30:53] <bagder> its a text format
[16:31:03] <greyrat> Ok, give me a bash oneliner to get that property.
[16:31:10] <greyrat> Without using regexes, of course.
[16:31:25] <bagder> is that your metric for if its machine-readable?
[16:31:29] <greyrat> yes
[16:31:39] <bagder> ok, then good luck
[16:35:43] <lazyreader> awk?
[16:36:55] <testuser[m]> curl site.com | grep ^content-disposition
[16:37:07] <testuser[m]> --head*
[16:43:05] <lazyreader> | cut -d’ ‘ -f 1
[16:43:29] <lazyreader> Ah -f 1-
[16:43:33] <lazyreader> iirc.
[16:45:25] <testuser[m]> it can all be done with a single awk command but this is more convinient :p
[17:04:25] <greyrat> I know, but as I said before, my previous such hack just broke today (because it expected `"` around the property value), so I decided to use sth mature and not a throwaway awk/perl/grep oneliner. I have found this thus far:
[17:04:33] <greyrat> from kiss_headers import parse_it, dumps
[17:04:33] <greyrat> headers = parse_it(request_text)
[17:04:33] <greyrat> print(dumps(headers))
[17:04:44] <greyrat> https://github.com/Ousret/kiss-headers
[17:06:19] *** Joins: otisolsen70_ (~otisolsen@xd4ed80b5.cust.hiper.dk)
[17:09:47] *** Quits: otisolsen70 (~otisolsen@xd4ed80b5.cust.hiper.dk) (Ping timeout: 252 seconds)
[17:12:41] *** Quits: otisolsen70_ (~otisolsen@xd4ed80b5.cust.hiper.dk) (Ping timeout: 264 seconds)
[17:17:41] <greyrat> Okay, this tool also broke: https://github.com/Ousret/kiss-headers/issues/47
[17:17:42] -curelbot- [GitHub] Issue #47: [ (https://github.com/Ousret/kiss-headers/issues/47)
[17:18:34] <bagder> content-disposition is a pretty complicated header too
[17:19:07] <greyrat> badger: this "bug" is just curl outputting extra stuff in its output
[17:19:41] <bagder> which "bug" is that?
[17:20:05] <greyrat> Perhaps there is some switch that turns that off, but it should have printed that to stderr to begin with. :facepalms:
[17:20:18] <greyrat> badger: When a proxy is used, there is an additional HTTP/1.1 200 Connection established\n\n
[17:20:59] <bagder> yes
[17:21:18] <bagder> that's how curl works
[17:21:21] <bagder> by default at least
[17:21:38] <greyrat> Well, it obviously breaks header parsers, as poor things look for the blank lines to split the content into header and body.
[17:22:14] <bagder> those obviously were then not designed to work with the default curl -i output when using https over proxies
[17:22:27] *** Quits: jfuller (~jimfuller@37-48-0-15.nat.epc.tmcz.cz) (Quit: Lost terminal)
[17:22:42] <bagder> curl has worked like this for over twenty years, it's not a surprise
[17:23:10] <bagder> --suppress-connect-headers might help
[17:23:18] <greyrat> Hmm let me test.
[17:24:26] <greyrat> Thanks, it works.
[18:20:56] *** Quits: jmcgnh (~jmcgnh@wikipedia/jmcgnh) (Ping timeout: 245 seconds)
[18:27:29] *** Joins: jmcgnh (~jmcgnh@wikipedia/jmcgnh)
[18:28:06] *** Joins: magla (~gelignite@55d431b0.access.ecotel.net)
[18:48:41] *** Joins: shored (~shored@user/shored)
[19:15:46] *** Quits: pvp (~pierrepri@p54ae9757.dip0.t-ipconnect.de) (Quit: The Lounge - https://thelounge.chat)
[19:16:50] *** Joins: pvp (~pierrepri@p54ae9757.dip0.t-ipconnect.de)
[19:54:16] *** Quits: cmeister2 (~cmeister2@214.61.9.51.dyn.plus.net) (Ping timeout: 245 seconds)
[19:57:23] *** Joins: cmeister2 (~cmeister2@214.61.9.51.dyn.plus.net)
[20:00:10] *** Quits: uid_max (~samw@host165-120-45-38.range165-120.btcentralplus.com) (Quit: Leaving)
[20:01:45] *** Joins: icing (~stefan@user/icing)
[20:06:11] *** Quits: icing (~stefan@user/icing) (Ping timeout: 246 seconds)
[20:29:12] *** Quits: callmepk (~callmepk@wslu/callmepk) (Quit: Computer sleeping)
[20:59:31] *** Joins: icing (~stefan@user/icing)
[20:59:57] *** Quits: icing (~stefan@user/icing) (Client Quit)
[21:51:24] *** Quits: darkstardevx (~darkstard@2601:1c2:300:c8a0::f2b6) (Read error: Connection reset by peer)
[22:08:04] *** Joins: darkstardevx (~darkstard@2601:1c2:300:c8a0::f2b6)
[22:10:00] *** Joins: dege (~dege@user/dege)
[22:21:43] <dege> bagder: I had a skim over the CI failures of 7322 and they seem to be all timeouts etc .. is that your picture as well? Just want to make sure I'm not missing anything before pushing
[22:28:30] *** Quits: swex (~z@95.73.128.16) (Quit: swex)
[22:31:10] *** Joins: swex (~z@95.73.128.16)
[22:35:43] *** Quits: swex (~z@95.73.128.16) (Client Quit)
[22:37:33] *** Joins: swex (~z@95.73.128.16)
[22:37:56] *** Quits: gslin (~gslin@114-34-121-114.hinet-ip.hinet.net) (Quit: WeeChat 2.8)
[22:42:08] *** Quits: magla (~gelignite@55d431b0.access.ecotel.net) (Quit: Stay safe!)
[23:41:13] *** Quits: bch (~bch@S01069050ca2cbf63.ok.shawcable.net) (Quit: rebooter)
[23:49:10] *** Joins: bch (~bch@S01069050ca2cbf63.ok.shawcable.net)
[23:56:58] *** Joins: Administratorte (~sq@tempest.math.colostate.edu)
