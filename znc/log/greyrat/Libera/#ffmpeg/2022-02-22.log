[00:05:06] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 272 seconds)
[00:08:58] *** Quits: microchip_ (~neutrino@user/microchip/x-0766185) (Quit: There is no spoon!)
[00:09:16] *** Joins: microchip_ (~neutrino@user/microchip/x-0766185)
[00:09:17] *** Joins: Vonter (~Vonter@user/vonter)
[00:09:42] *** Quits: microchip_ (~neutrino@user/microchip/x-0766185) (Client Quit)
[00:16:34] *** Joins: microchip_ (~neutrino@user/microchip/x-0766185)
[00:23:05] *** Quits: microchip_ (~neutrino@user/microchip/x-0766185) (Remote host closed the connection)
[00:23:42] *** Joins: jab416171 (~jab416171@c-67-161-208-65.hsd1.ut.comcast.net)
[00:25:19] *** Joins: microchip_ (~neutrino@user/microchip/x-0766185)
[00:31:40] *** Quits: Blacker47 (~Blacker47@user/blacker47) (Quit: Life is short. Get a V.90 modem fast!)
[00:34:15] *** Quits: ___nick___ (~quassel@cpc68286-cdif17-2-0-cust533.5-1.cable.virginm.net) (Ping timeout: 272 seconds)
[00:35:03] *** Joins: AbleBacon (~AbleBacon@user/AbleBacon)
[00:36:20] *** Joins: crashrep (~crashrep@user/crashrep)
[00:43:17] *** Quits: therobin (~UserNick@2607:f2c0:94b9:9e00:19a6:9469:19f5:bbdf) (Ping timeout: 240 seconds)
[00:48:23] *** Joins: therobin (~UserNick@2607:f2c0:94b9:9e00:d1f4:1232:acc8:b614)
[00:50:02] *** Quits: dreamon (~dreamon@pd95035d1.dip0.t-ipconnect.de) (Ping timeout: 260 seconds)
[00:52:30] *** beaver is now known as pong
[00:52:38] <aphysically> ahh I can't find a sample for eia608 painted on the video on samples.ffmpeg.org, but maybe I'm bad at looking
[00:53:27] <aphysically> hmmm maybe in MPEG2?
[00:54:39] *** Quits: Volgaar (~volgaar@147.94.11.43) (Quit: WeeChat 3.4)
[00:54:47] <JEEB> yea, there is one that I utilized for the fix_sub_duration test
[00:57:55] *** Quits: crashrep (~crashrep@user/crashrep) (Ping timeout: 240 seconds)
[00:58:08] *** Quits: dbolton_ (~dbolton@2601:204:d77f:a9d7:a107:8229:a0f0:432d) (Quit: Leaving)
[00:59:07] *** Joins: crashrep (~crashrep@user/crashrep)
[01:01:15] <aphysically> ah found one
[01:01:17] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 240 seconds)
[01:02:57] *** Quits: lavaball (felix@31.204.155.215) (Ping timeout: 240 seconds)
[01:03:15] *** Quits: crashrep (~crashrep@user/crashrep) (Ping timeout: 240 seconds)
[01:04:40] *** Joins: mthall (~quassel@mail.thalliman.com)
[01:06:21] *** Joins: crashrep (~crashrep@user/crashrep)
[01:06:36] *** Joins: lavaball (felix@31.204.155.215)
[01:10:35] *** Quits: crashrep (~crashrep@user/crashrep) (Ping timeout: 240 seconds)
[01:11:36] *** Quits: jab416171 (~jab416171@c-67-161-208-65.hsd1.ut.comcast.net) (Ping timeout: 272 seconds)
[01:15:02] *** Joins: jab416171 (~jab416171@c-67-161-208-65.hsd1.ut.comcast.net)
[01:15:37] *** Quits: pong (~beaver@user/pong) (Quit: plouf)
[01:17:28] *** Joins: crashrep (~crashrep@user/crashrep)
[01:20:53] *** Joins: Vonter (~Vonter@user/vonter)
[01:20:59] *** Quits: emagex (~user@user/emagex) (Ping timeout: 256 seconds)
[01:21:49] *** Quits: rv1sr (~rv1sr@user/rv1sr) ()
[01:34:35] *** Quits: Gaboradon (~Gaboradon@user/Gaboradon) (Remote host closed the connection)
[01:35:20] *** Joins: Gaboradon (~Gaboradon@user/Gaboradon)
[01:38:14] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[01:43:36] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 256 seconds)
[01:48:42] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[01:49:06] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Ping timeout: 245 seconds)
[01:50:12] *** Quits: kurosu (uid342582@id-342582.hampstead.irccloud.com) (Quit: Connection closed for inactivity)
[01:50:18] *** Joins: meinside (uid24933@id-24933.helmsley.irccloud.com)
[01:50:41] *** Quits: mthall (~quassel@mail.thalliman.com) (Ping timeout: 256 seconds)
[01:51:19] *** Joins: mthall (~quassel@mail.thalliman.com)
[01:52:41] *** Joins: geowiesnot (~user@5-51-190-244.abo.bbox.fr)
[01:53:24] *** Joins: johnjaye (~pi@173.209.64.74)
[01:56:38] *** Quits: Buster_ (~Buster@buster-net.ru) (Ping timeout: 256 seconds)
[02:07:53] <aphysically> hmm, so I can get the subtitles with -f lavfi movie=Closedcaption_rollup.ts[out0+subcc] but then the result has no audio
[02:12:24] *** Quits: iconoclasthero (~quassel@pool-100-14-231-162.phlapa.fios.verizon.net) (Ping timeout: 272 seconds)
[02:17:50] <aphysically> i guess that's cause lavfi is just the video
[02:17:57] <aphysically> gross
[02:18:38] *** Parts: bencc1 (~bencc1@2a00:a040:197:3af:9b9c:57a0:a273:91be) (Leaving)
[02:19:14] <aphysically> is there a way to keep in the audio and make it one input still?
[02:23:04] *** Quits: palasso (~palasso@user/palasso) (Read error: Connection reset by peer)
[02:29:16] *** Quits: fkaa (~fkaa@user/fkaa) (Remote host closed the connection)
[03:03:53] *** Quits: cosimone (~user@93-34-132-33.ip49.fastwebnet.it) (Ping timeout: 250 seconds)
[03:04:15] *** Quits: milkt (~debian@gateway/tor-sasl/milkt) (Ping timeout: 240 seconds)
[03:06:34] *** Joins: milkt (~debian@gateway/tor-sasl/milkt)
[03:13:21] *** Joins: Vonter (~Vonter@user/vonter)
[03:13:55] *** Joins: JGod-P666-78 (~JGod-P666@87.72.62.74)
[03:13:57] *** Quits: therobin (~UserNick@2607:f2c0:94b9:9e00:d1f4:1232:acc8:b614) (Ping timeout: 240 seconds)
[03:14:03] *** Quits: minimal (~minimal@user/minimal) (Quit: Leaving)
[03:21:21] *** Joins: therobin (~UserNick@2607:f2c0:94b9:9e00:4cd5:b6e1:f625:9291)
[03:25:01] *** Joins: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6)
[03:36:06] *** Quits: dgcampea (~dgc@user/dgcampea) (Remote host closed the connection)
[03:38:18] *** Joins: dgcampea (~dgc@user/dgcampea)
[03:47:57] *** Joins: iconoclasthero (~quassel@pool-68-238-241-198.phlapa.fios.verizon.net)
[03:51:24] *** Joins: w1r3d (~w1r3d@user/w1r3d)
[03:56:44] *** Quits: w1r3d (~w1r3d@user/w1r3d) (Remote host closed the connection)
[03:58:53] *** Quits: iive (~iive@87.119.101.204.client.entry.bg) (Quit: They came for me...)
[04:02:48] *** Joins: MrZeus_ (~MrZeus@185.248.85.10)
[04:03:43] *** Quits: SpeakerToMeat (~Speaker@user/speakertomeat) (Read error: Connection reset by peer)
[04:04:42] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 256 seconds)
[04:05:57] *** Quits: MrZeus (~MrZeus@185.248.85.53) (Ping timeout: 240 seconds)
[04:10:28] *** Joins: anon-test (~anon-test@cpe-76-91-65-21.socal.res.rr.com)
[04:11:43] *** Quits: anon-test (~anon-test@cpe-76-91-65-21.socal.res.rr.com) (Client Quit)
[04:14:00] *** Joins: Vonter (~Vonter@user/vonter)
[04:20:34] *** Joins: SpeakerToMeat (~Speaker@user/speakertomeat)
[04:32:22] *** Quits: Seirdy (~Seirdy@sourcehut/user/seirdy) (Quit: exiting 3.4)
[04:40:10] *** Quits: durandal_1707 (~computer@212.15.177.16) (Read error: Connection reset by peer)
[04:47:35] *** Quits: sebbu (~sebbu@user/sebbu) (Ping timeout: 272 seconds)
[04:55:48] *** Quits: MrZeus_ (~MrZeus@185.248.85.10) (Ping timeout: 272 seconds)
[05:02:13] *** Quits: __Myst__ (~Myst@net-47-53-166-123.cust.vodafonedsl.it) (Ping timeout: 256 seconds)
[05:03:44] *** Joins: __Myst__ (~Myst@net-93-148-190-54.cust.vodafonedsl.it)
[05:06:26] *** Quits: itsalexjones (~itsalexjo@82.4.99.241) (Read error: Connection reset by peer)
[05:06:45] *** Joins: sbrown (~sbrown@66.44.16.44)
[05:30:19] *** Quits: vlm (~vlm@user/vlm) (Quit: "")
[05:54:46] *** Quits: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6) (Quit: Client closed)
[05:54:55] *** Joins: w1r3d (~w1r3d@user/w1r3d)
[06:06:05] *** Joins: guest (~guest@222.128.6.148)
[06:06:12] *** Quits: justAstache (~justache@user/justache) (Remote host closed the connection)
[06:07:18] *** Joins: justAstache (~justache@user/justache)
[06:21:53] *** Quits: xkuru (~xkuru@user/xkuru) (Read error: Connection reset by peer)
[06:24:02] *** Joins: TheDcoder (~TheDcoder@user/thedcoder)
[06:24:43] <TheDcoder> Hi, I have a Video DVD that I would like to mux into a standalone video file in a container like mp4 or mkv, how can I do that?
[06:24:53] <TheDcoder> I don't want to re-encode the media
[06:25:33] <TheDcoder> The DVD has a couple of VOB files inside it which seem to contain the media, but not sure if I should directly concatenate those
[06:37:25] *** Quits: jos1 (~jos3@dyndsl-091-248-053-047.ewe-ip-backbone.de) (Ping timeout: 256 seconds)
[06:50:07] *** Joins: jos1 (~jos3@host-091-097-186-159.ewe-ip-backbone.de)
[06:51:44] *** Quits: waleee (~waleee@h-98-128-229-110.NA.cust.bahnhof.se) (Ping timeout: 252 seconds)
[07:09:41] *** Joins: lucaswang (~lucaswang@58.246.19.98)
[07:15:28] *** Quits: guest (~guest@222.128.6.148) (Ping timeout: 250 seconds)
[07:44:44] *** Quits: lucaswang (~lucaswang@58.246.19.98) (Quit: Connection closed)
[07:48:55] <aphysically> JEEB: if the files are just broken, if we merge the fix for the proper issue from durandel then mpv/ffmpeg breaking everywhere will probably push whatever is making the broken files to fix their problem
[07:49:26] <aphysically> although it's not great since it seems (apparently) widespread
[07:49:56] <aphysically> although a workaround is using mp4box to remux the file
[07:50:06] <aphysically> which fixes everything for ffmpeg
[08:28:01] *** Quits: sbrown (~sbrown@66.44.16.44) (Quit: Leavingâ€¦)
[08:40:26] *** Quits: malloy (~jimery@116.30.220.175) (Ping timeout: 250 seconds)
[08:42:42] *** Joins: malloy (~jimery@116.30.220.175)
[08:47:03] *** Quits: crashrep (~crashrep@user/crashrep) (Quit: WeeChat 3.4)
[08:51:21] *** Joins: crashrep (~crashrep@user/crashrep)
[09:14:13] *** Joins: guest (~guest@222.128.6.148)
[09:14:17] *** Quits: crashrep (~crashrep@user/crashrep) (Quit: WeeChat 3.4)
[09:24:31] *** Joins: sebbu (~sebbu@user/sebbu)
[09:29:12] *** Joins: crashrep (~crashrep@user/crashrep)
[09:33:29] *** Quits: crashrep (~crashrep@user/crashrep) (Client Quit)
[09:57:55] *** Joins: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6)
[10:17:57] *** Quits: microchip_ (~neutrino@user/microchip/x-0766185) (Quit: There is no spoon!)
[10:19:07] *** Joins: Jamm02 (~Jamm02@49.32.163.20)
[10:19:46] *** Joins: microchip_ (~neutrino@user/microchip/x-0766185)
[10:26:02] <aphysically> hmm,  I must have goten my tag/map order wrong :\
[10:26:07] <aphysically> uggggghhhh
[10:26:31] <aphysically> do I always map first?
[10:26:58] <aphysically> or tag first rather
[10:28:05] <aphysically> ugh what the hell
[10:35:25] *** Quits: jab416171 (~jab416171@c-67-161-208-65.hsd1.ut.comcast.net) (Ping timeout: 256 seconds)
[10:39:53] *** Joins: Volgaar (~volgaar@147.94.11.43)
[10:41:04] *** Joins: lucaswang (~lucaswang@58.246.19.98)
[10:53:38] *** Quits: Jamm02 (~Jamm02@49.32.163.20) (Quit: Connection closed)
[11:03:46] *** Quits: a0z (~a0z@90.244.190.0) (Ping timeout: 272 seconds)
[11:06:18] *** Quits: guest (~guest@222.128.6.148) (Ping timeout: 272 seconds)
[11:07:35] *** Joins: ss4 (~wootehfoo@user/wootehfoot)
[11:09:28] *** Joins: bradh (~bradh@2001:8004:1400:390e:e05b:18e9:e443:8578)
[11:10:53] *** Quits: wootehfoot (~wootehfoo@user/wootehfoot) (Ping timeout: 256 seconds)
[11:12:27] *** Joins: euphoricallysane (~quatro@user/euphoricallysane)
[11:12:42] *** Joins: cosimone (~user@93-34-132-33.ip49.fastwebnet.it)
[11:23:27] *** Joins: palasso (~palasso@user/palasso)
[11:23:33] *** Quits: w1r3d (~w1r3d@user/w1r3d) (Quit: Leaving)
[11:26:09] *** Joins: MajorBiscuit (~MajorBisc@c-001-029-040.client.tudelft.eduvpn.nl)
[11:30:22] *** Quits: Volgaar (~volgaar@147.94.11.43) (Ping timeout: 272 seconds)
[11:32:47] <bradh> I'm seeing a crash with encoding SEI messages with libx265 that doesn't occur with libx264. Not sure if there is a way to reproduce it with ffmpeg - I see it via java bindings.
[11:33:06] <bradh> Is there a way to add side data in ffmpeg command line?
[11:34:28] <JEEB> we should have something like that but we alas do not have a standardized manner of string->side data yet
[11:36:03] *** Joins: durandal_1707 (~computer@212.15.177.16)
[11:36:23] <bradh> I think I want a fix like https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/66f8055c898887c33ab124ca5f00ee60bf5fcf19 for libx265, but not sure how to manage it.
[11:36:56] <bradh> I tried reproducing it in C, but I'm not that clever either.
[11:42:55] *** Joins: guest (~guest@222.128.6.148)
[11:51:44] *** Quits: JGod-P666-78 (~JGod-P666@87.72.62.74) (Quit: Connection closed)
[11:58:10] *** Joins: Volgaar (~volgaar@147.94.11.43)
[12:01:21] *** Quits: guest (~guest@222.128.6.148) (Quit: Connection closed)
[12:07:02] *** Joins: jab416171 (~jab416171@c-67-161-208-65.hsd1.ut.comcast.net)
[12:07:22] *** Joins: arinov_ (~arinov@213.194.126.155)
[12:37:04] *** Joins: lavaball (felix@31.204.155.215)
[12:43:02] *** Joins: kurosu (uid342582@id-342582.hampstead.irccloud.com)
[12:44:28] *** Quits: KombuchaKip (~kip@192.252.230.5) (Ping timeout: 272 seconds)
[12:44:58] *** Quits: elastic_dog (~elastic_d@2a01:118f:822:9c00:f583:aa51:9ad4:d4fb) (Quit: elastic_dog)
[12:46:06] *** Joins: elastic_dog (~elastic_d@2a01:118f:822:9c00:f583:aa51:9ad4:d4fb)
[12:48:49] *** Joins: emagex (~user@user/emagex)
[12:48:52] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[13:00:55] *** Joins: cmp__ (~cmp__@lputeaux-658-1-177-87.w92-154.abo.wanadoo.fr)
[13:01:42] *** Joins: blaze (~blaze@user/blaze)
[13:08:36] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[13:16:55] *** Joins: Blacker47 (~Blacker47@user/blacker47)
[13:18:28] *** Quits: ss4 (~wootehfoo@user/wootehfoot) (Quit: Leaving)
[13:18:48] *** Joins: wootehfoot (~wootehfoo@user/wootehfoot)
[13:22:16] *** Quits: bradh (~bradh@2001:8004:1400:390e:e05b:18e9:e443:8578) (Quit: Konversation terminated!)
[13:23:31] *** Joins: johnjaye (~pi@173.209.64.74)
[13:26:54] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Quit: taupiqueur)
[13:29:28] *** Quits: johnjaye (~pi@173.209.64.74) (Remote host closed the connection)
[13:35:36] *** Joins: guest (~guest@161.117.202.209)
[13:35:57] *** Joins: you74674 (~you74674@111-251-175-139.dynamic-ip.hinet.net)
[13:37:03] *** Quits: m5zs7k (aquares@web10.mydevil.net) (Ping timeout: 272 seconds)
[13:38:13] *** Joins: m5zs7k (aquares@web10.mydevil.net)
[13:39:09] *** Quits: jarthur (~jarthur@2603-8080-1540-002d-3498-71fb-df6e-0b01.res6.spectrum.com) (Quit: jarthur)
[13:44:27] *** Joins: johnjaye (~pi@173.209.64.74)
[13:49:24] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[13:49:52] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[13:50:36] *** Quits: lucaswang (~lucaswang@58.246.19.98) (Quit: Connection closed)
[13:52:19] *** Joins: johnjaye (~pi@173.209.64.74)
[13:57:47] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 250 seconds)
[13:58:53] *** Joins: johnjaye (~pi@173.209.64.74)
[13:59:53] *** Joins: rsx (~dummy@ppp-188-174-148-71.dynamic.mnet-online.de)
[14:01:48] *** Quits: guest (~guest@161.117.202.209) (Ping timeout: 240 seconds)
[14:03:21] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[14:04:13] *** Joins: realies4 (~realies@user/realies)
[14:04:14] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[14:05:48] *** Quits: realies (~realies@user/realies) (Ping timeout: 240 seconds)
[14:05:49] *** realies4 is now known as realies
[14:09:32] *** Joins: irc_user (uid423822@id-423822.lymington.irccloud.com)
[14:16:39] *** Joins: johnjaye (~pi@173.209.64.74)
[14:22:25] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[14:24:23] *** Joins: johnjaye (~pi@173.209.64.74)
[14:28:36] *** Quits: foul_owl (~kerry@23.82.193.88) (Ping timeout: 256 seconds)
[14:30:14] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 272 seconds)
[14:30:50] *** Joins: johnjaye (~pi@173.209.64.74)
[14:35:58] *** Quits: c7s (~c7s@user/c7s) (Ping timeout: 256 seconds)
[14:36:32] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[14:42:46] *** Joins: foul_owl (~kerry@23.82.193.89)
[14:46:43] *** Quits: led_belly (~led_belly@37.120.197.44) (Read error: Connection reset by peer)
[14:47:00] *** Quits: slisnake (~slisnake@103.107.198.142) (Ping timeout: 240 seconds)
[14:49:22] *** Joins: slisnake (~slisnake@103.107.198.140)
[14:52:17] *** Joins: led_belly (~led_belly@37.120.197.44)
[14:55:00] *** Quits: Volgaar (~volgaar@147.94.11.43) (Ping timeout: 240 seconds)
[14:57:45] *** Quits: euphoricallysane (~quatro@user/euphoricallysane) (Quit: Leaving)
[15:14:47] *** Joins: itsalexjones (~itsalexjo@82.4.99.241)
[15:22:53] *** Joins: lavaball (felix@31.204.155.215)
[15:32:51] *** Quits: AbleBacon (~AbleBacon@user/AbleBacon) (Read error: Connection reset by peer)
[15:39:01] *** Joins: c7s (~c7s@user/c7s)
[15:58:12] *** Quits: geowiesnot (~user@5-51-190-244.abo.bbox.fr) (Ping timeout: 240 seconds)
[16:05:13] *** Joins: johnjaye (~pi@173.209.64.74)
[16:05:53] *** Joins: lbvotkin (~lbvotkin@108.red-88-3-241.dynamicip.rima-tde.net)
[16:06:49] <lbvotkin> Does anybody know what the `AV_HWDEVICE_TYPE` is that is used by the `h264_amf` encoder?
[16:08:05] <BtbN> It can take D3D11VA/DXVA frames as input, if that's what you're asking.
[16:09:20] <another|> TheDcoder: ffmpeg has no dvd parsing
[16:10:02] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[16:10:02] <lbvotkin> BtbN I think that's what I'm asking. I need the device type for creating the hardware device with `av_hwdevice_ctx_create()`
[16:10:59] <BtbN> What are you trying to do?
[16:11:12] <BtbN> Full HW transcode with d3d11 + amf on windows?
[16:11:34] <lbvotkin> yes full encode on windows
[16:11:41] <BtbN> encode?
[16:11:54] <lbvotkin> as in take raw RGB frames and convert to H264
[16:11:57] *** Quits: l4yer (~l4yer@195.181.170.210) (Ping timeout: 240 seconds)
[16:12:09] <BtbN> From d3d11? Or where do the frames come from?
[16:12:45] <lbvotkin> I'm getting a buffer of pixels from a games engine render target right now
[16:13:43] <BtbN> But on hardware already, i.e. d3d11 frames?
[16:14:41] <lbvotkin> yeah well I could get them as raw d3d11 frames but sometimes the games engine is in dx12 which makes that a bit of a pain. Easier right now just to dump the pixels
[16:15:02] <BtbN> Soo, you don't have hwframes?
[16:17:32] <lbvotkin> could be that my understanding of this is incorrect. I've been working off this example http://ffmpeg.org/doxygen/trunk/vaapi_encode_8c-example.html . My algo is:
[16:17:33] <lbvotkin> 1. Create hw device
[16:17:33] <lbvotkin> 2. Create sw frames, adding in raw pixel data
[16:17:34] <lbvotkin> 3. Create hw frames
[16:17:34] <lbvotkin> 4. send transfer to gpu `av_hwframe_transfer_data()`
[16:17:35] <lbvotkin> 5. encode (`avcodec_send_frame()`)
[16:17:35] <lbvotkin> 6. Get packets `avcodec_receive_packet()`
[16:18:19] <BtbN> You realize the amf encoders take software frames just fine?
[16:18:19] <lbvotkin> doing 1. for nvenc is easy because its well documented and the device type is `AV_HWDEVICE_TYPE_CUDA`
[16:18:26] <BtbN> As does nvenc
[16:18:35] <lbvotkin> ooh cool I did not realise that
[16:18:56] <lbvotkin> so do I still need to create the hw device?
[16:19:32] <BtbN> Only if you plan to send hardware frames from it
[16:20:57] <lbvotkin> right understood! Thanks a lot. That all makes sense
[16:26:02] *** Joins: l4yer (~l4yer@84.69.191.245)
[16:37:08] *** Joins: johnjaye (~pi@173.209.64.74)
[16:42:17] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[16:43:37] *** Quits: iconoclasthero (~quassel@pool-68-238-241-198.phlapa.fios.verizon.net) (Ping timeout: 240 seconds)
[16:45:28] *** Joins: johnjaye (~pi@173.209.64.74)
[16:51:23] *** Quits: johnjaye (~pi@173.209.64.74) (Remote host closed the connection)
[16:57:48] *** Joins: euphoricallysane (~quatro@user/euphoricallysane)
[17:09:20] *** Quits: irc_user (uid423822@id-423822.lymington.irccloud.com) (Quit: Connection closed for inactivity)
[17:24:00] *** Joins: iconoclasthero (~quassel@pool-100-14-231-162.phlapa.fios.verizon.net)
[17:54:10] *** Joins: Kacper_ (~kasper93@user/kasper93)
[17:55:26] *** Quits: kasper93 (~kasper93@user/kasper93) (Ping timeout: 272 seconds)
[18:04:03] *** Quits: lbvotkin (~lbvotkin@108.red-88-3-241.dynamicip.rima-tde.net) (Quit: Connection closed)
[18:04:47] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 256 seconds)
[18:07:07] *** Joins: johnjaye (~pi@173.209.64.74)
[18:07:19] *** Joins: Vonter (~Vonter@user/vonter)
[18:09:19] *** Quits: __Myst__ (~Myst@net-93-148-190-54.cust.vodafonedsl.it) (Ping timeout: 256 seconds)
[18:09:46] *** Joins: __Myst__ (~Myst@net-37-116-247-71.cust.vodafonedsl.it)
[18:12:26] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 256 seconds)
[18:18:58] *** Joins: johnjaye (~pi@173.209.64.74)
[18:24:06] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 245 seconds)
[18:24:43] *** Joins: luc4 (~luc4@151.82.83.53)
[18:25:22] *** Joins: johnjaye (~pi@173.209.64.74)
[18:30:46] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 245 seconds)
[18:31:38] *** Joins: johnjaye (~pi@173.209.64.74)
[18:36:37] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[18:37:08] *** Quits: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6) (Quit: Client closed)
[18:38:49] *** Joins: johnjaye (~pi@173.209.64.74)
[18:39:59] *** Joins: Volgaar (~volgaar@147.94.11.19)
[18:43:48] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[18:46:22] *** Joins: waleee (~waleee@2001:9b0:213:7200:cc36:a556:b1e8:b340)
[18:47:28] *** Joins: johnjaye (~pi@173.209.64.74)
[18:49:34] *** Quits: adanwan (~adanwan@gateway/tor-sasl/adanwan) (Remote host closed the connection)
[18:52:53] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 250 seconds)
[18:53:50] *** Joins: johnjaye (~pi@173.209.64.74)
[18:53:57] *** Joins: adanwan (~adanwan@gateway/tor-sasl/adanwan)
[18:59:00] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[18:59:43] *** Quits: luc4 (~luc4@151.82.83.53) (Quit: Connection closed)
[19:04:17] *** Joins: johnjaye (~pi@173.209.64.74)
[19:09:32] *** Joins: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6)
[19:09:58] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 260 seconds)
[19:10:43] *** Joins: johnjaye (~pi@173.209.64.74)
[19:14:02] *** Joins: crashrep (~crashrep@user/crashrep)
[19:15:48] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[19:17:08] *** Joins: johnjaye (~pi@173.209.64.74)
[19:17:49] *** Joins: minimal (~minimal@user/minimal)
[19:20:47] *** Joins: luc4 (~luc4@mi-18-20-154.service.infuturo.it)
[19:22:17] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[19:23:48] *** Joins: johnjaye (~pi@173.209.64.74)
[19:26:05] *** Quits: zumba_addict (~zumba_add@2601:240:4500:8320:224:1dff:fec8:64f6) (Quit: Client closed)
[19:29:06] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 250 seconds)
[19:29:21] *** Joins: xkuru (~xkuru@user/xkuru)
[19:30:12] *** Quits: waleee (~waleee@2001:9b0:213:7200:cc36:a556:b1e8:b340) (Ping timeout: 240 seconds)
[19:31:22] *** Joins: johnjaye (~pi@173.209.64.74)
[19:32:04] *** Joins: water_27300935_ (~water_273@182.90.129.56)
[19:34:35] *** Joins: pingufan (~rainer@goliath.hantsch.co.at)
[19:36:20] *** Quits: crashrep (~crashrep@user/crashrep) (Quit: WeeChat 3.4)
[19:36:23] <pingufan> Hello.    I have a very strange situation with video files voming from an HDMI recorder. The original reording plays fine, but I want to cut out an intro and advertisings.  Trying that the video often ends up in lost audio .
[19:37:09] *** Quits: wootehfoot (~wootehfoo@user/wootehfoot) (Ping timeout: 256 seconds)
[19:37:19] *** Quits: johnjaye (~pi@173.209.64.74) (Remote host closed the connection)
[19:37:24] <pingufan> Is there a way to force a complete re-encoding to .mkv so I have a plain h264 file I can cut afterwards with avidemux-3 ?
[19:37:44] <pingufan> Working on Linux, btw.
[19:37:50] *** Joins: johnjaye (~pi@173.209.64.74)
[19:39:00] *** Quits: Volgaar (~volgaar@147.94.11.19) (Ping timeout: 240 seconds)
[19:39:49] *** Quits: johnjaye (~pi@173.209.64.74) (Max SendQ exceeded)
[19:40:12] *** Joins: johnjaye (~pi@173.209.64.74)
[19:40:14] <pingufan> Any idea?
[19:43:28] <pingufan> The difficults seems to come from incorrect transition  in audio stream. If cutting has to be closely (but behind such point), audio information is lost and as result I have no sound.
[19:44:09] <JEEB> if you say that one system has the exact same command and files work, but another doesn't, then attempt to match up the FFmpeg version or update both to similar enough version with something like BtbN's builds
[19:44:46] <pingufan> JEEB: Talking to me?
[19:45:25] *** Quits: johnjaye (~pi@173.209.64.74) (Ping timeout: 240 seconds)
[19:46:17] <JEEB> yes
[19:46:23] <JEEB> since you said "Working on linux, btw"
[19:46:29] *** Joins: johnjaye (~pi@173.209.64.74)
[19:46:37] <JEEB> since the FFmpeg code works similarly across operating systems as far as files are concerned :P
[19:46:55] <JEEB> thus if the input file(s) and arguments are exactly hte same
[19:47:02] <JEEB> that leaves a version difference with FFmpeg :P
[19:47:44] *** Quits: johnjaye (~pi@173.209.64.74) (Max SendQ exceeded)
[19:47:45] <pingufan> I think I didn't explain good enough.    I am recording a free-tv stream. The problem occurs in transition from selecting a movie to when it starts.
[19:48:17] *** Joins: johnjaye (~pi@173.209.64.74)
[19:49:21] *** Quits: johnjaye (~pi@173.209.64.74) (Max SendQ exceeded)
[19:49:22] <pingufan> I start recording, then I select the video. So all this menu selecting is also recorded. Then I want to cut that away.
[19:49:55] *** Joins: johnjaye (~pi@173.209.64.74)
[19:50:00] <pingufan> This causes the problem because one audio is terminated and a new one starts.
[19:50:44] *** Joins: vlm (~vlm@user/vlm)
[19:50:51] *** Quits: johnjaye (~pi@173.209.64.74) (Max SendQ exceeded)
[19:51:18] <pingufan> It would be sufficient (so I think) when I could fully decode+re-encode the recording so I keep AV sync but have then a plain and correct .mkv
[19:51:25] *** Joins: johnjaye (~pi@173.209.64.74)
[19:51:46] <pingufan> JEEB:
[19:52:04] *** Joins: Volgaar (~volgaar@147.94.11.19)
[19:52:23] *** Quits: johnjaye (~pi@173.209.64.74) (Max SendQ exceeded)
[19:52:53] *** Joins: johnjaye (~pi@173.209.64.74)
[19:53:09] <pingufan> At the moment I try to use handbrake to re-code the video, but this is awfully slow. (11 fps on a stromg machine)
[19:53:27] *** Joins: geowiesnot (~user@5-51-190-244.abo.bbox.fr)
[19:54:05] <BtbN> handbrake just calls ffmpeg in the background though
[19:55:08] <BtbN> video encoding is rather slow, but unless that is 4K content or something, 11 fps seems rather low
[19:55:58] *** Quits: arinov_ (~arinov@213.194.126.155) (Ping timeout: 250 seconds)
[19:57:35] *** Quits: ketas (~ketas@0011-0000-0000-0000-d7dc-830e-07d0-2001.dyn.estpak.ee) ()
[19:59:09] <water_27300935_> I want to convert H.264 to H.265, using "ffmpeg -i input_file.mp4 -c:v libx265 -vtag hvc1 -c:a copy output_file.mp4"
[19:59:15] <water_27300935_> Is it correct?
[19:59:21] <pingufan> BtbN: It is 1080p video.       Can I see the commandline  handbrake uses for ffmpeg?    Then I can find a good setting with handbrake and use that settings on commandline
[19:59:37] <BtbN> It doesn't use a commandline.
[20:00:06] <water_27300935_> Why appear "Unknown encoder 'libx265'"
[20:00:19] <pingufan> BtbN: So I cannot see how handbrake invokes ffmpeg?
[20:00:29] <BtbN> It doesn't invoke it. It uses the API.
[20:00:44] <BtbN> water_27300935_, it'll give you a video with HEVC, but no idea what the quality defaults are.
[20:00:53] <BtbN> If it says it doesn't know libx265, your build is lacking support for it.
[20:01:04] <galad> well handbrake uses part of libavformat and libavcodec, if you encode to x265 it uses only libavformat to demux and mux and libavcodec to decode the video and audio
[20:01:28] <BtbN> Be aware that every re-encode, even to a "better" codec will only ever reduce the quality, never make it better.
[20:01:31] <pingufan> Can you show me a bullet-proof set of options for fully re-encoding a video?
[20:02:13] <BtbN> define "fully re-encoding"
[20:02:39] <BtbN> Normally you want to avoid re-encoding at all costs, since it hurts the quality.
[20:03:24] <pingufan> I want to create h.264 with aac 2-channel and "-cbr 21"   (this gives usually a reasonable quality.  Keyframes  every 5-10 seconds I also use.
[20:04:36] <pingufan> fulla re-encoding I understand in this manner:     "play the video internally" and create a brand new viseo from that (v+a)
[20:04:43] <BtbN> You mean cfr?
[20:05:10] <BtbN> *crf ...
[20:05:35] <pingufan> I show you my current commandline - perhaps something I did wrong....
[20:05:45] <BtbN> Re-Encoding will fully decode the video, and then encode it again. And in the process reduce the quality, if you don't do a lossless encode.
[20:06:08] <BtbN> So if your input is not in something ultra horrible or itself lossless, it's rarely ever a good idea
[20:06:13] <water_27300935_> BtbN: I just use "./configure, make, make install" to build, how to configure supported H.265?
[20:06:54] <BtbN> You need libx265 and its development files somewhere configure can find it
[20:09:18] <pingufan> BtbN: Here is the pastebin:   https://pastebin.com/q1Xn39d0
[20:10:15] <pingufan> This script searches all input files and shall convert (= re-encode) then into a destination dir.
[20:12:11] <BtbN> Use -g instead of x264 opts. -vcodec and -acodec are long deprecated, use -c:v/:a
[20:12:33] <BtbN> And not sure if you really want mp3, specially specified like this. Not sure if -q:a even works. AAC is just all around better.
[20:13:11] <BtbN> A keyframe every 5 frames is also of questionable value, and will severely handicap the encoder
[20:14:26] <pingufan> No.    This is one of my tries.   I used first aac with two channels. Then I thought it would help to use mp3, it didn't
[20:15:14] <pingufan> I could also leave keyframes away at all (for this intermediate file (before cutting), if this helps.
[20:15:57] <BtbN> If you want to cut it, use an intermediate Intra-Only codec
[20:16:00] <pingufan> The problem is cutting. avidemux preferes cutting on keyframes.
[20:16:08] <BtbN> well, you can _only_ cut on keyframes
[20:16:33] <pingufan> That's the reason for such dense keyframes
[20:17:21] <pingufan> Can you suggest me a ffmpeg command line based on what I use now?
[20:17:34] <BtbN> it will heavily gimp the quality and performance. Use a proper intermediate codec. UTVideo and the like
[20:18:11] <pingufan> Never heard of.
[20:18:12] <BtbN> for audio you can just use raw PCM. AAC and mp3 you also can only cut on frame boundaries
[20:19:19] <pingufan> So U use this intermediate format for cutting, then I save as final .mkv?
[20:19:43] <BtbN> or cut and transcode the original file at the same time. If you insist on transcoding.
[20:19:56] <BtbN> Ideally you don't transcode at all, and only cut the untouched original, on whatever keyframes it has.
[20:20:15] <BtbN> If you're transcoding at the same time, you're not bound to any keyframes
[20:20:40] <pingufan> What software shall I use for cutting?
[20:21:07] <BtbN> whatever you like really. ffmpeg can do it just fine
[20:21:19] <pingufan> The recorder records to mp4 format but makes a sequence of files, each 2GB at most.
[20:22:00] <pingufan> So I use ffmpeg now to combine the chunks to one big video.
[20:22:04] <BtbN> Can you tell it to just dump the raw mpeg transport stream that goes over the air?
[20:23:02] <pingufan> No, I can not change anything. It records whatever comes in on its input as .mp4
[20:23:27] <pingufan> All I can do is press a button for start/stop recording.    But this works really great.
[20:23:45] <BtbN> You can try using the concat demuxer on the files, and hope it produces something you can still concat.
[20:23:59] <pingufan> So I start recording, then I start the playback from the internet.
[20:24:02] <BtbN> https://trac.ffmpeg.org/wiki/Concatenate
[20:24:35] <BtbN> Make sure not to re-encode while concatenating.
[20:25:33] <pingufan> This is exactly what I use.  But I also re-encode to h.264 + aac  in to a .mkv hereby
[20:26:21] <pingufan> Should I output to another .mp4 instead?  (source files are .mp4)
[20:26:46] <BtbN> The container doesn't matter.
[20:26:58] <BtbN> Don't re-encode.
[20:27:17] <pingufan> So only use copy for video and audio filter?
[20:27:32] <BtbN> filter? You want to use -c copy, yes. So it doesn't transcode.
[20:27:46] <pingufan> This I meant.
[20:27:57] <water_27300935_> BtbN: I have NVIDIA card and installed driver correctly, when I convert video, is it use NVIDIA GPU to accelerate by default?
[20:27:58] <BtbN> Re-Encoding for that is 100% pointless and only trashes the quality and takes forever
[20:28:19] <BtbN> water_27300935_, no. You need to explicitly use nvenc.
[20:28:32] <BtbN> Or setup hardware decoding explicitly, if you mean that.
[20:28:43] <pingufan> So ffmpeg actually plays all files listed and concatenates the output. This is what happens then?
[20:29:00] <BtbN> It doesn't play them at all, no.
[20:29:11] <BtbN> If you want to look at them, you can use ffplay, or any player of your choice
[20:29:39] <pingufan> (I mean from principle.   That nothing is actually played, I know.
[20:29:56] <BtbN> Not sure I follow what you mean.
[20:30:19] <BtbN> The concat demuxer concatenates all files in its input list.
[20:31:49] <pingufan> Only from point of understanding:  I create a job file (as I currently do)  containing all files in right order.   Then I hand over this file in the way of  "ffmpeg -f concat -safe 0 -i mylist.txt -c copy output.wav", but in my case all files are .mp4.     Correct?
[20:31:53] <BtbN> All that matters for you is that to make precise cuts, you need to re-encode. Otherwise you are bound to keyframe boundaries.
[20:32:05] <BtbN> In all other scenarious, reencoding is pointless quality and time loss.
[20:32:33] <BtbN> command looks fine, except probably not wav as output
[20:32:38] *** Joins: ketas (~ketas@0011-0000-0000-0000-d7dc-830e-07d0-2001.dyn.estpak.ee)
[20:32:45] <pingufan> Can avidemux3 work with .mp4 files?
[20:33:29] <BtbN> no idea. Would be surprised if not.
[20:34:37] *** Joins: lbvotkin (~lbvotkin@108.red-88-3-241.dynamicip.rima-tde.net)
[20:34:48] <pingufan> I will try tomorrow. Run a modofied bash script, creating .mp4 files from series of chunks.
[20:35:01] <pingufan> Thaks for your kindly help.
[20:37:32] *** Quits: luc4 (~luc4@mi-18-20-154.service.infuturo.it) (Quit: Connection closed)
[20:41:27] *** Joins: CATS (~apic@brezn2.muc.ccc.de)
[20:41:46] <water_27300935_> BtbN: I need to setup with this: "https://docs.nvidia.com/video-technologies/video-codec-sdk/ffmpeg-with-nvidia-gpu/"?
[20:43:58] *** Joins: MrZeus_ (~MrZeus@185.195.232.164)
[20:45:28] *** Joins: beaver (~beaver@user/pong)
[20:50:01] *** Joins: System_Error (~SystemErr@user/systemerror)
[20:50:10] *** Quits: malloy (~jimery@116.30.220.175) (Ping timeout: 250 seconds)
[20:50:43] <BtbN> ffmpeg has its own version of the nvidia headers, ffnvcodec
[20:52:04] *** Joins: malloy (~jimery@116.30.220.175)
[20:54:50] <pingufan> BtbN: Jut a question:  I concatenated now the .mp4 chunks.    avidemux seems to undersand it.  But keyfreames are a little bit wide (but I can live with that).   Can I still use "copy" to create a cut version of .mp4  and recode then (afterwards) in a batch run?
[20:55:34] <pingufan> Reason.    avidemus is needing more than 1 hour to recode into a more compact format.
[20:55:35] <BtbN> If you really insist on re-encoding, do the cutting while re-encoding.
[20:55:56] <BtbN> Keyframes don't matter then
[20:56:27] <pingufan> But this locks avidemux now for 1 hour
[20:56:48] <BtbN> No idea about avidemux, never used it
[20:56:53] <lbvotkin> I'm now exploring sending dx11 textures into a hardware encoder (thanks for your help BtbN earlier!!) In the docs I haven't found out where the `ID3D11Texture2D ` are stored on a hardware frame. Closest thing I've found is https://ffmpeg.org/doxygen/trunk/hwcontext__d3d11va_8c_source.html#l00158 but i'm a bit concerned it's not really meant to be
[20:56:54] <lbvotkin> part of the public api. What's the best way to set a dx11 texture on a hardware frame?
[20:56:56] <pingufan> If I could quickly cut and then re-code in a batch (in background) ...
[20:57:23] <BtbN> Why do you want to reencode so badly? What format is it in?
[20:58:06] <BtbN> lbvotkin, I never used that, so not much of an idea. I think it sits in the data buffers, but you best look at the hwframe code in avutil for specifics
[20:58:14] <water_27300935_> BtbN: How to setup that (ffnvcodec)? I can't find similar packages, I use Fedora dnf to search.
[20:58:31] <BtbN> https://git.videolan.org/?p=ffmpeg/nv-codec-headers.git;a=summary
[20:58:47] <pingufan> The concatenated video is 4.6 GB for 39 minutes!     I get that down to a little more than 1GB without visible quality loss.
[20:58:52] <pingufan> This is the reason.
[20:59:10] <lbvotkin> BtbN thanks again! Looks like you're fielding everybody's questions today. Really appreciate the guidance :)
[21:00:00] <BtbN> lbvotkin, you will also need to construct a valid HWDeviceContext and HWFrameContext that's derived from your pre-existing one. It's very much not straight forward.
[21:00:42] <lbvotkin> yes doesn't look like it at all :(
[21:01:28] <pingufan> BtbN: This is simply saving lots of drive space.
[21:02:18] <BtbN> pingufan, fair enough. Just cut in one go with the transcode then. You can cut arbitrarily precise if you do it in one step.
[21:02:36] <BtbN> Just make sure you specify -ss/-t/-to after -i, so it actually does it precisely
[21:04:46] <pingufan> I'd like to cut in GUI (using avidemux, if possible), but in a fast way. (i.e. creating a "cut + copy" .mp4 hereby. This should be fast (because no transcoding.   Then I run a batch over night, transcoding all produced cut files to .mkv
[21:04:51] <pingufan> This is my plan.
[21:05:08] <BtbN> Can use avidemux to find the timestamps
[21:08:28] <AMM> You can use whatever player to get timestamps, then jot them down in a text file and write a simple script that uses the ranges to cut out clips, then concatenate and encode them
[21:08:51] <AMM> or just using the concat demuxer directly, since it supports seeking (to an extent, breakage possible)
[21:09:22] <AMM> If you need to make a lot of cuts, mpv is a good choice, since you can write a script and add a keybind to write some text to a file
[21:09:43] <AMM> say, https://gist.github.com/TheAMM/712bbed3c7b5f00ff961714378ffaaa6
[21:12:34] <pingufan> I think I found a way.   AVIDEMUX, running in "copy" works really fast and makes me a new .mp4 file.   Then I run a batch, transcoding all this cuted .mp4 files into .mkv and hereby setting my final encoding(s).
[21:12:54] <pingufan> Thanky so much to all of you. This works really excellent nor.
[21:13:12] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Ping timeout: 256 seconds)
[21:13:25] *** Quits: pingufan (~rainer@goliath.hantsch.co.at) (Quit: Konversation terminated!)
[21:13:46] *** Quits: rsx (~dummy@ppp-188-174-148-71.dynamic.mnet-online.de) (Quit: rsx)
[21:16:10] *** Joins: blaze1 (~blaze@user/blaze)
[21:16:36] *** Quits: blaze (~blaze@user/blaze) (Ping timeout: 256 seconds)
[21:16:59] <aphysically> huh I didn't even realize web browsers would play surround sound audio
[21:17:15] <aphysically> I just discovered this due to a bug where I didn't downmix to stereo by accident
[21:17:41] <JEEB> yes, at least chromium does downmix. probably firefox as well
[21:17:49] <JEEB> it depends on the exact decoder utilized I guess too
[21:17:53] <JEEB> chromium includes FFmpeg's
[21:18:15] <JEEB> firefox utilizes FFmpeg on linux, media foundation on windows and the mac thing on macOS
[21:18:51] <aphysically> I had a bug where I wouldn't trigger the stereo conversion for compatibility if the ingest stream happened to be both aac and below 320 kbps
[21:19:06] <aphysically> and my friend just happened to have a surround sound aac at 224
[21:20:05] <aphysically> hmmm, if it works everywhere I guess I can avoid downmix in this case but I'll never be able to test all the phones and macs and stuff so it's probably best to just make a stereo stream for compatibility
[21:20:42] <aphysically> it turned out yesterday when I thought i was getting my output encoding streams mixed up I wasn't, and it's something else
[21:20:57] *** Quits: MajorBiscuit (~MajorBisc@c-001-029-040.client.tudelft.eduvpn.nl) (Ping timeout: 240 seconds)
[21:21:28] <aphysically> if I make an adaptation set that contained both aac and opus then chrome would get really upset but firefox doesn't care
[21:21:43] *** Joins: dreamon (~dreamon@pd95035d1.dip0.t-ipconnect.de)
[21:22:24] <aphysically> I'm not sure if this is 1) user error (can't mix dash adaptation set codec object types), 2) a chromium bug, 3) an ffmpeg bug somewhere
[21:22:35] <aphysically> it worked fine in Firefox >:l
[21:23:26] <Manouchehri> aphysically: what's the issue if you use surround sound audio?
[21:24:11] <aphysically> I don't have a vendetta against surround sound audio, I just 1) assumed it wouldn't work 2) was targeting web browsers primarily anyway
[21:24:19] <aphysically> (where I assumed it wouldn't work)
[21:24:38] <aphysically> and if they universally downmix anyway, it's wasted bitrate!
[21:26:03] *** Parts: water_27300935_ (~water_273@182.90.129.56) (WeeChat 3.4)
[21:29:04] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[21:29:09] <aphysically> i guess I should try downloading the stream to be 300% sure I didn't mix up my tagging, but I really doubt it since I'm doing like -tag:a:1 -c:a:1 blah etc and -c:v:1 -c:v:2 for those
[21:29:54] <aphysically> chromium gives an error that the content of the stream it tried to load didn't match object type 40 (which is aac)
[21:30:50] <aphysically> MEDIA_ERR_SRC_NOT_SUPPORTED (CHUNK_DEMUXER_ERROR_APPEND_FAILED: audio object type 0x40 does not match what is specified in the mimetype.)
[21:31:28] *** Joins: B4re (~l4yer@84.69.191.245)
[21:31:37] *** Quits: l4yer (~l4yer@84.69.191.245) (Ping timeout: 240 seconds)
[21:35:38] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Ping timeout: 250 seconds)
[21:48:12] *** Quits: Volgaar (~volgaar@147.94.11.19) (Ping timeout: 240 seconds)
[21:48:14] <aphysically> hmmmmm
[22:00:12] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[22:00:32] *** Quits: geowiesnot (~user@5-51-190-244.abo.bbox.fr) (Ping timeout: 272 seconds)
[22:01:27] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Read error: Connection reset by peer)
[22:03:23] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[22:05:05] *** Quits: Vonter (~Vonter@user/vonter) (Read error: Connection reset by peer)
[22:05:47] <aphysically> "r_frame_rate=27884/1163"
[22:05:53] <aphysically> what on earth
[22:07:11] <aphysically> how ????
[22:07:21] *** Joins: Vonter (~Vonter@user/vonter)
[22:07:53] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Ping timeout: 256 seconds)
[22:09:10] <lbvotkin> aphysically ffmpeg internally stores frame rates as fractions (AVRational)
[22:09:17] <lbvotkin> so that it doesn't have to deal with floating points
[22:09:21] <lbvotkin> that frame rate is 23.975 fps
[22:10:01] <JEEB> he's probably expecting 24000/1001
[22:10:18] <JEEB> probably something relating to non-exact timestamps somewhere along the line :P
[22:11:44] *** Joins: crashrep (~crashrep@user/crashrep)
[22:17:13] <aphysically> JEEB: I think what happened is the source file is 2997/125 which is being sent over mpegts, but for some reason the ffmpeg ingesting the srt stream on the other side things it's 24000/1001
[22:17:14] *** Quits: B4re (~l4yer@84.69.191.245) (Ping timeout: 250 seconds)
[22:17:33] *** Joins: wootehfoot (~wootehfoo@user/wootehfoot)
[22:17:39] <aphysically> I'm not the one with the source file unfortunately, but I should be able to make a 2997/125 (=23.976 exact) to test
[22:19:01] <aphysically> but even so I'm not sure how I would fix this
[22:19:08] <aphysically> does mpegts count as a "raw" format where I can force the input framerate?
[22:19:27] <JEEB> it has timestamps
[22:19:49] <JEEB> the stream time base is 1:90000 and you have proper PTS/DTS :P
[22:20:16] <JEEB> if you want to visualize the timestamps from it, DVB Inspector is great for it
[22:20:23] <JEEB> as much as I dislike java, it's a great tool
[22:20:24] <aphysically> DASH is writing the framerate as 240000/1001 so I'm quite sure there's a muckup somewhere
[22:21:01] <JEEB> or just print out the pts/dts values as received by libavformat :P
[22:21:06] <JEEB> from various points of your chain
[22:21:22] <JEEB> since you're doing such multi-step processing
[22:24:33] *** Joins: fkaa (~fkaa@user/fkaa)
[22:31:37] <aphysically> ya hmmhmmhmm
[22:32:58] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[22:33:15] *** Quits: System_Error (~SystemErr@user/systemerror) (Ping timeout: 240 seconds)
[22:34:39] *** Quits: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr) (Client Quit)
[22:35:06] *** Joins: taupiqueur (~taupiqueu@lmontsouris-659-1-2-186.w193-248.abo.wanadoo.fr)
[22:35:10] *** Joins: bitblit (~bitblit@gateway/tor-sasl/bitblit)
[22:35:55] *** Joins: iive (~iive@87.119.101.204.client.entry.bg)
[22:41:12] *** Joins: Seirdy (~Seirdy@sourcehut/user/seirdy)
[22:42:34] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[22:45:37] *** Joins: l4yer (~l4yer@84.69.191.245)
[22:46:45] *** Quits: dingdreher (~dingdrehe@2a02:aa08:401e:fff2:4939:5e11:de52:5ed3) (Quit: dingdreher)
[22:49:18] *** Quits: blaze1 (~blaze@user/blaze) (Quit: WeeChat 3.3)
[22:49:35] *** Joins: dvanloon (~dvanloon@user/dvanloon)
[22:52:19] <aphysically> as a first step, forcing the input read framerate to be what was read from the user's video fixes the timing and what was written in the dash. and inspecting the video itself shows it indeed was 2997/125
[22:53:36] <aphysically> interestingly it wrote the copied stream as having a maxframerate of 24000/1001 (as opposed to framerate), and then it writes all the transcoded streams with the expected 2997/125. But it works. Maybe I can force the correct framerate on the copied one with like an -r:v:0 (is that a thing?), that's how I force the dash playlist to write the correct bitrate for copied streams
[22:57:43] *** Joins: geowiesnot (~user@5-51-190-244.abo.bbox.fr)
[22:58:12] *** Joins: cheetahw26 (~cheetahw2@14.150-pool-xdsl-mi.sccoast.net)
[23:01:55] *** Quits: crashrep (~crashrep@user/crashrep) (Ping timeout: 240 seconds)
[23:04:52] *** Joins: crashrep (~crashrep@user/crashrep)
[23:05:47] <aphysically> JEEB: nonstandard framerates are a mess :D
[23:09:30] *** Quits: kurosu (uid342582@id-342582.hampstead.irccloud.com) (Quit: Connection closed for inactivity)
[23:10:55] *** Quits: crashrep (~crashrep@user/crashrep) (Ping timeout: 240 seconds)
[23:14:12] *** Joins: jarthur (~jarthur@2603-8080-1540-002d-6d72-f335-2f9d-689a.res6.spectrum.com)
[23:26:18] *** Joins: crashrep (~crashrep@user/crashrep)
[23:28:41] <aphysically> yeah it looks like if I encode to an mpegts file the framerate gets converted from 2997/125 to 24000/1001 at least by what ffmpeg gets via ffprobe and r_frame_rate
[23:28:54] <aphysically> but not in actuality it seems
[23:28:59] *** Joins: System_Error (~SystemErr@user/systemerror)
[23:33:58] *** Joins: blaze (~blaze@user/blaze)
[23:36:01] <aphysically> ah I see, forcing the -r on the input fixes the framerate for the reenencoded streams but not the copied one
[23:38:28] <aphysically> hmmmm, looks like I can't fix this by any kind of forcing shenanigans on the receiving side
[23:39:02] <aphysically> so I'll need to fix how ffmpeg interprets the mpegts by changing how it's written, if it's possible (to get any framerate/enough framerate data into it, so that ffmpeg can read it)
[23:43:46] *** Joins: shibboleth (~shibbolet@user/shibboleth)
[23:49:04] <aphysically> okay so ffmpeg -i badfps.mp4 -t 20 -c:v copy -map 0:v out.ts
[23:49:21] <aphysically> if badfps.mp4 has 2997/125 framerate, this is enough to make an mpegts file that ffmpeg thinks has 24000/1001 framerate
[23:51:07] <aphysically> is there some kind of extradata I can write or something? :(
