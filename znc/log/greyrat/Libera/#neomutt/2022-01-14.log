[00:22:02] *** Quits: strajder (~strajder@user/strajder) (Quit: leaving)
[00:26:17] *** Joins: strajder (~strajder@user/strajder)
[00:32:05] *** Quits: blaub (~blaub@194-208-201-025.tele.net) (Quit: WeeChat 3.4)
[00:53:48] *** Quits: Seirdy (~Seirdy@sourcehut/user/seirdy) (Quit: exiting 3.3)
[01:32:33] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[01:33:57] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Remote host closed the connection)
[01:35:22] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[02:35:04] *** Quits: strajder (~strajder@user/strajder) (Quit: leaving)
[02:37:07] *** Joins: dcpurton (~dcpurton@2001:44b8:217:9e00:ed15:6980:ea65:a797)
[03:01:58] *** Quits: bsd4me (~IceChat95@user/bsd4me) (Ping timeout: 250 seconds)
[03:02:30] *** Quits: plastico (~plastico@neomutt/plastico) (Quit: WeeChat 3.4)
[03:03:10] *** Quits: dcpurton (~dcpurton@2001:44b8:217:9e00:ed15:6980:ea65:a797) (Quit: dcpurton)
[03:43:39] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:44:30] *** Joins: dcpurton (~dcpurton@1.124.107.169)
[03:45:55] *** Joins: bsd4me (~IceChat95@user/bsd4me)
[04:17:27] *** Quits: rittchen (~rittchen@gateway/tor-sasl/rittchen) (Ping timeout: 276 seconds)
[04:19:07] *** Joins: rittchen (~rittchen@gateway/tor-sasl/rittchen)
[04:21:10] *** Quits: dcpurton (~dcpurton@1.124.107.169) (Quit: dcpurton)
[04:52:37] *** Quits: nyah (~nyah@94.6.71.219) (Ping timeout: 240 seconds)
[05:08:56] *** Quits: Pali (~pali@user/pali) (Ping timeout: 250 seconds)
[05:18:50] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[05:32:16] *** Quits: maetthew (~maetthew@user/maetthew) (Quit: ZNC 1.8.2 - https://znc.in)
[05:34:52] *** Joins: maetthew (~maetthew@c188-150-159-232.bredband.tele2.se)
[05:34:52] *** Quits: maetthew (~maetthew@c188-150-159-232.bredband.tele2.se) (Changing host)
[05:34:52] *** Joins: maetthew (~maetthew@user/maetthew)
[05:36:24] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Remote host closed the connection)
[05:37:03] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[05:42:20] *** Joins: dcpurton (~dcpurton@1.124.107.169)
[06:06:24] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:08:05] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[06:10:33] *** Quits: dcpurton (~dcpurton@1.124.107.169) (Quit: dcpurton)
[06:41:34] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[07:23:55] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Quit: dcpurton)
[07:25:41] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[07:25:49] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Client Quit)
[08:12:38] *** Quits: just1602 (~just1602@199.58.80.143) (Ping timeout: 252 seconds)
[08:12:54] *** Joins: just1602 (~just1602@199.58.80.143)
[08:15:07] *** Joins: vysn (~vysn@user/vysn)
[08:19:57] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Read error: Connection reset by peer)
[08:21:32] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[09:38:17] *** Quits: noex (~null@user/noex) (Ping timeout: 240 seconds)
[09:39:07] *** Quits: sbach (~sbach@user/sbach) (Read error: Connection reset by peer)
[09:41:35] *** Joins: sbach (~sbach@user/sbach)
[10:00:35] *** Joins: kzak (~kzak@nat-37.starnet.cz)
[10:01:26] *** Quits: keypusher (keypusher@user/keypusher) (Ping timeout: 250 seconds)
[10:10:44] *** Quits: bsd4me (~IceChat95@user/bsd4me) (Quit: Say What?)
[11:09:10] *** marlun1 is now known as marlun
[11:17:49] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[11:21:02] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Client Quit)
[11:36:17] *** Quits: weirdsmiley (~weirdsmil@203.122.10.222) (Remote host closed the connection)
[11:54:47] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[12:30:52] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[12:46:47] *** Joins: weirdsmiley (~weirdsmil@203.122.10.222)
[13:15:05] *** Joins: plastico (~plastico@neomutt/plastico)
[13:18:07] *** Joins: Pali (~pali@user/pali)
[13:36:10] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Quit: dcpurton)
[13:43:09] *** Joins: strajder (~strajder@user/strajder)
[14:19:58] <flatcap> morning all
[14:22:30] *** Joins: noex (~null@user/noex)
[14:28:09] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[14:36:10] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[14:41:56] *** Joins: gabriel1_ (~gabriel1@37.172.216.116)
[14:42:25] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Ping timeout: 256 seconds)
[14:45:49] *** Quits: gabriel1_ (~gabriel1@37.172.216.116) (Remote host closed the connection)
[15:07:54] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[15:14:34] *** Joins: nyah (~nyah@94.6.71.219)
[15:26:50] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Remote host closed the connection)
[15:28:22] <flatcap> dcpurton: it's all looking good!
[15:28:30] <dcpurton> ook!
[15:28:39] <dcpurton> good to hear
[15:29:14] <flatcap> I'm just want to commit a few bits of project housekeeping first, then I'll be happy to approve and merge
[15:29:30] <flatcap> fantastic work!  thanks!
[15:29:45] <dcpurton> No worries. Fix as needed.
[15:29:48] <flatcap> your refactored branch was much easier to follow and review
[15:30:27] <dcpurton> yes…
[15:30:57] <dcpurton> I admit I'm satisfied with the result. It's the most C code I've ever written.
[15:31:08] <dcpurton> for a long time at least
[15:31:26] <flatcap> :-)
[15:32:32] <flatcap> if you're interested in continuing your work (no pressure)...
[15:32:50] <flatcap> could you create a list of everything you can think of that...
[15:33:26] <flatcap> needs improving, or new features, refactoring...
[15:33:35] <flatcap> anything and everything
[15:34:08] <flatcap> I'll probably poll the users' ml for ideas too
[15:34:33] <flatcap> just so I have an idea of what might be needed/wanted
[15:35:19] <dcpurton> just in general in Neomutt you mean?
[15:35:37] <dcpurton> or related to this feature?
[15:36:00] <flatcap> I was thinking just around the body/attachments (as you've got intimate knowledge of it now :-)
[15:36:11] <flatcap> but any other ideas are welcome too
[15:36:44] <flatcap> ages back, there was a bunch of users trying to create multipart emails...
[15:37:06] <flatcap> they wanted to compose in markdown and create an html part
[15:37:24] <dcpurton> This is basically what I am doing now and it works super well
[15:37:41] <flatcap> great
[15:38:08] <dcpurton> hang on…
[15:38:10] <dcpurton> this is my script
[15:38:16] <flatcap> I'd like to find out what else might be useful to add
[15:38:55] <dcpurton> https://paste.gnome.org/pz0wivvyo
[15:39:01] * flatcap looks ...
[15:39:18] <flatcap> eek!
[15:39:28] * flatcap likes sed, but wow!
[15:39:51] <dcpurton> I should probably write it in python
[15:39:51] <flatcap> the other end of the attachment is the receiving...
[15:40:09] <dcpurton> The difficulty is with line breaks
[15:40:18] <dcpurton> when you reply to other messages
[15:40:28] <flatcap> there's an current issue about being able to view html emails which contain embedded images
[15:40:36] <dcpurton> Yes, I saw that
[15:40:43] <dcpurton> I'm a bit interested in this feature too
[15:41:40] <flatcap> so if you have any time, scribble down any ideas.  thanks
[15:42:17] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[15:43:07] <dcpurton> OK
[15:45:25] <flatcap> one think I'd like to fix, is the naming...
[15:45:36] <dcpurton> naming?
[15:45:53] <flatcap> "Body" and "Attachment" are used interchangably...
[15:46:17] <flatcap> and the variable names are often "Body *a" or "Attachment *b"
[15:46:50] <flatcap> I think a new name might be helpful
[15:53:36] *** Joins: keypusher (~keypusher@user/keypusher)
[15:53:51] <dcpurton> haha. Yes.
[15:54:21] <dcpurton> There's also the difference between the Body structure and the AttachPtr structure
[15:55:41] <flatcap> yeah
[15:56:57] *** Joins: keypushe- (keypusher@user/keypusher)
[15:57:57] *** Quits: keypusher (~keypusher@user/keypusher) (Ping timeout: 256 seconds)
[15:59:15] <dcpurton> And you're forever reordering Bodies and the the AttachPtrs in the AttachCtx. It's all very confusing. And there's no useful API like there should be.
[15:59:55] <dcpurton> Without your graphviz and body dumping code it would have very difficult to get right
[16:00:11] *** keypushe- is now known as keypusher
[16:00:44] <flatcap> indeed
[16:01:52] <flatcap> your refactoring has made a good step towards an API
[16:03:26] <flatcap> I created libattach so that I could break up recvattach
[16:04:05] <flatcap> but we can relegate that code, if we come up with and attach API
[16:05:20] <dcpurton> You know how I said I was (foolishly) trying to fix the memory leaks in the original code along the way with the commits…
[16:05:57] <dcpurton> The problem was that when it created a group, the AttachPtr objects were hidden, but still present.
[16:06:17] <dcpurton> mutt_body_destroy doesn't free these, instead they are freed independently
[16:06:43] <flatcap> ah
[16:06:50] <dcpurton> so they were just left lying around and never destroyed
[16:07:20] <dcpurton> Some you could predict, like when you deleted a group or canceled the send, or even postponed
[16:07:56] <dcpurton> But then there was some weirdness when a crypt function failed
[16:08:00] <dcpurton> I gave up
[16:08:23] <dcpurton> This isn't a problem with the new code because you can always see all the attachments in the group
[16:08:28] <dcpurton> so they can all be destroyed
[16:08:50] <flatcap> good :-)
[16:09:57] <flatcap> so we want to abstract it more: the attachments are read-only to everyone but libattach
[16:10:26] <flatcap> what are all the actions that the code might want to perform on a set of attachments
[16:13:01] <dcpurton> add, remove, insert, move-up, move-down
[16:13:07] <dcpurton> expand, collapse
[16:13:20] <dcpurton> group, ungroup
[16:13:29] <dcpurton> edit, view, print
[16:14:01] <flatcap> yes, no, yes, don't know (respectively)
[16:14:30] <flatcap> expand and collapse are interesting
[16:14:44] <flatcap> they're not properties of the Attachment itself, they're someone's View of the attachment
[16:14:50] <dcpurton> correct
[16:15:01] <dcpurton> but if you made an API, it should be same for reading and composing
[16:15:15] <flatcap> so the GUI might have an AttachmentView object that wraps a real Attachment
[16:15:43] <flatcap> AV would have index number, tree characters, is_collapsed, etc
[16:16:38] <flatcap> we'd pass a plain Attachment to the API when we performed actions
[16:16:55] <flatcap> and we could strip the GUI **** out of the plain Attachment
[16:17:46] <dcpurton> Yes. You could use the TAILQ thing that you mocked up for the whole lot.
[16:18:01] <flatcap> :-)
[16:18:24] <dcpurton> The problem is that Body is used *everywhere*
[16:18:34] <flatcap> yes.  that is a problem
[16:18:50] <flatcap> I counted ~250 uses of struct Body (before your changes)
[16:19:11] <flatcap> it's a big job that can't be done piecemeal
[16:19:41] <flatcap> but it would simplify SO MUCH code
[16:19:46] <dcpurton> yes
[16:20:21] <dcpurton> You could also use an API for setting MIME properties
[16:20:38] <flatcap> yep.  APIs for everything!
[16:20:57] <flatcap> https://neomutt.org/code/modules.html
[16:20:58] <dcpurton> e.g. set_mime_property(CONTENT-ID, "neomutt.png")
[16:21:07] <flatcap> nice
[16:21:35] <flatcap> of course this isn't rocket science. this is how it should have been written originally :-)
[16:22:24] <flatcap> mutt's old, but computer science figured out these problems long before
[16:24:48] <flatcap> As for the Body -> TAILQ: I need some time to analyse and think before we can tackle that
[16:24:52] <flatcap> suggestions welcome
[16:31:47] <flatcap> I've shuffled your branches:
[16:32:00] <flatcap> [devel/compose-multipart-old] original commits
[16:32:39] <flatcap> [devel/compose-multipart-final] new commits plus debugging
[16:32:48] <flatcap> [devel/compose-multipart] new commits 
[16:36:15] <dcpurton> 👍️
[16:44:45] <flatcap> merged :-)
[16:46:15] <dcpurton> wooo
[16:46:52] <dcpurton> Thanks for all your help! And I look forward to seeing it appear in the next release
[16:47:41] <dcpurton> Now you get to find all the unforseen things people were doing with grouping…
[16:50:24] <flatcap> you're welcome
[16:50:26] <flatcap> hehe
[17:00:04] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Remote host closed the connection)
[17:00:16] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Quit: dcpurton)
[17:00:33] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[17:00:48] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Remote host closed the connection)
[17:03:33] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[17:05:59] *** Joins: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au)
[17:08:18] *** Quits: strajder (~strajder@user/strajder) (Quit: leaving)
[17:10:33] *** Joins: strajder (~strajder@user/strajder)
[17:13:48] *** Quits: strajder (~strajder@user/strajder) (Client Quit)
[17:28:03] *** Quits: weirdsmiley (~weirdsmil@203.122.10.222) (Ping timeout: 256 seconds)
[18:11:53] *** Quits: gahr (~gahr@user/gahr) (Quit: leaving)
[18:32:28] *** Joins: gahr (~gahr@user/gahr)
[18:42:25] *** Joins: blaub (~blaub@194-208-201-025.tele.net)
[18:48:57] *** Joins: Vonter (~Vonter@user/vonter)
[18:55:01] *** Quits: blaub (~blaub@194-208-201-025.tele.net) (Quit: WeeChat 3.4)
[18:59:09] *** Joins: bsd4me (~IceChat95@user/bsd4me)
[18:59:33] *** crater2170 is now known as crater2150
[18:59:52] *** Quits: dcpurton (~dcpurton@193-115-93-249.tpgi.com.au) (Quit: dcpurton)
[19:01:29] *** Joins: blaub (~blaub@194-208-201-025.tele.net)
[19:42:58] *** Quits: bsd4me (~IceChat95@user/bsd4me) (Ping timeout: 250 seconds)
[19:59:21] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 256 seconds)
[20:05:13] *** Joins: Vonter (~Vonter@user/vonter)
[20:08:04] *** Joins: sudoforge (~sudoforge@wireguard/tunneler/sudoforge)
[20:22:05] *** Joins: strajder (~strajder@user/strajder)
[20:38:37] *** Quits: strajder (~strajder@user/strajder) (Quit: leaving)
[20:48:23] *** Quits: amigan (dramoray@dtvax.dynatron.me) (Quit: WeeChat 3.4)
[20:48:42] *** Joins: strajder (~strajder@user/strajder)
[20:49:34] *** Joins: bsd4me (~IceChat95@user/bsd4me)
[20:52:03] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Ping timeout: 256 seconds)
[20:57:52] *** Joins: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be)
[21:02:12] *** Quits: plastico (~plastico@neomutt/plastico) (Quit: WeeChat 3.4)
[21:02:45] *** Joins: plastico (~plastico@neomutt/plastico)
[21:13:58] *** Quits: Vonter (~Vonter@user/vonter) (Ping timeout: 250 seconds)
[21:17:13] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[21:22:13] *** Quits: blaub (~blaub@194-208-201-025.tele.net) (Quit: WeeChat 3.4)
[21:23:25] *** Quits: rgrinberg (~textual@2806:101e:7:4889:3c8d:4176:aa67:59be) (Remote host closed the connection)
[21:28:43] *** Quits: Maxattax (~max@50-195-160-193-static.hfc.comcastbusiness.net) (Ping timeout: 256 seconds)
[21:33:48] *** Joins: Maxattax (~max@50-195-160-193-static.hfc.comcastbusiness.net)
[21:37:48] *** Quits: bsd4me (~IceChat95@user/bsd4me) (Ping timeout: 250 seconds)
[21:55:02] *** Joins: bsd4me (~IceChat95@user/bsd4me)
[22:22:54] <strajder> flatcap: about the translation, "attachments to be grouped must have the same parent" - what is the "parent" of the attachments in this case?
[22:23:01] *** Quits: gabriel1 (~gabriel1@user/gabriel1) (Remote host closed the connection)
[22:24:42] *** Joins: gabriel1 (~gabriel1@user/gabriel1)
[22:30:05] *** Quits: vysn (~vysn@user/vysn) (Ping timeout: 252 seconds)
[22:35:57] *** Quits: madage (~madage@user/madage) (Remote host closed the connection)
[22:36:12] *** Joins: madage (~madage@user/madage)
[22:40:51] *** Quits: bsd4me (~IceChat95@user/bsd4me) (Ping timeout: 256 seconds)
[22:41:22] <flatcap> strajder: attachments can now be deeply nested...
[22:42:16] <flatcap> if you imagine two trees of nested attachments  A->B->C and D->E->F
[22:42:54] <flatcap> if you tagged C and F, you can't group them because they are in different trees
[22:43:40] *** Joins: blaub (~blaub@194-208-201-025.tele.net)
[22:43:52] <flatcap> I hope that makes sense (in 2D text :-)
[22:44:50] <strajder> ok, so an attachment can be a parent to a group of attachments?
[22:46:29] <flatcap> yes
[22:48:27] <strajder> ty
[22:48:38] <flatcap> np
[23:36:08] *** Quits: blaub (~blaub@194-208-201-025.tele.net) (Quit: WeeChat 3.4)
[23:57:31] *** Joins: bsd4me (~IceChat95@user/bsd4me)
