[00:03:31] *** Joins: bn_work (uid268505@id-268505.uxbridge.irccloud.com)
[00:31:25] *** Quits: jmdaemon (~jmdaemon@user/jmdaemon) (Ping timeout: 256 seconds)
[00:49:44] *** Joins: jmdaemon (~jmdaemon@user/jmdaemon)
[01:03:23] *** Joins: tirnanog (~tirnanog@user/tirnanog)
[01:14:39] *** Joins: wwilliam (~afernande@user/wwilliam)
[01:15:12] <wwilliam> Did anyone answer my sed question before?  Unfortunelly I lost my connection.
[01:15:46] *** Parts: velix (~velix@user/velix) (Leaving)
[01:18:15] <Riviera> wwilliam: were you wwallace?
[01:34:34] *** Joins: lgc (~lgc@user/lgc)
[01:35:00] *** Quits: bomb-on (~bomb-on@194.144.47.113) (Read error: Connection reset by peer)
[01:38:51] <emanuele6> wwilliam wwallace 
[01:51:30] *** Joins: magyar (~magyar@user/magyar)
[01:52:42] *** Joins: malina (~malina@user/malina)
[01:53:11] <magyar> hi, I'm trying to insert a line to a file only if that line doesn't exists but it failing, here is the command >>  "sed '/TasksMax=18100/^LimitNPROC=.*/a TasksMax=18100'  myFile"
[01:53:33] <magyar> the error I get is "sed: -e expression #1, char 17: unknown command: `^'"
[01:56:09] <emanuele6> what is that supposed to do?
[01:57:03] *** Quits: malina (~malina@user/malina) (Remote host closed the connection)
[01:58:09] <emanuele6> add what line?
[02:00:19] <magyar> emanuele6: I want to add the line TasksMax=18100 after the line LimitNPROC=.* but only if it's not there already 
[02:00:28] <emanuele6> anyhow, that would be something like   -e '/my_line/ { :x' -e 'N; bx' -e '}; $i\'$'\n''my_line' 
[02:01:09] <emanuele6> that is an operation that requires seeking the file
[02:01:34] <emanuele6> use a file editor like ed instead of sed if you want to do that operation
[02:02:49] <emanuele6> my code above added it to the end
[02:03:05] <emanuele6> if you want after the LimitNPROC line, you need ed
[02:03:09] <magyar> ok, thank you
[02:05:15] <emanuele6> printf '%s\n' 'g/^TasksMax=.*$/q' '/^LimitNPROC=./a' TasksMax=18100 . w q | ed -s my_file
[02:05:20] <emanuele6> this is how you would do it with ed
[02:05:42] <emanuele6> or even
[02:05:56] <emanuele6> printf '%s\n' 'g/^TasksMax=/q' '/^LimitNPROC=./a' TasksMax=18100 . w q | ed -s my_file
[02:06:20] <emanuele6> 'g/^TasksMax=/q'  <-- if there is a line that starts with "TasksMax=" quit immediately
[02:07:16] <emanuele6> otherwise, '/^LimitNPROC=/a'  <-- go to the line that starts with "LimitNPROC=" and append from that line
[02:07:42] <emanuele6> 'TasksMax=18100' '.'  <-- append a line that contains "TasksMax=18100"
[02:07:52] <emanuele6> 'w'  <-- write modifications to the file
[02:07:56] <emanuele6> 'q'  <-- quit
[02:08:11] <emanuele6> printf '%s\n' 'g/^TasksMax=/q' '/^LimitNPROC=/a' TasksMax=18100 . w q | ed -s my_file
[02:08:26] <emanuele6> ( there was an extra `.' after LimitNPROC=, removed it )
[02:09:57] <magyar> it works the first time, but it keeps adding a line if i run it the second time
[02:13:16] <emanuele6> mm
[02:13:24] <tirnanog> I don't see how that's possible.
[02:13:33] <emanuele6> i don't see it either
[02:13:39] <tirnanog> cannot reproduce either.
[02:17:26] <magyar> https://bpa.st/66TQ  this is the file content after I ran the command "printf '%s\n' 'g/^TasksMax=/q' '/^LimitNPROC=/a' TasksMax=18100 . w q | ed -s wasnode.service"
[02:18:08] <magyar> each time I run the command I get a new line with "?" and a line inserted in the file
[02:20:42] <emanuele6> i really cannot reproduce it
[02:21:26] <emanuele6> perhaps show how you are running the command?
[02:23:22] <magyar> emanuele6: I just run that oneliner in bash sles 12
[02:24:43] <emanuele6> does   sed -n l wasnode.service  show any weird characters?
[02:24:53] <tirnanog> it doesn't make any sense. can you pastebin the service file in its initial state? nc termbin.com 9999 < wasnode.service
[02:26:23] <magyar> nothing odd, justa dollar sign at the end of each line
[02:42:06] *** Quits: lgc (~lgc@user/lgc) (Quit: WeeChat 3.2-dev)
[03:15:00] *** Joins: bomb-on (~bomb-on@194.144.47.113)
[03:16:34] *** Joins: _ev (ev@user/ev/x-8999918)
[03:44:49] *** Quits: bomb-on (~bomb-on@194.144.47.113) (Quit: aллилѹіа!)
[03:59:51] <wwilliam> emanuele6: yes
[04:37:38] *** Joins: treble (~treble@user/treble)
[04:54:40] *** Quits: treble (~treble@user/treble) (Quit: WeeChat 3.4)
[05:30:22] *** Quits: vlm (~vlm@user/vlm) (Quit: "")
[05:42:41] <magyar> tirnanog: termbin.com 9999 is blocked on that server
[05:43:42] <tirnanog> magyar: if you can use https, there are some good ones such as 0x0.st, ix.io, sprunge.us etc.
[05:48:27] <magyar> something is off with this box, I've copied the text to my box which was ed 1.17 and works fine, on that server with ed 1.9 it fails
[05:49:31] <magyar> it produces a "?" every time i re-run the command and the text is getting appended 
[05:50:13] <tirnanog> it's sounding like a bug, then.
[05:50:35] <tirnanog> would you happen to have busybox available on the latter server? you could try its ed implementation.
[05:51:03] <e36freak> can try to run the ed commands manually and see what it's erring on
[05:51:25] <tirnanog> if you're going to do that, make sure the initial command is 'H'
[05:52:35] <tirnanog> blast. no changelog in the ed sources.
[05:57:24] <magyar> e36freak: exactly what I did, and I can reproduce it
[05:57:41] <magyar> so there is some bug in the 1.9 version of sles
[05:58:02] <tirnanog> I can't even find a 1.9 release in GNU's archives.
[05:58:14] <tirnanog> maybe it was an unofficial interim release on the part of sles.
[05:59:10] <magyar> on my 1.17, if I run the "g/^TasksMax=18100/q" command and the line is in the file, it just exist ed
[05:59:19] <magyar> not happening on this 1.9
[05:59:30] <tirnanog> hmm.
[05:59:46] <magyar> produces a "?"
[06:00:12] <magyar> maybe no support for "/q"
[06:00:26] <magyar> but "g/^TasksMax=18100" find the lines just fine
[06:00:34] <magyar> so the quit part fails
[06:00:36] <tirnanog> does it make any difference in 1.9 if you write it as: 'g/^TasksMax=18100/q\' .
[06:00:59] <tirnanog> actually that doesn't make sense. I mean, just with a trailing backslash after q.
[06:03:03] <tirnanog> it has to support q, by the way (else, how would the final q command work).
[06:03:11] <magyar> nothing happens with the trailing backslash 
[06:03:28] <magyar> beats me
[06:03:33] <tirnanog> ok, can you try the original solution with trailing backslash then?
[06:03:49] <tirnanog> it's not supposed to be there, but may it's enough to 'trick' 1.9, as it were.
[06:03:52] <tirnanog> maybe
[06:04:39] <tirnanog> I would compile it myself, but I have no idea where this 1.9 release even came from.
[06:05:31] <magyar> with or without the backslash it will not recognize the q command
[06:05:33] <tirnanog> ok.
[06:05:39] <magyar> on it's own q works fine
[06:05:44] <magyar> but not chained it
[06:05:48] *** Quits: Atque (~Atque@user/atque) (Remote host closed the connection)
[06:05:48] <magyar> s/it/in
[06:06:11] <tirnanog> very odd. I can only suggest to install busybox on the offending machine, if possible, and prefer its ed builtin if it is found to be installed. clearly, this 1.9 release is broken.
[06:07:36] <magyar> I'm trying vim now, and it seems to work
[06:07:47] <magyar> thanks guys
[06:07:50] <tirnanog> yes, that might be better for you then.
[06:08:09] <tirnanog> ex is scriptable.
[06:08:42] <magyar> which is nice when using ssh, vim -c seems to not work with ssh properly 
[06:08:47] <magyar> bugger
[06:09:09] <tirnanog> ask the #vim people to help you translate it to an ex solution.
[06:10:02] <tirnanog> or, potentially, even the ##posix people (bit of a slow channel, though).
[06:23:27] *** Quits: seninha (~seninha@user/seninha) (Remote host closed the connection)
[06:44:59] *** Joins: BrunoFontes (~bruno@179.176.134.193.dynamic.adsl.gvt.net.br)
[06:52:41] *** Quits: tirnanog (~tirnanog@user/tirnanog) (Quit: = "")
[07:09:40] *** Joins: adeliktas5 (~adeliktas@i59F52EE8.versanet.de)
[07:10:57] *** Quits: adeliktas (~adeliktas@i59F4D5EA.versanet.de) (Ping timeout: 240 seconds)
[07:10:57] *** adeliktas5 is now known as adeliktas
[07:34:43] *** Joins: vlm (~vlm@user/vlm)
[07:40:47] *** Quits: yuesbeez (uid458354@id-458354.tinside.irccloud.com) (Quit: Connection closed for inactivity)
[08:03:16] *** Joins: Atque (~Atque@user/atque)
[08:04:11] *** Quits: BrunoFontes (~bruno@179.176.134.193.dynamic.adsl.gvt.net.br) (Ping timeout: 256 seconds)
[08:04:45] *** Quits: fcr (~fran@r186-48-157-191.dialup.adsl.anteldata.net.uy) (Ping timeout: 256 seconds)
[08:09:56] *** Joins: fcr (~fran@r167-60-128-69.dialup.adsl.anteldata.net.uy)
[09:15:55] *** Joins: nerozero (~nerozero@87.253.63.54)
[09:57:11] *** Quits: larryv (~larryv@zsh/patchmanager/larryv) (Quit: larryv)
[10:11:01] *** Quits: Atque (~Atque@user/atque) (Quit: ...)
[11:27:01] *** Joins: Atque (~Atque@user/atque)
[11:57:02] *** Quits: nerozero (~nerozero@87.253.63.54) (Ping timeout: 240 seconds)
[11:58:22] *** Joins: nerozero (~nerozero@87.253.63.54)
[12:44:24] *** Quits: nerozero (~nerozero@87.253.63.54) (Ping timeout: 250 seconds)
[12:57:15] *** Joins: nerozero (~nerozero@87.253.63.54)
[13:02:52] *** Joins: tirnanog (~tirnanog@user/tirnanog)
[13:22:35] *** Joins: seninha (~seninha@user/seninha)
[13:33:56] *** Quits: Atque (~Atque@user/atque) (Quit: ...)
[13:46:35] *** Quits: _ev (ev@user/ev/x-8999918) (Quit: Leaving.)
[13:47:15] *** Joins: Atque (~Atque@user/atque)
[14:57:33] <Riviera> i don't find ex a good choice for scripting.
[14:57:58] <Riviera> all the ex variants differ, none are posix, especially concerning scripting and command line arguments,
[14:58:00] *** Quits: tirnanog (~tirnanog@user/tirnanog) (Quit: = "")
[14:58:13] <Riviera> and many want ... okay then leave :) ... many want stdin to be a tty.
[15:55:44] *** Joins: BrunoFontes (~bruno@187.115.253.43)
[15:58:29] *** Quits: jmdaemon (~jmdaemon@user/jmdaemon) (Ping timeout: 256 seconds)
[16:14:12] *** Quits: BrunoFontes (~bruno@187.115.253.43) (Quit: WeeChat 3.3)
[16:14:30] *** Joins: bruno2 (~bruno@187.115.253.43)
[16:15:03] *** bruno2 is now known as BrunoFontes
[16:15:14] *** Quits: BrunoFontes (~bruno@187.115.253.43) (Client Quit)
[16:18:19] *** Quits: przemoc (~przemoc@89-72-24-4.dynamic.chello.pl) (Ping timeout: 256 seconds)
[16:19:07] *** Joins: przemoc (~przemoc@89-72-24-4.dynamic.chello.pl)
[16:19:07] *** Quits: przemoc (~przemoc@89-72-24-4.dynamic.chello.pl) (Changing host)
[16:19:07] *** Joins: przemoc (~przemoc@user/przemoc)
[16:22:11] *** Joins: tsujp (~tsujp@sourcehut/user/tsujp)
[16:59:37] *** Quits: tsujp (~tsujp@sourcehut/user/tsujp) (Quit: Client closed)
[16:59:54] *** Joins: tsujp (~tsujp@sourcehut/user/tsujp)
[18:45:27] *** Quits: geirha (~geirha@user/geirha) (Ping timeout: 256 seconds)
[20:05:57] *** Quits: fcr (~fran@r167-60-128-69.dialup.adsl.anteldata.net.uy) (Ping timeout: 240 seconds)
[20:12:21] *** Joins: fcr (~fran@r186-48-50-103.dialup.adsl.anteldata.net.uy)
[20:50:24] *** Joins: tirnanog (~tirnanog@user/tirnanog)
[21:13:49] *** Joins: bomb-on (~bomb-on@194.144.47.113)
[21:16:15] *** Quits: Atque (~Atque@user/atque) (Ping timeout: 276 seconds)
[21:22:10] *** Joins: Atque (~Atque@user/atque)
[21:32:30] *** Quits: tsujp (~tsujp@sourcehut/user/tsujp) (Quit: Client closed)
[21:54:53] *** Joins: larryv (~larryv@zsh/patchmanager/larryv)
[22:00:35] *** Quits: nerozero (~nerozero@87.253.63.54) (Ping timeout: 256 seconds)
[22:14:31] *** Joins: nvmd (~nvmd@user/nvmd)
[22:30:15] *** Quits: Atque (~Atque@user/atque) (Remote host closed the connection)
[22:31:44] *** Joins: Atque (~Atque@user/atque)
[22:35:12] *** Quits: nvmd (~nvmd@user/nvmd) (Quit: Later, nerds.)
[22:40:21] *** Joins: geirha (~geirha@user/geirha)
