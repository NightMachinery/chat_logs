[00:01:46] *** Joins: emacsomancer (~emacsoman@136.60.143.85)
[00:06:57] *** Quits: emacsomancer (~emacsoman@136.60.143.85) (Quit: WeeChat 3.2)
[00:08:08] *** Joins: emacsomancer (~emacsoman@136.60.143.85)
[00:25:15] *** Quits: Null_A (~null_a@2601:645:8700:2290:f559:df0a:6e82:e360) (Read error: Connection reset by peer)
[00:27:08] *** Quits: emacsomancer (~emacsoman@136.60.143.85) (Ping timeout: 245 seconds)
[00:32:07] *** Joins: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42)
[00:44:49] *** Quits: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42) (Remote host closed the connection)
[00:49:14] *** Joins: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42)
[00:55:57] *** Joins: emacsomancer (~emacsoman@136.60.128.68)
[00:59:03] *** Quits: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42) (Remote host closed the connection)
[00:59:13] *** Quits: emacsomancer (~emacsoman@136.60.128.68) (Read error: Connection reset by peer)
[01:01:45] *** Quits: jespada (~jespada@90.254.247.46) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:02:22] *** Joins: silasfox (~sbv@165.56.184.236)
[01:04:29] *** Joins: libertyprime (~libertypr@124.197.60.232)
[01:09:07] *** Quits: libertyprime (~libertypr@124.197.60.232) (Ping timeout: 255 seconds)
[01:12:52] *** Joins: mwnaylor (~user@2601:5ce:4300:5fa0::fb44)
[01:21:18] *** Quits: op2 (~op@user/op2) (Remote host closed the connection)
[01:24:09] *** Joins: op2 (~op@user/op2)
[01:28:19] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[01:38:38] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Ping timeout: 252 seconds)
[01:54:41] *** Joins: emacsomancer (~emacsoman@136.60.128.68)
[01:58:10] *** Quits: archenoth (~archenoth@S0106889e6827f474.cg.shawcable.net) (Quit: Leaving)
[02:01:31] *** Joins: libertyprime (~libertypr@124.197.60.232)
[02:02:57] *** Joins: archenoth (~archenoth@s0106889e6827f474.cg.shawcable.net)
[02:13:55] *** Quits: silasfox (~sbv@165.56.184.236) (Ping timeout: 255 seconds)
[02:14:42] *** Joins: silasfox (~sbv@165.56.184.236)
[02:18:13] *** Joins: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42)
[02:19:35] *** Quits: uncleyear (~ian@93.185.27.45) (Ping timeout: 255 seconds)
[02:20:30] *** Joins: uncleyear (~ian@93.185.27.45)
[02:22:41] *** Quits: emacsomancer (~emacsoman@136.60.128.68) (Quit: WeeChat 3.2)
[02:23:46] *** Joins: emacsomancer (~emacsoman@136.60.128.68)
[02:23:48] *** Quits: libertyprime (~libertypr@124.197.60.232) (Ping timeout: 258 seconds)
[02:25:50] *** Quits: seschwar (~seschwar@user/seschwar) (Quit: :wq)
[02:29:17] *** Quits: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42) (Remote host closed the connection)
[02:36:17] *** Joins: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42)
[02:37:57] *** Joins: jespada (~jespada@90.254.247.46)
[02:38:02] *** Quits: silasfox (~sbv@165.56.184.236) (Ping timeout: 265 seconds)
[02:45:06] *** Quits: jespada (~jespada@90.254.247.46) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:50:06] *** Quits: op2 (~op@user/op2) (Remote host closed the connection)
[02:53:47] *** Joins: jespada (~jespada@90.254.247.46)
[03:03:34] *** Joins: libertyprime (~libertypr@118.149.86.221)
[03:08:19] *** Quits: harrigan (~harrigan@176.116.124.143) (Quit: ZNC 1.8.2 - https://znc.in)
[03:11:31] *** Quits: libertyprime (~libertypr@118.149.86.221) (Ping timeout: 268 seconds)
[03:14:49] *** Joins: harrigan (~harrigan@176.116.124.143)
[03:27:25] *** Quits: jespada (~jespada@90.254.247.46) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[05:59:27] *** Quits: harrigan (~harrigan@176.116.124.143) (Quit: ZNC 1.8.2 - https://znc.in)
[06:10:25] *** Joins: harrigan (~harrigan@176.116.124.143)
[06:18:14] *** Quits: harrigan (~harrigan@176.116.124.143) (Quit: ZNC 1.8.2 - https://znc.in)
[06:24:02] *** Joins: harrigan (~harrigan@176.116.124.143)
[06:42:34] *** Quits: mwnaylor (~user@2601:5ce:4300:5fa0::fb44) (Ping timeout: 256 seconds)
[06:51:52] *** Joins: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz)
[06:57:10] *** Quits: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz) (Ping timeout: 265 seconds)
[06:58:06] *** Joins: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz)
[07:18:24] *** Joins: theruran (uid11305@id-11305.stonehaven.irccloud.com)
[07:30:06] *** Quits: Null_A (~null_a@2601:645:8700:2290:51:7614:ed:3f42) (Remote host closed the connection)
[07:42:38] *** Quits: paravida (~myChateau@user/paravida) (Remote host closed the connection)
[07:44:38] *** Quits: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz) (Ping timeout: 252 seconds)
[07:46:22] *** Joins: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz)
[07:53:01] *** Quits: harrigan (~harrigan@176.116.124.143) (Quit: ZNC 1.8.2 - https://znc.in)
[07:59:12] *** Joins: harrigan (~harrigan@176.116.124.143)
[08:27:07] *** Joins: struchu (~struchu@staticline-31-183-186-26.toya.net.pl)
[08:40:05] *** Joins: Null_A (~null_a@2601:645:8700:2290:a92e:e23d:59b7:f2e9)
[08:47:40] *** Quits: libertyprime (~libertypr@client-172-129.guest.otago.ac.nz) (Ping timeout: 268 seconds)
[09:11:48] *** Joins: Iacob (~Iacob@106.47.76.147)
[09:20:10] *** Quits: harrigan (~harrigan@176.116.124.143) (Quit: ZNC 1.8.2 - https://znc.in)
[09:21:26] *** Joins: harrigan (~harrigan@176.116.124.143)
[09:44:27] *** Quits: Iacob (~Iacob@106.47.76.147) (Remote host closed the connection)
[09:44:53] *** Joins: Iacob (~Iacob@106.47.76.147)
[09:48:24] *** Quits: uncleyear (~ian@93.185.27.45) (Remote host closed the connection)
[09:49:26] *** Joins: uncleyear (~ian@93.185.27.45)
[09:59:04] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[10:05:35] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Ping timeout: 255 seconds)
[10:34:26] *** Quits: ahungry (~user@99-40-9-245.lightspeed.livnmi.sbcglobal.net) (Remote host closed the connection)
[10:52:20] *** Joins: libertyprime (~libertypr@124.197.60.232)
[11:19:04] *** Joins: silasfox (~sbv@165.56.184.158)
[11:30:03] *** Joins: cranium (~cranium@user/cranium)
[12:04:55] *** Joins: jespada (~jespada@90.254.247.46)
[12:17:08] *** Joins: Oshawott (~archenoth@s0106889e6827f474.cg.shawcable.net)
[12:17:15] *** Quits: harrigan (~harrigan@176.116.124.143) (Ping timeout: 255 seconds)
[12:20:00] *** Quits: archenoth (~archenoth@s0106889e6827f474.cg.shawcable.net) (Ping timeout: 252 seconds)
[12:21:02] *** Quits: Iacob (~Iacob@106.47.76.147) (Ping timeout: 268 seconds)
[12:22:56] *** Joins: harrigan (~harrigan@176.116.124.140)
[12:32:03] *** Quits: Null_A (~null_a@2601:645:8700:2290:a92e:e23d:59b7:f2e9) ()
[12:35:01] *** Quits: harrigan (~harrigan@176.116.124.140) (Ping timeout: 265 seconds)
[12:36:36] *** Joins: hendursa1 (~weechat@user/hendursaga)
[12:40:04] *** Quits: hendursaga (~weechat@user/hendursaga) (Ping timeout: 244 seconds)
[12:43:27] *** Joins: harrigan (~harrigan@176.116.124.142)
[12:56:48] *** Quits: struchu (~struchu@staticline-31-183-186-26.toya.net.pl) (Ping timeout: 268 seconds)
[13:10:56] *** Quits: harrigan (~harrigan@176.116.124.142) (Ping timeout: 258 seconds)
[13:26:29] *** Quits: nivag (~gavin@103-76-144-176.ip.cis.gen.nz) (Remote host closed the connection)
[13:30:53] *** Joins: nivag_2c (~gavin@103-76-144-176.ip.cis.gen.nz)
[13:30:53] *** Joins: nivag (~gavin@103-76-144-176.ip.cis.gen.nz)
[13:37:16] *** Joins: harrigan (~harrigan@176.116.124.142)
[13:41:27] *** Quits: harrigan (~harrigan@176.116.124.142) (Client Quit)
[13:58:28] *** Quits: runejuhl (~runejuhl@185.166.122.161) (Ping timeout: 258 seconds)
[13:59:03] *** Joins: harrigan (~harrigan@176.116.124.142)
[14:06:02] *** Joins: runejuhl (~runejuhl@185.166.122.161)
[14:07:40] *** Quits: nivag (~gavin@103-76-144-176.ip.cis.gen.nz) (Quit: Disappears in a blinding flash of gravitational waves)
[14:10:22] *** Quits: harrigan (~harrigan@176.116.124.142) (Ping timeout: 252 seconds)
[14:30:49] *** Joins: harrigan (~harrigan@176.116.124.140)
[14:43:27] *** Quits: xsperry (~as@user/xsperry) (Remote host closed the connection)
[15:06:00] *** Joins: struchu (~struchu@staticline-31-183-186-26.toya.net.pl)
[15:06:06] *** Quits: harrigan (~harrigan@176.116.124.140) (Ping timeout: 252 seconds)
[15:08:32] *** Joins: harrigan (~harrigan@176.116.124.140)
[15:28:23] *** Quits: harrigan (~harrigan@176.116.124.140) (Quit: ZNC 1.8.2 - https://znc.in)
[15:34:40] *** Joins: harrigan (~harrigan@176.116.124.140)
[15:36:13] <EdwardIII> how do you guys deploy your clojure webapps? just a standalone jar file that runs jetty? WAR + tomcat or something?
[15:39:44] <EdwardIII> mine is just a toy app so slapping a standalone jar on a cheap VPS seems like a good call (or perhaps lambda, but clojure on lambda looks like it could be a headache))
[15:40:20] <ridcully> uberjar with whatever server.  i havent used WAR in a long time now (JVM in general, not just clojure)
[15:44:53] <EdwardIII> ridcully: still using clojure? or not really?
[15:48:01] <ridcully> what do you mean?
[15:49:05] <EdwardIII> ridcully: are you still using clojure these days, but on a non-JVM platform?
[15:49:11] <EdwardIII> or just not at all?
[15:50:48] <ridcully> no i meant, i have never used war for clojure and i have not used wars for a long time in general
[15:52:00] <EdwardIII> ah ha got it, sorry
[15:52:25] <EdwardIII> which server are you using with uberjars if you don't mind me asking?
[16:02:05] <sobel> i would deploy uberjar if i could. thanks to dependence on an xml library with a static initializer, i can't use uberjars.
[16:03:12] <sobel> that probably screws up a vertx server designed to serve from classpath, too
[16:06:02] <wink> EdwardIII: surely not the best way but I have one in a docker container, doing "lein with-profile production trampoline ring server", which has lasted for years (superisord before docker) for a small amount of users.
[16:06:19] <wink> alhough I remember running an uberjar in the past, never WAR
[16:06:47] *** Quits: harrigan (~harrigan@176.116.124.140) (Ping timeout: 245 seconds)
[16:07:31] <EdwardIII> wink: righty, i was thinking something like that too. quick n dirty. :) only thing is i'm not really sure what the memory requires will be for ring server. i guess the only way to find out is TIAS locally and see what it does
[16:08:45] <wink> probably
[16:09:56] *** Joins: harrigan (~harrigan@176.116.124.140)
[16:23:47] *** Joins: IPmonger (~IPmonger@172.58.203.157)
[16:24:02] *** Quits: IPmonger (~IPmonger@172.58.203.157) (Remote host closed the connection)
[16:24:38] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[16:47:33] *** Quits: nivag_2c (~gavin@103-76-144-176.ip.cis.gen.nz) (Quit: Disappears in a blinding flash of gravitational waves)
[16:48:03] *** Joins: nivag (~gavin@103-76-144-176.ip.cis.gen.nz)
[16:49:24] *** Joins: yoonkn (~user@175.197.208.79)
[16:52:39] *** Quits: harrigan (~harrigan@176.116.124.140) (Ping timeout: 255 seconds)
[16:57:31] *** Joins: harrigan (~harrigan@176.116.124.140)
[16:59:44] <ToxicFrog> Yeah, I also do uberjar with integrated server as a rule
[17:02:44] *** Quits: mefesto (~mefesto@072-238-044-125.res.spectrum.com) (Quit: Leaving)
[17:07:06] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Ping timeout: 252 seconds)
[17:13:40] *** Joins: mefesto (~mefesto@072-238-044-125.res.spectrum.com)
[17:14:35] *** Quits: hendursa1 (~weechat@user/hendursaga) (Quit: hendursa1)
[17:15:53] *** Joins: hendursaga (~weechat@user/hendursaga)
[17:26:00] <Para> I wouldn't use any Servlet Container separately from the actual application on Java side either these days.
[17:29:11] <wink> I think the JVM ecosystem is pretty unique in this regard in that most webservers are also written for the JVM and "bundled" like this
[17:29:45] <wink> everywhere else it boils down to "run as process and communicate via (fast/s/w/abc)cgi
[17:43:32] *** Joins: xsperry (~as@user/xsperry)
[17:55:50] <EdwardIII> Para: no like wildfly or anything?
[18:00:16] <Para> EdwardIII: nah, unless it can be embedded
[18:00:35] <Para> If someone else of course sets up such an environment for me, then I don't mind :)
[18:01:07] <EdwardIII> sure sure. i've never done anything on the jvm before so this is all pretty new to me :) and there are a gazillion options to choose from heh
[18:04:12] *** Quits: libertyprime (~libertypr@124.197.60.232) (Ping timeout: 255 seconds)
[18:06:23] *** Joins: libertyprime (~libertypr@124.197.60.232)
[18:21:47] *** Quits: libertyprime (~libertypr@124.197.60.232) (Ping timeout: 268 seconds)
[18:25:05] *** Quits: struchu (~struchu@staticline-31-183-186-26.toya.net.pl) (Ping timeout: 255 seconds)
[18:51:09] *** Quits: hendursaga (~weechat@user/hendursaga) (Remote host closed the connection)
[18:51:33] *** Joins: hendursaga (~weechat@user/hendursaga)
[18:55:56] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[19:00:15] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Ping timeout: 252 seconds)
[19:14:32] *** Quits: silasfox (~sbv@165.56.184.158) (Ping timeout: 256 seconds)
[19:28:31] *** Quits: lunik1 (~lunik1@37.205.14.203) (Quit: :x)
[19:30:01] *** Joins: mwnaylor (~user@2601:5ce:4300:5fa0::2483)
[19:33:06] *** Joins: lunik1 (~lunik1@37.205.14.203)
[19:44:11] *** Quits: mwnaylor (~user@2601:5ce:4300:5fa0::2483) (Read error: Connection reset by peer)
[19:46:36] *** Joins: silasfox (~sbv@165.56.184.158)
[19:47:00] *** Joins: mwnaylor (~user@2601:5ce:4300:5fa0::2483)
[19:47:14] *** Quits: mwnaylor (~user@2601:5ce:4300:5fa0::2483) (Client Quit)
[19:48:31] *** Joins: mwnaylor (~user@2601:5ce:4300:5fa0::2483)
[19:55:54] <technomancy> TIL there are library dependencies you can have that make it impossible to use uberjars
[20:04:15] <ridcully> as in they can not be copied into one jar?  due to some clash of content like meta-inf stuff?
[20:05:12] *** Quits: yoonkn (~user@175.197.208.79) (Read error: Connection reset by peer)
[20:06:02] *** Quits: silasfox (~sbv@165.56.184.158) (Ping timeout: 252 seconds)
[20:10:22] <sobel> it's been so long since i tried to use jboss, i have no idea what it does beyond EJBs anymore
[20:11:04] <technomancy> ridcully: sobel said something about static initializers?
[20:12:50] <sobel> a library that presumes to load a config file in its classpath via static init will fail in uberjar context, when the library is a dependency that gets bundled into the uberjar, because the classpath to the nested jar is not the same
[20:13:15] <sobel> if there's even such a thing as reading from the nested jar
[20:13:39] <technomancy> IDGI; you can still set a classpath to add config files when using an uberjar
[20:13:53] <technomancy> it just can't be 100% self contained maybe
[20:15:09] <sobel> it's been a while, i'll be back in that codebase to see how that issue manifests currently soon enough
[20:16:50] <ridcully> oh i missed that
[20:16:55] <sobel> doesn't java -jar preclude customizing the classpath? ISTR that was my stumbling block when i hoped to use the uberjar with config files on teh filesystem
[20:17:15] <technomancy> sobel: uberjars work with java -cp
[20:17:28] <ridcully> sobel: i know about a similar problem when using jars, that needs the sun.xml.somethingies and they find it by a file under meta-inf
[20:17:45] <ridcully> but you can define this factory also via -D flag
[20:17:52] <ridcully> might be unrelated though
[20:18:24] <sobel> ridcully: i'm pretty sure that's the same territory. i'd be pretty happy to get back to uberjar.
[20:19:28] <sobel> currently i have a terrible construction that parses `lein cp` to fish all the deps out of the local maven cache
[20:19:50] <ridcully> the problem in my case was with a springboot "uberjar" (they are more complex: copied jars inside jar and custom classloader) - the classloader did not cache the meta-inf entry and looked it up for basically each node inside an openoffice document - generating that file took 10min in prod where it tool 10s on my desktop
[20:20:01] <sobel> so glad i can put lib/* in my classpath
[20:20:33] <technomancy> "jars inside jar" O_O
[20:21:03] *** Joins: Null_A (~null_a@2601:645:8700:2290:9d5c:9f84:452e:3ad)
[20:22:27] *** Joins: seschwar (~seschwar@user/seschwar)
[20:22:44] <sobel> hrm, it's definitely time to revisit my uberjar problems since i have upgraded to the most current legacy support libs
[20:30:45] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[20:35:13] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Ping timeout: 258 seconds)
[20:42:11] <Para> static initializers are the devil
[20:42:54] <sobel> preach
[20:43:09] <Para> I recently found one in client project where it assumed a config file to exist in "C:\SOME\PATH\FILE.FOO", wasn't fun to notice when my task was pretty much "containerize this so we can run it on Linux"
[20:43:26] <Para> It didn't even use the File nor Path APIs, just plain new Properties("that path")
[20:44:01] *** Joins: IPmonger (~IPmonger@c-69-242-83-226.hsd1.pa.comcast.net)
[20:44:08] <sobel> smh
[20:44:14] *** Quits: IPmonger (~IPmonger@c-69-242-83-226.hsd1.pa.comcast.net) (Remote host closed the connection)
[20:44:20] *** Joins: op2 (~op@user/op2)
[20:44:28] <Para> Of course my favorite issue deals with classpaths, as described
[20:45:33] <Para> Used to work ages ago on database which implemented its own classloader to support the driver (because why not) and static init block just assumed things about the classloader hierarchy which weren't possible to set up even in unit tests, really. It's funny how at certain generation of JVM software there's a lot of weirdness like that.
[21:02:10] *** Joins: cmiles74 (~miles@068-184-030-013.res.spectrum.com)
[21:04:21] *** Quits: cmiles74 (~miles@068-184-030-013.res.spectrum.com) (Remote host closed the connection)
[21:09:37] *** Joins: DrNick52 (~DrNick@c-98-34-176-166.hsd1.tx.comcast.net)
[21:09:50] *** Quits: DrNick52 (~DrNick@c-98-34-176-166.hsd1.tx.comcast.net) (Client Quit)
[21:10:10] *** Joins: DrNick90 (~DrNick@c-98-34-176-166.hsd1.tx.comcast.net)
[21:12:52] <EdwardIII> ah i've not heard of static initialisation block. it's like BEGIN in perl?
[21:13:20] <EdwardIII> why would you ever want this, except if you needed to hack something in tests?
[21:14:51] <technomancy> how else are you supposed to initialize your static
[21:17:00] <EdwardIII> :D
[21:17:34] <sobel> back in the day, you could just sample some right off your TV
[21:18:19] <Para> Hmm, I wonder if CRT noise can be considered random enough.
[21:19:42] <DrNick90> I was wondering if anyone had some pointers on how I can get more debug information about why Clojure is choking on my code after a refactor.
[21:19:53] <DrNick90> I get this error when I run:
[21:19:54] <DrNick90> Exiting: Unable to resolve symbol
[21:20:02] <DrNick90> that's it.
[21:20:21] <DrNick90> no symbol name, no "Full trace at /tmp/..." — nothing :'(
[21:20:42] <DrNick90> I was looking for some way to enable verbose output or debug mode or something, but no luck so far
[21:21:00] <EdwardIII> DrNick90: does yours say "open this xxx.edn file for full details" in the output?
[21:21:13] <EdwardIII> oh, you already said, no
[21:21:19] <DrNick90> yeah, nothing :(
[21:21:31] <DrNick90> at this point it looks like the only option will be to revert changes one by one until the error goes away....
[21:21:42] <Para> Hmm, could be you've managed to place some weird invisible whitespace somewhere.
[21:21:54] <Para> Macs at least seem to be capable of doing that sometims, which is weird.
[21:21:58] <DrNick90> I was using Clojure 1.10.1 in my project.clj, which I noticed was outdated so I switched to 1.10.3, but no change
[21:22:10] <Para> Like that non-visible hyphen thing for example.
[21:26:35] <DrNick90> Para - just tried `find -name '*.clj' -exec grep '[^[:graph:][:space:]]' '{}' ';'`, but it came back empty
[21:27:55] <DrNick90> actually, not sure if `[:space:]` includes weird unicode values, so I tried this too:
[21:28:07] <DrNick90> `find -name '*.clj' -exec grep '[^[:graph:] ]' '{}' ';'` (also no result)
[21:29:03] <EdwardIII> that sucks
[21:32:31] <DrNick90> probably unrelated (because I've had this problem forever), but `lein check` also hangs forever on the last namespace in my project... any ideas on how to figure out why it's stuck there would also be appreciated :)  
[21:33:32] <technomancy> you're probably starting a background thread that never stops
[21:33:38] <technomancy> at compile-time
[21:33:42] <jeaye> DrNick90: Do you have blocking code running at the top-level?
[21:33:59] <jeaye> i.e. (def server (start-server!))
[21:34:41] <jeaye> Don't put effects at the top level without wrapping them in a delay.
[21:35:23] <jeaye> i.e. (def public-ip (delay (fetch-ip!)))
[21:35:33] <DrNick90> `lein check` runs your code?! yikes... I don't think I have any of that going on, but I'll check
[21:36:19] <jeaye> This shouldn't matter, if you're following good top-level effect practices.
[21:36:24] <technomancy> compile time is a subset of runtime
[21:36:38] <technomancy> you can't compile code without running all the top level forms
[21:42:04] *** Quits: ozzymcduff (~mathieu@81-234-151-21-no94.tbcn.telia.com) (Remote host closed the connection)
[21:45:47] <jeaye> It's not just `lein check`; it's anything that compiles your code. Same goes for `lein uberjar` or your favorite CLJ linter.
[21:45:53] <DrNick90> ok, yeah, I did a jstack and it looks like `lein check` is hanging because something started a couple of "clojure-agent-send-off-pool` threads
[21:46:39] <DrNick90> @jeaye - `lein uberjar` doesn't hang though, only `lein check`
[21:47:34] <jeaye> The man himself may know why. I don't.
[21:50:34] <EdwardIII> god?
[21:51:30] <EdwardIII> when i try and do lein uberjar i get "Could not locate ring/middleware/reload__init.class, ring/middleware/reload.clj or ring/middleware/reload.cljc on classpath." which smells a bit like dev v prod dependencies issue somehow
[21:52:21] <EdwardIII> although i just stick all my ring deps in the top level, so it's a bit confusing: https://gist.github.com/EdwardIII/1e204ef5ff52fa64e78766cdb0918982 maybe like somehow it doesn't load the 'reload' ring dep or something...
[21:59:37] <technomancy> lein check will run all namespaces; lein uberjar will only run the ones needed for AOT
[21:59:40] <technomancy> could be the reason
[22:00:33] <jeaye> Ah, could be doing uberjar without :aot :all.
[22:01:37] <jeaye> EdwardIII: You're requiring ring.middleware.reload in your code somewhere.
[22:01:55] <jeaye> When that code is compiled with your non-dev deps, that require can't be resolved.
[22:03:56] <EdwardIII> jeaye: i am, but i don't include ring in dev deps, it's in my main deps. and it works fine with 'lein run'. hmm'
[22:05:17] <EdwardIII> well, if i add an explicit dep for [ring/ring-devel "1.8.0"] it works. not sure why that is. if you install a dep then later remove it, would 'lein deps' remove it? or leave it hanging around?
[22:05:43] <jeaye> You should not have dev code in your prod builds.
[22:05:57] *** Quits: DrNick90 (~DrNick@c-98-34-176-166.hsd1.tx.comcast.net) (Quit: Client closed)
[22:06:11] <Para> If aot is involved, something may be left in the compile directory between runs that can cause weirdness as well, so remember to clear between dep changes.
[22:07:17] <EdwardIII> jeaye yes that would be nice. currently i just use an 'if' that checks an env var to decide whether to load the reloadable-or-not routes. should i not do it like this? have 2 files, one for dev, one for prod? and somehow exclude the dev file from the uberjar builds? https://github.com/EdwardIII/imjur/blob/main/src/imjur/core.clj#L71  
[22:08:26] <jeaye> You can move your if environment check to a macro.
[22:08:47] <EdwardIII> heh that sounds a bit scary. is there not a more simple way?
[22:08:58] <EdwardIII> presumably everybody must have the same issue right? 
[22:09:58] <jeaye> Yeah. They use macros.
[22:10:03] <jeaye> This is a lisp we're talkinga bout.
[22:10:49] <jeaye>  (defmacro if-dev [if-forms then-forms]
[22:10:50] <jeaye>    `(if ~(= (:my-app-env env) "dev") ~if-forms ~then-forms))
[22:11:03] <EdwardIII> jeaye: but how would that stop the dependency issue?
[22:11:40] <jeaye> Only have the dep in your :dev-dependencies and then use the macro to make sure the code doesn't make it into your prod code.
[22:12:08] <EdwardIII> do the require itself inside the macro body?
[22:12:42] <jeaye> if-dev is there. when-dev is trivial to add. So you can use (when-dev (require '[ring.middleware.reload])) and then later use the if-dev macro to wrap your ring app or not.
[22:13:17] <EdwardIII> gives me an excuse to write my first macro i suppose
[22:13:21] <jeaye> Nothing scary about it. If you're not familiar with macro writing, this is a good learning opportunity for one of the most powerful features of Clojure.
[22:13:55] <jeaye> https://www.braveclojure.com/writing-macros/
[22:14:27] <Para> https://learnxinyminutes.com/docs/clojure-macros/ this one's quite good as well
[22:14:44] <EdwardIII> a lot of the things i read online sort of seem to say "you shouldn't be using macros unless you are a god-tier language designer" and also that the bar for writing macros in lisps is too low compared to other langs
[22:15:02] <technomancy> is a macro really needed there?
[22:15:10] <technomancy> why not (when (dev?) (require 'whatever))
[22:15:28] <jeaye> "You shouldn't use a macro if a function will do." is the mantra.
[22:15:49] <jeaye> technomancy: To remove the code entirely from your prod builds.
[22:16:00] <jeaye> Functionally the same, but arguably cleaner.
[22:17:02] <technomancy> you mean like the ensuring the bytecode for the dev check isn't even included?
[22:17:03] <EdwardIII> having just 1 artifact to deploy for a server-side webapp is pretttttyyy nice 
[22:17:35] <jeaye> technomancy: Yeah, so there's no possible way that an alteration of the var root for dev? could result in an issue.
[22:17:51] <technomancy> seems a bit pedantic
[22:17:57] <jeaye> I've been called worse.
[22:18:03] <technomancy> but if you're looking for an excuse to learn macros I guess it'll suffice =)
[22:21:12] *** Quits: Null_A (~null_a@2601:645:8700:2290:9d5c:9f84:452e:3ad) (Remote host closed the connection)
[22:21:16] <jeaye> EdwardIII: Conditional code compilation, i.e. #ifdef in C-like langs, are done with macros in Clojure, if you want full elision. You can use macros for extending the language in your god-tier example, but macros are also useful for this more mundane task.
[22:21:34] <EdwardIII> thansk jeaye 
[22:21:57] *** Joins: Null_A (~null_a@2601:645:8700:2290:9d5c:9f84:452e:3ad)
[22:22:04] <jeaye> We'll all agree that building your own DSL in Clojure macros for each project may be fun, but it's not going to make the code very usable by others.
[22:28:02] <EdwardIII> so in uberjar form my app seems to use around 200M of memory idling, about 250 when it's servicing requests, and up to about 500 when dealing with 10 concurrent requests
[22:30:21] <EdwardIII> so looks like it should be good to run on a $5/mo DO droplet which has 1G of ram
[22:40:45] <sobel> huh, xinyminutes macros tutorial was very convenient. i might just use them next time it makes sense.
[22:58:44] *** Quits: rickygee (~ricky@236-53-74-65.gci.net) (Read error: Connection reset by peer)
[23:14:18] *** Quits: cranium (~cranium@user/cranium) (Quit: Leaving)
[23:32:57] <jeaye> EdwardIII: You may want to check your JVM flags, too.
[23:33:15] <jeaye> -server or -client and min/max heap size can make a big impact on your memory usage.
[23:33:46] <technomancy> huh; I thought -client was no longer effective post-jdk6
[23:34:50] <jeaye> Hmmmmmm
[23:35:19] <technomancy> IIRC it was originally intended for like ... desktop apps and browser applets?
[23:35:25] <ridcully> also AFAIK server is the default on unix anyway?
[23:35:48] <jeaye> Yeah, -server should be the default.
[23:36:35] <EdwardIII> thanks for the pointer
[23:38:36] *** Joins: IPmonger (~IPmonger@172.58.206.167)
[23:38:50] *** Quits: IPmonger (~IPmonger@172.58.206.167) (Remote host closed the connection)
[23:39:27] <Para> JVM GCs also behave differently on different levels of Xms/Xmx settings.
[23:39:41] <Para> Some of them are just fine to fill the glass to the brim before clearing up the cruft :)
[23:42:52] *** Quits: Techcable (~Techcable@168.235.93.147) (Quit: ZNC - https://znc.in)
[23:46:37] *** Joins: Techcable (~Techcable@168.235.93.147)
