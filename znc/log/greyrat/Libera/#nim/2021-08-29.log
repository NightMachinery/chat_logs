[00:03:01] <FromDiscord> <5271> sent a code paste, see https://play.nim-lang.org/#ix=3xfm
[00:03:19] *** Joins: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com)
[00:07:21] <FromDiscord> <trenta3> sent a code paste, see https://play.nim-lang.org/#ix=3xfo
[00:09:26] <FromDiscord> <Yardanico> In reply to @5271 "how do i format": check out the strformat module
[00:10:36] <FromDiscord> <5271> okay
[00:14:31] <NimEventer> New thread by Niminem: Advice for handling circular dependencies (functions), see https://forum.nim-lang.org/t/8378
[00:19:57] *** Quits: beshr (~beshr@user/beshr) (Remote host closed the connection)
[00:23:01] <FromDiscord> <Yardanico> Does anyone know if there are any string command parsers? Something like cligen but just for strings. just want to make a telegram bot and don't want to do it myself if someone has something that's already available  :)
[00:23:25] <FromDiscord> <Yardanico> or maybe I can do that with cligen itself?
[00:31:08] *** Quits: perro (~user@072-191-245-069.res.spectrum.com) (Remote host closed the connection)
[00:33:13] <FromDiscord> <Ruggila> You can parse strings with npeg, for example. I'm just not sure what you really want, and so I don't know what I should suggest...
[00:33:35] <FromDiscord> <Ruggila> https://github.com/zevv/npeg
[00:33:37] <nrds> <12R2D299> 4GitHub: 7"PEGs for Nim, another take"
[00:37:15] <FromDiscord> <Yardanico> well, I know npeg and used it quite a lot in some other projects, but it'll still be pretty similar to doing all the parsing myself
[00:37:24] <FromDiscord> <Yardanico> I found something similar to what I need - https://github.com/iffy/nim-argparse
[00:37:25] <nrds> <12R2D299> 4GitHub: 7"Argument parsing for Nim"
[00:37:26] <FromDiscord> <Yardanico> gonna try it now
[00:44:47] <FromDiscord> <Yardanico> yeah, seems like it's exactly what I need
[00:44:56] <FromDiscord> <Yardanico> I just want CLI-like commands for my Telegram bot and argparse fits exactly
[00:56:53] <FromDiscord> <Ayy Lmao> Are asserts mainly meant for unit tests or are they meant to be used in normal code as well?
[01:05:28] <FromDiscord> <konsumlamm> they're also meant to be used in normal code
[01:05:56] <FromDiscord> <konsumlamm> for checking if invariants you have really hold etc.
[01:06:30] <FromDiscord> <Yardanico> just don't forget that `assert` is disabled with release/danger
[01:06:39] <FromDiscord> <Yardanico> there's doAssert that's always enabled though
[01:07:32] <FromDiscord> <Ayy Lmao> Sweet, thanks for the info!
[01:11:41] *** Quits: supakeen (~user@python/site-packages/supakeen) (Remote host closed the connection)
[01:12:05] *** Joins: supakeen (~user@python/site-packages/supakeen)
[01:15:46] <FromDiscord> <timotheecour> > just don't forget that assert is disabled with release/danger‚Üµnot true, only danger
[01:20:44] <arkanoid> in c2nim, #mangle are applied before or after --nep1 ?
[01:36:01] <arkanoid> I need to solve this problem via c2nim (or other solution if you know one): I have C structs with names like https://play.nim-lang.org/#ix=3xfS, if I run c2nim with --nep2 both types are converted to same string
[01:36:17] <arkanoid> s/--nep2/--nep1/
[01:56:56] <arkanoid> it would be really useful if mangle op in c2num could uppercase letter
[02:32:55] <FromDiscord> <dan> In reply to @haxscramper "Yes, that basically main": would you happen to know why the header needs to be added with the "header" keyword? i have done it without and my code correctly produces the function definition which should also link fine
[02:36:10] *** Quits: max22- (~maxime@2a01cb0883359800e683a4712f3de9f5.ipv6.abo.wanadoo.fr) (Quit: Leaving)
[02:36:20] <arkanoid> is it possible to have a function with same name of struct type in C?! Mangle madness
[02:55:28] <FromDiscord> <treeform> In reply to @dan "would you happen to": you only need to import the header once, some one else might import it for you
[02:55:53] <FromDiscord> <dan> but why do i need to import it? ü§î
[02:56:23] <FromDiscord> <dan> im wrapping all of the stuff by hand anyways and it outputs the correct definitions
[02:56:58] <FromDiscord> <dan> what is this feature actually intended for?
[02:58:56] <FromDiscord> <dan> maybe for header only libraries?
[03:30:54] <FromDiscord> <treeform> you right you might not need the header at all
[03:33:16] <arkanoid> why does c2nim writes importc pragmas wrong? It writes {.importc: "_c_type_foo".} but I have to manually correct to {.importc: "struct _c_type_foo".} to make it work. Why?
[03:47:28] <arkanoid> it's a regression bug https://github.com/nim-lang/c2nim/issues/131
[03:49:18] <arkanoid> this issue should be reopened
[04:05:23] *** Quits: flynn (~mcbloch@user/flynn) (Remote host closed the connection)
[04:06:29] *** Joins: flynn (~mcbloch@user/flynn)
[04:37:01] <madprops> About initRand seeds ... is it ok if I use them for integration tests or would the seed be different on every machine?
[04:37:13] <madprops> or is it assured to remain constant
[04:41:11] <FromDiscord> <konsumlamm> what? the point of `initRand` is that you pass the seed
[04:51:26] <arkanoid> what is the difference from a "typedef struct mystruct {...}" and "struct mystruct {...}" from nim point of view?
[04:52:04] <arkanoid> I have c2nim writing wrong cimports and I'd like to know how and if I can fix the .h
[04:52:13] <arkanoid> but I'm not a seasoned C programmer
[04:53:14] <madprops> I'm just wondering if the random implementation might change one day making seeds output a different thing eventually
[04:53:54] *** Quits: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c) (Quit: My MacBook Air has gone to sleep. ZZZzzz‚Ä¶)
[04:54:45] <FromDiscord> <konsumlamm> oh, probably not
[04:56:43] *** Quits: krux02 (~krux02@p4ff8b737.dip0.t-ipconnect.de) (Remote host closed the connection)
[04:58:44] <madprops> why is this not working in the playground, but works locally? https://play.nim-lang.org/#ix=3xgy
[04:58:48] <madprops> I don't see the echos
[05:41:30] *** Joins: neurocyte3 (~neurocyte@92.119.10.222)
[05:41:30] *** Quits: neurocyte3 (~neurocyte@92.119.10.222) (Changing host)
[05:41:30] *** Joins: neurocyte3 (~neurocyte@user/neurocyte)
[05:43:31] *** Quits: neurocyte (~neurocyte@user/neurocyte) (Ping timeout: 250 seconds)
[05:43:31] *** neurocyte3 is now known as neurocyte
[05:46:46] *** Joins: Guest78 (~Guest78@cpc105074-sgyl40-2-0-cust81.18-2.cable.virginm.net)
[05:50:48] *** Quits: Guest78 (~Guest78@cpc105074-sgyl40-2-0-cust81.18-2.cable.virginm.net) (Client Quit)
[06:05:58] *** Quits: mst (~matthewt@vps-6c71e929.vps.ovh.net) (Quit: Reconnecting)
[06:06:05] *** Joins: mst (~matthewt@vps-6c71e929.vps.ovh.net)
[06:21:28] <NimEventer> New thread by Niminem: Design choice advice for Python-to-Nim transpiler (Python Devs), see https://forum.nim-lang.org/t/8379
[06:30:06] <FromDiscord> <Peaceful Gamer> Is there an equivalent to C's `union` in nim?
[07:01:12] *** Quits: arkurious (~arkurious@user/arkurious) (Quit: Leaving)
[07:03:55] <FromDiscord> <hamidb80> In reply to @Peaceful Gamer "Is there an equivalent": https://nim-lang.org/docs/tut2.html#object-oriented-programming-object-variants
[07:05:19] <FromDiscord> <hamidb80> i don't know whether you can use to interop with C or not
[07:07:08] <FromDiscord> <hamidb80> is there any tutorials/articles about using `ref` in nim >
[07:07:11] <FromDiscord> <hamidb80> (edit) ">" => "?"
[07:08:28] <FromDiscord> <Peaceful Gamer> Oh, this should work for my use case. Thank you!
[07:24:07] <arkanoid> I've finally succeeded in wrapping all function of my target lib via lots of mangling, but now I have tons of C like function "int foo(prt Tinput, ptr Toutput)" and I'd like to turn all them into something more appropriate like "proc foo(ptr Tinput): ptr Toutput" and maybe raise exception internally if int is not OK. What's the best approach to accomplish this?
[08:03:49] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Ping timeout: 252 seconds)
[08:05:24] <FromDiscord> <hamidb80> ah
[08:05:38] <FromDiscord> <hamidb80> channels üòê
[08:07:51] <FromDiscord> <hamidb80> https://github.com/hamidb80/watch_for_files/blob/fbedd6451ff331da3288be4afae331323963ef9d/src/watch_for_files.nim#L47
[08:08:03] <FromDiscord> <hamidb80> why do my code blocks here
[08:08:30] <FromDiscord> <hamidb80> (edit) "do" => "does"
[08:08:36] <FromDiscord> <hamidb80> (edit) "blocks" => "block"
[08:10:11] <FromDiscord> <hamidb80> note: you can try `nimble test`
[08:15:01] <FromDiscord> <hamidb80> actually the thread stops here
[08:15:15] <FromDiscord> <hamidb80> without any errors
[08:20:51] <FromDiscord> <Rika> you sure tunnel isnt nil
[08:20:55] <FromDiscord> <Rika> (edit) "nil" => "nil?"
[08:36:01] *** Quits: supakeen (~user@python/site-packages/supakeen) (Quit: WeeChat 3.2)
[08:36:30] *** Joins: supakeen (~user@python/site-packages/supakeen)
[08:37:42] *** Joins: Gustavo6046 (~Gustavo60@user/gustavo6046)
[08:45:57] *** Quits: flynn (~mcbloch@user/flynn) (Read error: Connection reset by peer)
[08:47:04] *** Joins: flynn (~mcbloch@user/flynn)
[08:49:11] *** Joins: vicfred (~vicfred@user/vicfred)
[09:03:09] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Remote host closed the connection)
[09:03:39] *** Joins: Gustavo6046 (~Gustavo60@user/gustavo6046)
[09:07:36] *** Joins: Gustavo6046_ (~Gustavo60@user/gustavo6046)
[09:08:55] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Ping timeout: 250 seconds)
[09:09:54] *** Gustavo6046_ is now known as Gustavo6046
[09:13:46] <FromDiscord> <hamidb80> yes
[09:13:54] <FromDiscord> <hamidb80> see `tests/test.nim`
[11:00:22] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Remote host closed the connection)
[11:01:30] *** Joins: Gustavo6046 (~Gustavo60@user/gustavo6046)
[11:33:56] *** Joins: max22- (~maxime@2a01cb0883359800d8e17a9d5fe0c8a1.ipv6.abo.wanadoo.fr)
[11:40:17] *** Quits: vicfred (~vicfred@user/vicfred) (Quit: Leaving)
[12:37:52] *** Joins: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c)
[12:40:50] <NimEventer> New thread by Ingo: Httpclient woes, see https://forum.nim-lang.org/t/8380
[13:53:17] *** Quits: andinus (andinus@tilde.institute) (Quit: ERC (IRC client for Emacs 27.1))
[14:16:26] *** Joins: andinus (andinus@tilde.institute)
[14:34:24] *** Quits: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c) (Quit: My MacBook Air has gone to sleep. ZZZzzz‚Ä¶)
[15:21:10] *** Joins: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c)
[15:24:26] <FromDiscord> <Hamid Bluri> In reply to @NimEventer "New thread by Ingo:": "puppy triggered it in my poor old brain"
[15:30:20] <FromDiscord> <gerwy> hi, so im making a small tool, that will fetch Youtube videos and count how many tutorials are for that subject‚Üµim making it for Godot, mostly to see its growth and compare it to Unity‚Üµbut maybe i could also do it for Nim? I don't expect much tho
[15:33:24] <FromDiscord> <gerwy> currently im checking for keywords such as "tutorial", "course", "How to" and so on, in title and description of the video‚Üµbut i found a way to get video Subtitles and i will also make a more advanced search that will also look for some keywords in the generated subtitles
[15:39:00] <FromDiscord> <Yardanico> how will you actually find youtube videos?
[15:39:25] <FromDiscord> <Yardanico> their search is quite limited in terms of what you can get and it won't give you all results
[15:40:16] *** Quits: xet7 (~xet7@user/xet7) (Read error: Connection reset by peer)
[15:49:52] *** Joins: auxym_ (~francis@modemcable027.118-81-70.mc.videotron.ca)
[15:51:18] <FromDiscord> <gerwy> sent a long message, see http://ix.io/3xjo
[15:51:37] <FromDiscord> <gerwy> i could go by every month, or every two week, depends on how popular the subject is
[15:52:07] <FromDiscord> <Yardanico> well, that's not really a good way IMO, because search is pretty wonky when you try to find _all_ videos for the specific subject
[15:52:12] <FromDiscord> <Yardanico> it's next to impossible to do on youtube I'd say
[15:53:25] <FromDiscord> <Yardanico> anyway, when you do complete it, please share on the forum :)
[15:55:10] *** Quits: auxym_ (~francis@modemcable027.118-81-70.mc.videotron.ca) (Ping timeout: 252 seconds)
[15:55:40] <FromDiscord> <gerwy> well im currently thinking of making it more precise‚Üµbut its rather okay way to do it, obviously there are better ways, but i didn't found them yet‚Üµit would be far harder if i would include also tutorials made outside the youtube, fetching videos and classifying them is easier than doing it with websites i guess
[15:56:23] <FromDiscord> <Yardanico> well, you should also know that not all people like watching tutorials on youtube - they'd rather read an article or a blog post :)
[15:56:40] <FromDiscord> <Rika> Or the docs
[15:57:16] <FromDiscord> <Hamid Bluri> In reply to @hamidb80 "https://github.com/hamidb80/watch_for_files/blob/fb": should i open an issue?
[15:57:23] <FromDiscord> <gerwy> and i can also save those videos in file‚Üµyoutube's id is 11 character, so you could say its 11 bytes per video 10k videos is only 110KB
[15:57:48] <FromDiscord> <Yardanico> yes, but how is that really related
[15:58:08] <FromDiscord> <Yardanico> you still wouldn't be able to find a lot of youtube videos that don't have a lot of views
[15:58:59] <FromDiscord> <gerwy> In reply to @Yardanico "well, you should also": yeah i know that :// i like articles or reading well made docs but i also enjoy hearing someone explaining it and not like i need to read one sentence few times to really understand what the meaning of it is‚Üµand i think you will agree that Youtube is a place where there are a loot of tutorials
[15:59:09] *** Quits: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c) (Quit: My MacBook Air has gone to sleep. ZZZzzz‚Ä¶)
[15:59:32] <FromDiscord> <Yardanico> i'd also say that some languages have a higher tendency for textual representation rather than visual
[15:59:54] <FromDiscord> <Yardanico> i mean some communities are more inclined to make articles than videos, some are the opposite
[16:00:12] <FromDiscord> <gerwy> In reply to @Yardanico "you still wouldn't be": why? i can easily find videos who has like 10 views and are still tutorials or just videos making some stuff in Godot or even Nim‚Üµim literally watching video with 141 views about person learning SDL and Nim
[16:00:32] <FromDiscord> <Yardanico> because youtube is youtube, and its search would never give you all results
[16:00:42] <FromDiscord> <gerwy> unless i make it more narrow
[16:00:50] <FromDiscord> <Yardanico> you can't bruteforce all words
[16:00:55] <FromDiscord> <gerwy> like, only videos from 2017-05-01
[16:01:03] <FromDiscord> <gerwy> with keyword Nim
[16:01:32] <FromDiscord> <gerwy> if the video doesn't have Nim in title, description or even in hashtags, there is very high chance its not even about Nim so i don't even count it
[16:01:51] <FromDiscord> <gerwy> there are youtube operators, you can use them to make your search more narrow
[16:01:52] *** Joins: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c)
[16:01:53] <FromDiscord> <Yardanico> In reply to @Life Sucks "like, only videos from": except that you can't do that
[16:01:59] <FromDiscord> <gerwy> like using wildcards
[16:02:03] *** Quits: jjido (~Denis@2a02:c7f:5c91:e700:dd3f:cf6b:3c24:cb0c) (Client Quit)
[16:02:05] <FromDiscord> <gerwy> or specifying the order of words
[16:02:12] <FromDiscord> <gerwy> In reply to @Yardanico "except that you can't": i can :3
[16:02:15] <FromDiscord> <Yardanico> how?
[16:02:35] <FromDiscord> <gerwy> well it is a feature in Youtube's v3 API
[16:02:37] <FromDiscord> <gerwy> but
[16:02:39] <FromDiscord> <gerwy> im not using it
[16:02:43] <FromDiscord> <Yardanico> youtube doesn't allow you to search videos newer than specified date, and if you're using Google search to find youtube videos - believe me, even google doesn't have all of youtube videos indexed
[16:02:50] <FromDiscord> <Yardanico> as strange as that might sound
[16:02:51] <FromDiscord> <gerwy> because of that, i found out you can use Youtube search operators
[16:02:59] <FromDiscord> <gerwy> and when you do something like
[16:03:05] <FromDiscord> <Yardanico> also let's move to #offtopic
[16:03:11] <FromDiscord> <gerwy> oh okay
[16:03:19] <FromDiscord> <haxscramper> Honestly with amount of nim videos it would be faster to just hand-pick them into community list
[16:05:16] <FromDiscord> <Hamid Bluri> In reply to @hamidb80 "https://github.com/hamidb80/watch_for_files/blob/fb": it does work with passing `ptr` instead of `ref`
[16:05:56] <FromDiscord> <gerwy> In reply to @haxscramper "Honestly with amount of": thats why i said i wasn't expecting a lot :// but its different story for Godot ‚Üµi noticed a big growth of videos that came up about Godot in 2020 and in 2021 (can be about Ace Attorney idk lol)
[16:07:06] <FromDiscord> <Yardanico> @haxscramper i think you underestimate number of youtube videos a bit :)
[16:07:14] <FromDiscord> <Yardanico> nim youtube videos
[16:08:56] <FromDiscord> <haxscramper> there are that many?
[16:09:11] <FromDiscord> <haxscramper> I thought there several dozens at best, if you exclude this nim tutorial series
[16:09:15] <FromDiscord> <Yardanico> no, there are much more than that
[16:09:23] <FromDiscord> <gerwy> i think there are more than we think, they are just not as popular, they mostly have less than 1k views
[16:09:41] <FromDiscord> <haxscramper> Good to know
[16:11:34] <FromDiscord> <gerwy> i have two issues with Youtube search tho
[16:11:51] <FromDiscord> <gerwy> first is that there can't be more than 500 videos uploaded in one day, because i won't know if there is more
[16:11:58] <FromDiscord> <Yardanico> @haxscramper there are nim videos like that https://www.youtube.com/watch?v=ZJu0ljI_uUU :P
[16:12:19] <FromDiscord> <Yardanico> https://www.youtube.com/watch?v=LZJwRS9VXwQ
[16:12:42] <FromDiscord> <haxscramper> well, I was talking more about meaningful things
[16:12:49] <FromDiscord> <Yardanico> don't be rude :P
[16:13:10] <FromDiscord> <gerwy> second, idk if that happens in code, can be because i didn't tried yet but, when i type NimConf for example‚Üµit doesn't want to search for NimConf, instead it does this annoying "did you mean: MiniConf?" and doesn't include operators then and just does a default search
[16:13:15] *** Joins: xet7 (~xet7@user/xet7)
[16:13:26] *** Joins: krux02 (~krux02@p4ff8b737.dip0.t-ipconnect.de)
[16:13:42] <FromDiscord> <gerwy> btw, here is a little article about operators Yardanico‚Üµhttps://seosly.com/youtube-search-operators/
[16:13:47] <FromDiscord> <Yardanico> yeah i read that
[16:13:49] <FromDiscord> <gerwy> i took it from here
[16:13:52] <FromDiscord> <Yardanico> i know most of them already
[16:13:59] <FromDiscord> <Yardanico> because they're the same on google, also we should be in #offtopic  :)
[16:14:00] <FromDiscord> <gerwy> because i knew some of them, i didn't know there was more
[16:14:13] <FromDiscord> <gerwy> oh right i thought this is offtopic
[16:19:18] <FromDiscord> <Hamid Bluri> In reply to @Rika "you sure tunnel isnt": do `ref` types get deep copied when i pass them to another thread?
[16:20:06] <FromDiscord> <Rika> yes
[16:20:24] <FromDiscord> <Rika> `Sends a message to a thread. msg is deeply copied.`
[16:20:35] <FromDiscord> <Hamid Bluri> so i can't pass a `ref Channel[T]`
[16:20:43] <FromDiscord> <Rika> oh you mean that way
[16:21:20] <FromDiscord> <Hamid Bluri> i think compiler should give me a warning
[16:21:23] <FromDiscord> <Rika> well i think its still deep copied
[16:21:42] <FromDiscord> <Hamid Bluri> yeah it works fine with `ptr`
[16:23:54] *** Joins: jjido (~Denis@2a02:c7f:5c91:e700:75d9:8ee9:c723:ca70)
[16:24:07] <arkanoid> haxscramper, I've finally succeeded in the "last 5%" conversion process of the header file I've sent you. I've used c2nim wit lots of mangle, grep, sed and so on, but at the end it seems to work
[16:24:45] <arkanoid> I've put the whole process into a bash script
[16:24:53] <FromDiscord> <haxscramper> With c2nim it is more like 20+%, but congratulations
[16:27:10] <arkanoid> this is yeah but I had to preprocess first, just like nimterop
[16:29:27] <arkanoid> here's the final bash script https://termbin.com/f7xv
[16:33:59] <FromDiscord> <haxscramper> > `(cat - soapStub.nim | sponge soapStub.nim) <<'EOF'‚Üµtype`
[16:34:04] <arkanoid> it may be possible to skip preprocessing with some more work
[16:34:50] <arkanoid> haxscramper, yes, it was to put all the generated types into a single type section, as they are mutually recursive
[16:36:02] *** Quits: supakeen (~user@python/site-packages/supakeen) (Quit: WeeChat 3.2)
[16:36:30] *** Joins: supakeen (~user@python/site-packages/supakeen)
[16:37:11] <arkanoid> probably there are many many possible improvements, I jent went on until compilation and successfull test of one call. Surely is everything but a rigorous way to handle the code
[16:37:58] <arkanoid> I've also found a bug in c2nim on the way, I've already shared a minumum testcase
[16:39:12] <arkanoid> long story short, my work is surely proof that c2nim helps but cannot replace a tool like yours
[16:39:39] <NimEventer> New post on r/nim by WrongJudgment6: Anyone interested in making a PR adding Nim?, see https://reddit.com/r/nim/comments/pdu3d4/anyone_interested_in_making_a_pr_adding_nim/
[16:42:10] <arkanoid> what I'm missing the most in c2nim mangle engine is the possibility to uppercase a capture
[16:42:27] <arkanoid> maybe is possible, but I don't know how
[16:42:33] *** Quits: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com) (Quit: WeeChat 3.0.1)
[16:45:02] <FromDiscord> <haxscramper> You can probably make some kind of abomination that replaces a with A, b with B, c with C etc.
[16:46:03] <arkanoid> yeah I've been thinking about that, but yeah, abomination. I've added a capital T in front of every type and stop
[16:47:28] <arkanoid> "how i stopped worrying and learned to love the PEG"
[16:49:02] <arkanoid> I can schrink down the transformation rule, actually. I'm in the refactoring phase
[16:51:41] <arkanoid> would be nice if I could put string format functions in the second argument of the mangle
[16:52:37] <FromDiscord> <haxscramper> c2nim could've called to `format_logic.nims` for that
[16:53:29] <FromDiscord> <haxscramper> ACtually I should do this as well, I depend on compiler anyway, so it does not matter.
[16:53:36] <FromDiscord> <haxscramper> It didn't occur to me (until now) that I don't have to force users to compile whole `hcparse` thing, even if they use libclang variant
[16:53:39] <arkanoid> something like #mangle "^ 'foo__' {@}'_bar'" "capitalize($1) 'Bar'"
[16:55:50] <arkanoid> I've a question for you
[16:57:02] <arkanoid> as I've finally succeeded in wrapping all function of my target lib via lots of mangling I now have tons of functions like "int foo(prt Tinput, ptr Toutput)" and I'd like to turn all them into something more appropriate like "proc foo(ptr Tinput): ptr Toutput" and maybe raise exception internally if int is not OK. What's the best approach to accomplish this?
[16:58:16] <arkanoid> I could surely build a macro that does this given the ProcDef, but I need to call this on every proc defined in .nim file
[16:58:54] <arkanoid> long story short: how to parse the ast of a nim module/file at compile time?
[16:59:11] <emery> I like to use custom pragmas to dedup whatever I get from c2nim
[17:00:09] <arkanoid> emery, could you please elaborate a little? Or give example
[17:02:16] <FromDiscord> <haxscramper> `> how to parse the ast of a nim module/file at compile time?` - https://nim-lang.org/docs/macros.html#parseStmt%2Cstring
[17:02:40] <emery> arkanoid: i do stuff like this over and over, but i don't know about uppercasing https://git.sr.ht/~ehmry/nim_opusenc/tree/master/item/src/opusenc.nim#L7
[17:03:11] <FromDiscord> <haxscramper> But I doubt that's what you really need
[17:03:46] <emery> bbl
[17:04:08] <FromDiscord> <haxscramper> You can write a pragma macro that wraps raw C proc (either by creating new toplevel, or wrapping raw one inside like in emery's example)
[17:07:18] <FromDiscord> <haxscramper> Something like `{.wrapC(outArgs = [Toutput], goodInt = 0).}`
[17:07:19] <FromDiscord> <haxscramper> Or something less verbose
[17:08:51] <arkanoid> emery, that's for the link. What is $1 in importc: "ope_$1" ?
[17:10:48] <arkanoid> ok I guess $1 is the nim proc name
[17:11:44] <arkanoid> but after adding custom pragma to every proc? What's the next step to generate "modified" version for each of them at compile time?
[17:13:27] <FromDiscord> <haxscramper> Implement a macro that generates code
[17:14:21] <FromDiscord> <haxscramper> Not sure if I understand the question. You annotate all required procs with macro, and it does generate code
[17:14:21] <FromDiscord> <haxscramper> I don't think there is a way around annotating all proc arguments somehow, so that solution is as good as any
[17:14:41] <FromDiscord> <haxscramper> `s/all arguments/special arguments/`
[17:19:07] <arkanoid> sadly I can't add macro to every proc with c2nim, I could regex, or actually parseStmt the whoe nim and filter nnkProcDef
[17:24:52] *** Quits: jjido (~Denis@2a02:c7f:5c91:e700:75d9:8ee9:c723:ca70) (Quit: My MacBook Air has gone to sleep. ZZZzzz‚Ä¶)
[17:25:58] <FromDiscord> <haxscramper> There are too many procs to manually annotate? Well, I suppose there are. Yes, you can do it with `parseStmt`, though honestly it feels like a bad tool for the job, and `compiler/parser` feels like a better suited tool. https://github.com/haxscramper/hack/blob/e73fc20ce103e1a195826fc6abcc14285dda0283/testing/nim/compilerapi/visit_each_proc.nim
[17:26:28] <FromDiscord> <haxscramper> Or you can use hnimast/pnode\_parse
[17:27:39] <arkanoid> yeah but this round I prefer a compile time thing instread of generating a nim file with another program
[17:27:53] <arkanoid> how can I print a NimNode as an ast tree?
[17:28:03] <arkanoid> noob question, but I'm stuck
[17:28:43] <arkanoid> I've proc foo(n: NimNode) called from static block, the input is a filtered node from parseStmt
[17:29:29] <FromDiscord> <haxscramper> `.repr()`
[17:29:30] <FromDiscord> <haxscramper> Also `parseStmt` is exactly the same as think I've linked
[17:29:30] <FromDiscord> <haxscramper> You would have to `parseStmt()` on the whole file and then write it back
[17:31:57] <arkanoid> yeah, I'm using it because you linked it :D I'm on your answer right now
[17:32:37] <arkanoid> .repr prints the rendered AST, nim code basically. I'd like something like dumpTree
[17:37:53] <FromDiscord> <haxscramper> `.treeRepr()`
[17:41:04] <arkanoid> thanks! why did autocomplete missed it? I've this strange problem that when I move vscode window to second screen the autocomplete engine goes wild. I have to close and reopen vscode. Same thing happens after resuming from standby. Not blaming nim extension, but vscode
[17:59:12] *** Joins: arkurious (~arkurious@user/arkurious)
[19:23:04] <arkanoid> At the end I think the best solution is like emery suggested ad add a custom pragma to every proc using regex after c2nim pass
[19:25:40] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Ping timeout: 240 seconds)
[19:26:04] *** Quits: flynn (~mcbloch@user/flynn) (Read error: Connection reset by peer)
[19:27:11] *** Joins: flynn (~mcbloch@user/flynn)
[19:29:04] *** Joins: Gustavo6046 (~Gustavo60@user/gustavo6046)
[19:44:15] *** Quits: max22- (~maxime@2a01cb0883359800d8e17a9d5fe0c8a1.ipv6.abo.wanadoo.fr) (Remote host closed the connection)
[20:02:36] <NimEventer> New question by The Fool: installing the nimpretty binary, see https://stackoverflow.com/questions/68974409/installing-the-nimpretty-binary
[20:20:53] <FromDiscord> <linux user> if it was nux , much easier
[20:20:58] <FromDiscord> <linux user> (edit) "nux" => "nix"
[20:21:11] <FromDiscord> <Yardanico> wdym?
[20:21:29] <FromDiscord> <Yardanico> that guy is on debian, ubuntu or some other distro with `apt`
[20:21:56] <FromDiscord> <Yardanico> ah, probably ubuntu 20.04 LTS, it has nim 1.0.6
[20:22:34] <FromDiscord> <linux user> brruh
[20:22:54] <FromDiscord> <linux user> you can download the latest nightly build, it has nimpretty in nim1/bin
[20:23:01] <FromDiscord> <linux user> sudo cp nimpretty /bin
[20:23:03] <FromDiscord> <Yardanico> did you even read the SO post?
[20:23:13] <FromDiscord> <linux user> no
[20:23:16] <FromDiscord> <Yardanico> In reply to @richard stallmen(crazy GNU guy) "sudo cp nimpretty /bin": doing that is pretty stupid, you don't need nimpretty system-wide
[20:23:22] <FromDiscord> <Yardanico> In reply to @richard stallmen(crazy GNU guy) "you can download the": or you can just use choosenim
[20:46:13] *** Joins: stkrdknmibalz (~test@rrcs-75-87-43-226.sw.biz.rr.com)
[20:52:55] *** Joins: max22- (~maxime@2a01cb088335980041b62e3fe7894c02.ipv6.abo.wanadoo.fr)
[21:54:04] *** Quits: flynn (~mcbloch@user/flynn) (Read error: Connection reset by peer)
[21:55:11] *** Joins: flynn (~mcbloch@user/flynn)
[22:10:49] *** Quits: supakeen (~user@python/site-packages/supakeen) (Remote host closed the connection)
[22:11:14] *** Joins: supakeen (~user@python/site-packages/supakeen)
[22:20:13] *** Joins: auxym_ (~francis@modemcable027.118-81-70.mc.videotron.ca)
[22:21:51] *** Joins: Gustavo6046_ (~Gustavo60@user/gustavo6046)
[22:22:47] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Ping timeout: 240 seconds)
[22:24:17] *** Gustavo6046_ is now known as Gustavo6046
[22:29:16] *** Quits: Gustavo6046 (~Gustavo60@user/gustavo6046) (Remote host closed the connection)
[22:29:28] *** Joins: Gustavo6046 (~Gustavo60@user/gustavo6046)
[22:31:39] *** Joins: vicfred (~vicfred@user/vicfred)
[22:45:47] *** Quits: max22- (~maxime@2a01cb088335980041b62e3fe7894c02.ipv6.abo.wanadoo.fr) (Ping timeout: 240 seconds)
[22:57:24] *** Joins: neurocyte2 (~neurocyte@45.143.79.183)
[22:57:24] *** Quits: neurocyte2 (~neurocyte@45.143.79.183) (Changing host)
[22:57:24] *** Joins: neurocyte2 (~neurocyte@user/neurocyte)
[22:57:53] *** Quits: neurocyte (~neurocyte@user/neurocyte) (Ping timeout: 250 seconds)
[22:57:53] *** neurocyte2 is now known as neurocyte
[23:08:22] <FromDiscord> <Anuke> How do I pass the instantiated generic type of a generic proc to a macro? https://play.nim-lang.org/#ix=3xlX
[23:10:40] *** Joins: max22- (~maxime@2a01cb0883359800468c3975aa62b651.ipv6.abo.wanadoo.fr)
[23:24:08] <FromDiscord> <haxscramper> sent a code paste, see https://play.nim-lang.org/#ix=3xm5
[23:26:25] <FromDiscord> <Anuke> That works, thanks
[23:32:24] *** Joins: jjido (~Denis@2a02:c7f:5c91:e700:75d9:8ee9:c723:ca70)
[23:52:29] *** Quits: auxym_ (~francis@modemcable027.118-81-70.mc.videotron.ca) (Ping timeout: 250 seconds)
