[00:22:07] *** Quits: elastic_dog (~elastic_d@2a01:118f:822:9c00:f583:aa51:9ad4:d4fb) (Ping timeout: 250 seconds)
[00:27:38] *** Joins: elastic_dog (~elastic_d@2a01:118f:822:9c00:f583:aa51:9ad4:d4fb)
[00:31:54] *** Joins: lavaball (felix@31.204.155.215)
[00:59:59] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[01:18:23] *** Quits: otisolsen70 (~otisolsen@xd4ed80b5.cust.hiper.dk) (Quit: Leaving)
[01:26:39] *** Joins: Torr (~Torr@user/torr)
[01:31:10] *** Joins: _val_ (~valentin@82-169-14-137.biz.kpn.net)
[01:33:50] *** Quits: user51 (~user51@77.124.178.64) (Quit: leaving)
[01:40:14] *** Quits: Torr (~Torr@user/torr) (Ping timeout: 256 seconds)
[01:54:20] *** Joins: junebug (~junebug@2600:1700:3db0:2540:80fc:47cb:6feb:76c6)
[02:13:39] *** Quits: junebug (~junebug@2600:1700:3db0:2540:80fc:47cb:6feb:76c6) (Remote host closed the connection)
[02:14:03] *** Joins: junebug (~junebug@2600:1700:3db0:2540:4a38:f720:8759:72e3)
[02:18:25] *** Joins: Torr (~Torr@user/torr)
[02:22:44] *** Quits: Torr (~Torr@user/torr) (Ping timeout: 256 seconds)
[02:33:38] *** Quits: heiner (~Thunderbi@2a00:6020:b006:a900:d250:99ff:fe34:8fd2) (Ping timeout: 268 seconds)
[02:34:30] *** Quits: boreas (~heiner@2a00:6020:b006:a900:d250:99ff:fe34:8fd2) (Ping timeout: 260 seconds)
[02:54:04] *** Quits: junebug (~junebug@2600:1700:3db0:2540:4a38:f720:8759:72e3) (Quit: Leaving)
[02:59:24] *** Quits: demonbane (~demonbane@pool-108-54-156-90.nycmny.fios.verizon.net) (Remote host closed the connection)
[03:00:58] *** Joins: demonbane (~demonbane@pool-108-54-156-90.nycmny.fios.verizon.net)
[03:06:30] *** Joins: junebug (~junebug@2600:1700:3db0:2540:4a38:f720:8759:72e3)
[03:07:13] *** Quits: demonbane (~demonbane@pool-108-54-156-90.nycmny.fios.verizon.net) (Quit: leaving)
[03:10:46] *** Joins: demonbane (~demonbane@pool-108-54-156-90.nycmny.fios.verizon.net)
[03:24:39] *** Quits: junebug (~junebug@2600:1700:3db0:2540:4a38:f720:8759:72e3) (Quit: Leaving)
[03:47:46] *** Joins: roarde (~roarde@user/roarde)
[03:48:30] *** Quits: seninha (~chatzilla@user/seninha) (Quit: ChatZilla 0.9.93 [SeaMonkey 2.53.10.2/20220226204633])
[04:00:08] *** Joins: tirnanog (~tirnanog@user/tirnanog)
[04:02:54] *** Joins: eddof13 (~eddof13@189.178.17.205)
[04:03:53] *** Joins: Torr (~Torr@user/torr)
[04:22:10] *** Quits: eddof13 (~eddof13@189.178.17.205) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[04:22:54] *** Joins: eddof13 (~eddof13@189.178.17.205)
[04:33:48] *** Quits: eddof13 (~eddof13@189.178.17.205) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[04:46:28] *** Quits: roarde (~roarde@user/roarde) (Read error: Connection reset by peer)
[04:47:03] *** Joins: roarde (~roarde@user/roarde)
[04:49:53] *** Quits: roarde (~roarde@user/roarde) (Read error: Connection reset by peer)
[04:50:04] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 256 seconds)
[04:50:30] *** Joins: roarde (~roarde@user/roarde)
[04:51:44] *** Joins: jetchisel (jetchisel@user/jetchisel)
[05:07:00] *** Quits: defjam (~eb0t@90.210.89.170) (Ping timeout: 240 seconds)
[05:09:04] *** Joins: defjam (~eb0t@90.203.123.221)
[06:20:22] *** Joins: boreas (~heiner@94.31.85.196)
[06:22:25] *** Quits: Torr (~Torr@user/torr) (Quit: leaving)
[07:41:13] *** Quits: yuesbeez (uid458354@id-458354.tinside.irccloud.com) (Quit: Connection closed for inactivity)
[08:36:05] <pr3d4t0r> He, he, he...
[08:36:11] <pr3d4t0r> I wonder how bad this is:
[08:36:22] <pr3d4t0r> #!/usr/bin/env "$SHELL"
[08:36:59] <pr3d4t0r> On systems where users either have /bin/bash or /bin/zsh.
[08:41:16] <e36freak> how would that even work?
[08:41:29] <e36freak> the interpreter hasn't been called when the shebang stuff is done... so what's going to expand the variable?
[08:41:31] <llua> magic
[08:42:07] <pr3d4t0r> It doesn't.
[08:42:46] <pr3d4t0r> Because $SHELL is in the comment.  I'll have to write a meta wrapper/runner to detect uname, then run the shell...  maybe I'll do that.
[08:44:28] <pr3d4t0r> A recursive/virus-like shell that starts, looks at its environment.  Once it knows what it is, calls /bin/bash $* or /bin/zsh $* depending on where it runs, after setting some environment variable marker.
[08:44:31] *** Quits: roarde (~roarde@user/roarde) (Read error: Connection reset by peer)
[08:45:03] <pr3d4t0r> The script may need to look at its own code...  thinking.
[08:45:45] <llua> or stick to bash, since you claimed to only intend to use bash features. zsh isn't a superset of bash, so you will run into the differences pretty quickly
[08:46:20] <pr3d4t0r> llua: The issue is running this on machines I don't control.
[08:46:47] *** Joins: roarde (~roarde@user/roarde)
[08:46:52] <pr3d4t0r> llua: There's going to be some nerd who doesn't have admin/root privileges, is locked on zsh on the Mac, and Apple may deprecate bash altogether.
[08:46:52] *** Quits: roarde (~roarde@user/roarde) (Client Quit)
[08:46:58] <llua> then target something common between them or demand that requirements are met.
[08:47:11] <pr3d4t0r> llua: Yeah, I guess.
[08:47:19] <pr3d4t0r> llua: I still want to make it work, though.
[08:47:23] <larryv> i don't suppose you considered sticking to POSIX.
[08:49:24] <pr3d4t0r> larryv: I think that might curtail functionality even further.
[08:49:53] <pr3d4t0r> larryv: It's a good idea, though.
[08:50:01] * pr3d4t0r ponders.
[08:52:29] <pr3d4t0r> Oh, this is going to work.
[08:55:25] <larryv>  it's less featureful, sure, but its whole point is portability
[09:02:55] *** Joins: roarde (~roarde@user/roarde)
[09:11:27] *** Joins: rando25892 (~homefame@user/rando25892)
[09:17:12] <pr3d4t0r> OKi, dash is getting on the way of this working.
[09:24:58] <e36freak> lol
[09:25:11] <e36freak> pr3d4t0r: what are you trying to do? posix takes a special kind of fuckery
[09:26:55] <pr3d4t0r> e36freak: No POSIX, we're good.
[09:27:08] <e36freak> okie
[09:27:20] <e36freak> also hi, long time no chat
[09:27:22] <pr3d4t0r> I reviewed the requirements.  I only need to ensure this works on macOS regardless of whether the user has /bin/bash or /bin/zsh as default.
[09:27:24] <pr3d4t0r> e36freak: :*
[09:27:31] <pr3d4t0r> e36freak: I figured it out.
[09:27:58] <pr3d4t0r> e36freak: I'll also have it bomb on Linux.  The scripts I need are all specific to macOS.
[09:28:19] <e36freak> could probably just write for bash 3.2
[09:29:23] *** Quits: roarde (~roarde@user/roarde) (Read error: Connection reset by peer)
[09:30:25] <pr3d4t0r> e36freak: At some point Apple may remove that too.
[09:30:36] <pr3d4t0r> e36freak: Plus, I like fuckery, just a different kind.
[09:30:39] <pr3d4t0r> https://is.gd/BmWr8K [ https://gist.github.com/pr3d4t0r/097c28801464e57ead4621950d304f07 ]
[09:30:43] <pr3d4t0r> Scary shit, but it works.
[09:30:46] *** Joins: roarde (~roarde@user/roarde)
[09:30:47] <e36freak> maybe, but that sounds like a problem for future you
[09:30:50] <pr3d4t0r> And it aborts on Linux/dash :D
[09:31:00] <e36freak> if it's even a problem
[09:31:18] <pr3d4t0r> e36freak: Have a look at the gist.
[09:31:37] <e36freak> come on man, quote your shit and use "$@"
[09:31:40] <e36freak> you're better than that
[09:31:54] <e36freak> does zsh even support the function keyword? guess it must
[09:32:00] <e36freak> foo() is more portable than function foo though
[09:32:19] <larryv> it does
[09:32:48] <e36freak> SHELL could also be set to dash or csh or something else if the user so chooses
[09:37:04] <Patsie> where's the awk ?
[09:37:05] <pr3d4t0r> e36freak: I'll have to think more about what to do if the issue isn't only bash/zsh but also Linux vs macOS vs $OTHER_UNIX.
[09:37:16] * pr3d4t0r sends some awk in Patsie's way.
[09:37:33] <Patsie> that's lovely, thanks
[09:39:04] <xmb> hi pred
[09:39:18] <pr3d4t0r> xmb!!!
[09:39:28] <pr3d4t0r> OKi, mental experiment is over.
[09:39:41] <pr3d4t0r> e36freak, larryv, Patsie, xmb:  Thanks :)
[09:39:55] <pr3d4t0r> I *may* leave this in one of my scripts, just to see what happens.
[09:40:08] <e36freak> pr3d4t0r: fwiw i'd probably just check for /bin/bash or /bin/zsh over using SHELL, since SHELL can be whatever the user wants it to be regardless of what's installed
[09:40:08] <pr3d4t0r> It should work long-term.  And when it doesn't...  oh, well.
[09:40:21] <e36freak> or just check type -P bash/zsh or whatever
[09:40:31] <pr3d4t0r> e36freak: Ah, good idea.
[09:41:21] <xmb> # shells=( $( type -p bash zsh foosh ) ) ; printf '#!%s\n' "$shells"
[09:41:23] <shbot> xmb: #!/bin/bash
[09:41:51] <pr3d4t0r> e36freak: That'd imply also checking the version of macOS/Darwin, though, to decide between bash and zsh.
[09:42:01] <e36freak> not really?
[09:42:14] <e36freak> if you're writing for both you just need to check and see if one exists and then use it
[09:42:14] <xmb> bash in /usr/local/bin in os x
[09:42:46] <xmb> brew install bash installs it to /usr/local .. the orig /bin/bash is outdated
[09:42:47] <pr3d4t0r> e36freak: I can make it virus-like and, on the first pass, set the first line to the correct shell and remove all the scaffolding.
[09:42:59] <e36freak> if you want to, sure
[09:43:10] <pr3d4t0r> e36freak: Lots of toying...
[09:43:58] *** Joins: eddof13 (~eddof13@2806:102e:12:64:994e:c256:6228:a886)
[09:46:59] <pr3d4t0r> e36freak: I'll do the virus version tomorrow.
[09:47:04] <pr3d4t0r> e36freak: I should do some actual work :)
[09:47:08] <e36freak> nah
[09:47:25] <pr3d4t0r> e36freak: awk to filter the scaffolding and to tweak line 1's she-bang.
[09:51:24] *** Joins: user51 (~user51@77.124.178.64)
[09:53:49] *** Quits: Thanatermesis (~Thanaterm@191.92.148.122) (Ping timeout: 240 seconds)
[10:02:52] *** Quits: larryv (~larryv@zsh/patchmanager/larryv) (Quit: larryv)
[10:04:52] <Patsie> my latest shell wrapper to start the 'best' found awk with specific awk options and features -> http://ix.io/3RVH
[10:34:29] *** Quits: eddof13 (~eddof13@2806:102e:12:64:994e:c256:6228:a886) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[10:36:17] *** Quits: xmb (~xmb@178.197.209.111) (Read error: Connection reset by peer)
[11:13:48] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 240 seconds)
[11:33:53] <geirha> should uppercase the awk variable
[11:34:54] <Patsie> why?
[11:35:06] <Patsie> and which one?
[11:35:12] <geirha> because it's not assigned anywhere, so it's clearly meant to be passed via environment
[11:35:19] <Patsie> ah
[11:35:23] <Patsie> same with 'debug'
[11:35:43] <Patsie> but yeah
[11:35:54] <Patsie> gooid point
[11:35:56] <Patsie> good*
[11:37:21] <Patsie> any other feedback? good/bad/nice/crap ?
[11:58:42] <geirha> I'd try to avoid the unquoted expansion
[11:59:55] <Patsie> yeah, but I'm not sure how to do that properly, since it's already an array because of the gawk versions. so if you want multiple options, I can only think of passing a string in each element, which would mean unquoted expansions, of otherwise it will fail horribly
[12:00:29] <Patsie> if you have suggestions on how to do that better, I'm all ears :)
[12:00:30] <geirha> for example instead of incs being an associative array where the values can have multiple values, use a case instead    case $awkshort in mawk) incs+=( -f lib/hex.awk ) ;; gawk) incs+=( -f lib/hex.awk ) ;; ...
[12:00:36] <geirha> "$awkbin" ... "${incs[@]}"
[12:02:02] <Patsie> ok, but then how do you differentiate between incs for gawk/mawk/nawk/awk ?
[12:02:28] <Patsie> because that's what I do now: incs=( [gawk]="-flib/hex.gawk" [mawk]="-flib/hex.awk" [nawk]="-flib/hex.awk" [awk]="-flib/hex.awk" )
[12:02:55] <Patsie> and I don't think you can nest hashmaps/arrays
[12:03:15] <geirha> case $awkshort in nawk) incs+=( -f lib/some-other.awk ) ;; ...
[12:03:41] <Patsie> hmyeah, could work
[12:17:56] *** Joins: jetchisel (jetchisel@user/jetchisel)
[12:23:50] <geirha> http://ix.io/3RW5
[12:33:29] <Patsie> looks good
[12:34:23] <Patsie> only missing the nullglob, but that's easily added
[12:44:13] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 240 seconds)
[12:54:25] <geirha> I used a -e test instead
[12:54:52] *** Quits: roarde (~roarde@user/roarde) (Quit: Leaving)
[12:56:21] <Patsie> ahyeah
[13:05:51] *** Joins: lavaball (felix@31.204.155.215)
[13:23:18] *** Joins: loganlee (~Thunderbi@user/loganlee)
[13:38:25] *** Quits: loganlee (~Thunderbi@user/loganlee) (Quit: loganlee)
[13:52:44] *** Joins: xmb (~xmb@178.197.209.111)
[15:58:21] *** Joins: jetchisel (~jetchisel@user/jetchisel)
[16:08:46] *** Quits: jetchisel (~jetchisel@user/jetchisel) (Ping timeout: 250 seconds)
[16:10:43] *** Joins: jetchisel (jetchisel@user/jetchisel)
[16:20:27] *** Joins: lgc (~lgc@user/lgc)
[16:23:46] *** Quits: lgc (~lgc@user/lgc) (Client Quit)
[17:16:05] *** Joins: lord_daemon (~u0_a241@200.149.242.22)
[17:19:48] *** Quits: xmb (~xmb@178.197.209.111) (Ping timeout: 240 seconds)
[17:35:02] *** Quits: epony (epony@user/epony) (Ping timeout: 240 seconds)
[17:55:30] *** Joins: Thanatermesis (~Thanaterm@191.92.148.122)
[18:30:39] *** Joins: epony (epony@user/epony)
[18:46:05] *** Joins: nvmd (~weechat@user/nvmd)
[18:47:30] *** Quits: uuidNuniq (~weechat@222.67.5.151) (Quit: WeeChat 3.4)
[19:02:23] *** Joins: timmfoo (~timm@user/timm)
[19:02:23] *** timmfoo is now known as f00
[20:15:28] *** Quits: nvmd (~weechat@user/nvmd) (Quit: WeeChat 3.4)
[20:20:10] *** Joins: nvmd (~weechat@user/nvmd)
[20:36:16] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[20:52:27] *** Joins: xmb (~xmb@178.197.205.100)
[21:02:09] *** Quits: lord_daemon (~u0_a241@200.149.242.22) (Ping timeout: 256 seconds)
[21:05:49] *** Joins: lord_daemon (~u0_a241@200.149.242.22)
[21:06:23] *** Quits: epony (epony@user/epony) (Read error: Connection reset by peer)
[21:07:05] *** Joins: epony (epony@user/epony)
[21:15:44] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 252 seconds)
[21:25:01] *** Joins: jetchisel (jetchisel@user/jetchisel)
[21:33:58] *** Joins: treble (~treble@user/treble)
[21:50:34] *** Quits: lord_daemon (~u0_a241@200.149.242.22) (Read error: Connection reset by peer)
[21:53:46] *** Joins: lord_daemon (~u0_a241@200.149.242.22)
[22:15:36] *** Joins: lavaball (felix@31.204.155.215)
[22:26:35] *** Joins: seninha (~chatzilla@user/seninha)
[22:38:47] *** Joins: larryv (~larryv@zsh/patchmanager/larryv)
[22:39:15] *** Quits: lavaball (felix@31.204.155.215) (Remote host closed the connection)
[22:46:17] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 240 seconds)
[22:48:27] *** Joins: jetchisel (jetchisel@user/jetchisel)
[22:53:05] *** Quits: jetchisel (jetchisel@user/jetchisel) (Ping timeout: 252 seconds)
[22:54:53] *** Joins: jetchisel (jetchisel@user/jetchisel)
[23:02:38] *** Quits: lord_daemon (~u0_a241@200.149.242.22) (Quit: :))
[23:07:01] *** Joins: user51_ (~user51@77.124.35.94)
[23:08:32] *** Quits: user51 (~user51@77.124.178.64) (Ping timeout: 272 seconds)
[23:48:53] <Patsie> any thoughts? (and prayers) -> http://awk.patsie.nl/stars.mp4
