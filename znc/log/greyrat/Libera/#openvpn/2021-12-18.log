[00:09:43] *** Joins: adeliktas (~adeliktas@i59F52741.versanet.de)
[00:18:32] *** Quits: adeliktas (~adeliktas@i59F52741.versanet.de) (Quit: Client closed)
[00:33:55] *** Joins: adeliktas (~adeliktas@2001:16b8:22a8:8d00:98a5:dadf:3482:ec11)
[02:22:28] *** Joins: vlm (~vlm@user/vlm)
[03:43:04] *** Quits: adeliktas (~adeliktas@2001:16b8:22a8:8d00:98a5:dadf:3482:ec11) (Quit: Client closed)
[03:43:42] *** Joins: adeliktas (~adeliktas@i59F52741.versanet.de)
[04:36:29] *** Joins: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net)
[05:30:25] *** Quits: vlm (~vlm@user/vlm) (Quit: "")
[05:32:09] *** Quits: xx (~xx@user/xx) (Ping timeout: 256 seconds)
[06:42:19] *** Quits: adeliktas (~adeliktas@i59F52741.versanet.de) (Ping timeout: 256 seconds)
[06:42:55] *** Joins: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2)
[06:59:53] *** Quits: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net) (Quit: Ex-Chat)
[07:51:22] *** Joins: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net)
[08:07:37] *** Quits: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net) (Quit: Ex-Chat)
[08:36:57] *** Quits: dtman34 (~dtman34@c-73-62-246-247.hsd1.mn.comcast.net) (Ping timeout: 240 seconds)
[08:39:34] *** Joins: dtman34 (~dtman34@c-73-62-246-247.hsd1.mn.comcast.net)
[09:02:51] *** Quits: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2) (Ping timeout: 256 seconds)
[09:10:29] *** Quits: gast0n (~g4570n@user/gast0n) (Quit: Bye, see you soon! ðŸ‘‹)
[09:17:15] *** Joins: jayray (~jayray@user/jayray)
[11:02:44] *** Joins: nerozero (~nerozero@87.253.63.54)
[12:17:42] *** Joins: Snegodick (~ne@user/Snegodick)
[12:19:15] *** Quits: Snegodick (~ne@user/Snegodick) (Client Quit)
[12:34:42] *** Joins: xx (~xx@user/xx)
[13:18:57] *** Quits: Colt (~Colt@user/colt) (Quit: Leaving)
[13:19:14] *** Joins: Colt (~Colt@user/colt)
[13:43:15] *** Quits: Furai (~Furai@cookiehoster.furai.pl) (Remote host closed the connection)
[13:44:19] *** Joins: Furai (~Furai@cookiehoster.furai.pl)
[14:30:13] *** Quits: csrf (~csrf@user/csrf) (Quit: ZNC 1.7.2+deb3 - https://znc.in)
[14:30:59] *** Joins: csrf (~csrf@user/csrf)
[14:59:52] *** Quits: Colty (Miramar-FL@user/host-pond) (Excess Flood)
[15:01:55] *** Joins: Colti (Miramar-FL@user/host-pond)
[16:52:46] *** Joins: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2)
[16:59:53] *** Joins: renihs (~renihs@81.4.121.14)
[17:04:18] <renihs> hmm on 2.5.4. i fail to setup tun devices as unprivileged user (tap0 works with workaround setting it up outside of openvpn), but without a "server 10.10.10.0 255.255.255.0" (or like) line it fails to start -> thus i cannot set the tun0 connection up outside like with tap... the process has CAP_NET_ADMIN among other things (CAP_IPC_LOCK CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW CAP_SETGID CAP_SETUID CAP_SYS_CHROOT CAP_DAC_OVERRIDE CAP_AUDIT_WRITE), but 
[17:04:18] <renihs> still it fails...
[17:04:42] <renihs> am i missing something obvious here? 
[17:12:42] <renihs> ah... selinux ... 
[17:12:52] <renihs> and it really doesnt want to allow sockets it seems
[17:15:20] <renihs> but selinux has no problem when openvpn runs as root ... ah well, once more to be set to permissive so sane configs can be run :)
[17:18:53] <renihs> hmm still fails when setting up tun0 with permission denied 
[17:51:43] *** Joins: Kruppt (~Kruppt@50-111-47-206.drhm.nc.frontiernet.net)
[17:53:25] <BtbN> Normal users cannot create tun devices unless you explicitly gave them the NET_ADMIN capability. Which'd be a bad idea.
[17:55:22] <renihs> that is what openvpn does for 2.5 -> movig to netlink 
[17:55:50] <renihs> but it seems it doesnt work, in 2.5 one cant run a tun device as unprviliedged openvpn user
[17:56:03] <renihs> NET_ADMIN is the lesser evil then running openvpn as root
[17:56:08] <renihs> would be 
[17:56:39] <renihs> also, i traced openvpn when running as root, observing the capabilities it uses -> and none are missing 
[17:57:08] <renihs> but when running as unpriviledged it will result in 
[17:57:10] <renihs> net_iface_mtu_set: mtu 1500 for tun0
[17:57:10] <renihs> sitnl_send: rtnl: generic error (-1): Operation not permitted
[17:57:10] <renihs> Linux can't set mtu (1500) on tun0
[17:57:20] <renihs> the device can be setup etc, somehow mtu fails for whatever resaon
[17:58:43] <renihs> i would prep the tun0 environment as root (for the user openvpn) before, but its not possible because for some reason, when it comes to tun (that works for tap), openvpn *needs* the "server <network> <mask>" line -> it wants/needs to setup the ips itself or it fails
[18:00:25] <renihs> finding lots of posts around the worl, since 2.5 that seems broken for everyone, kinda odd ... 
[18:00:46] <renihs> seems like most people run openvpn as root... which *really is a very, very bad idea* :)
[18:01:16] <renihs> or are on 2.4.x :)
[18:01:16] <rob0> Generally the preferred way with openvpn is to run as root and downgrade to --user/--group.  With --persist-* settings that works.
[18:01:56] <renihs> rob0: hmm --persist-* settings? 
[18:02:08] <renihs> got a link/pointer for me, dunno what you mean by that 
[18:04:14] <rob0> -tun, -key, specifically, https://build.openvpn.net/man/openvpn-2.5/openvpn.8.html
[18:05:52] <renihs> hmm will look into that, thx
[18:06:05] <renihs> not sure if i see what you mean on first glimpse though
[18:06:22] <renihs> (i do create the tun0 with --mktun	and --user)
[18:07:32] <rob0> ok, I am not sure why that would not work.
[18:08:48] <rob0> you should not need --persist-tun when the --user owns it (or has RW permission.)
[18:13:12] <renihs> hmm hmm yeah, i have tried quit a bit to migrate my old setup to 2.5 but ... took me a while to realise that it was moved from iproute2 -> netlink
[18:13:28] <renihs> but somehow the capabilities dont sufifce to set it up (tun0 only)
[18:14:10] <renihs> ah well, giving up for now, will try later, would be curious if anyone has running a tun mode in 2.5 running as user/openvpn
[18:27:16] <renihs> hmm actually, /dev/net/tun0 is root:root and worldwriteable when created with /usr/sbin/openvpn --mktun --dev tun0 --dev-type tun --user openvpn --group openvpn
[18:27:16] <rob0> of course even if the user owns the tun device, NET_ADMIN is needed for addresses and routs
[18:27:49] <renihs> yeah it has CAP_IPC_LOCK CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW CAP_SETGID CAP_SETUID CAP_SYS_CHROOT CAP_DAC_OVERRIDE CAP_AUDIT_WRITE
[18:40:14] <renihs> i fear this is some combination of networkmanager and openvpn or something 
[18:42:37] <renihs> meh, thats not the issue either, well, dont think i can run tun with 2.5.4 :(
[18:45:30] <renihs> if only i could remove the server line and set it up around ...but Options error: --ifconfig-pool/--ifconfig-pool-persist requires --mode server :)
[18:54:51] <rob0> --mode server is part of the --server macro
[18:55:21] <rob0> if the macro's settings are not appropriate you have to use --mode
[18:59:23] *** Quits: ionface (~ionface@user/ionface) (Ping timeout: 252 seconds)
[19:00:15] <renihs> yeah, still, i fail to understand the permission denied, it has all the capabilities (even more then need as far as i can tell) as when it runs as root 
[19:00:32] <renihs> used brendan greggs "capable" too to trace (https://www.brendangregg.com/blog/2016-10-01/linux-bcc-security-capabilities.html)
[19:00:47] <renihs> it should work in my (limited) understanding 
[19:01:57] <renihs> i suppose i will have to downgrade to 2.4 or like, just trying/toying with fedora (35) where 2.5 is default 
[19:51:21] *** Joins: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net)
[19:59:33] *** Quits: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net) (Quit: Ex-Chat)
[20:35:13] *** Joins: ionface (~ionface@user/ionface)
[20:39:50] *** Joins: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net)
[20:41:33] *** Quits: ionface (~ionface@user/ionface) (Ping timeout: 268 seconds)
[20:46:24] *** Joins: ionface (~ionface@user/ionface)
[20:47:40] *** Quits: ionface (~ionface@user/ionface) (Remote host closed the connection)
[21:02:04] *** Quits: xx (~xx@user/xx) (Ping timeout: 256 seconds)
[21:03:29] *** Joins: voltron (~voltrin_@ip4d16bdc6.dynamic.kabel-deutschland.de)
[21:29:39] *** Quits: Merixer (~Merixer@46.252.5.153) (Ping timeout: 268 seconds)
[21:32:53] *** Joins: becm (~becm@55d43653.access.ecotel.net)
[22:02:58] *** Quits: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2) (Quit: Client closed)
[22:06:04] *** Quits: eelstrebor (~eelstrebo@198-178-29-136.scb.ne.static.allophone.net) (Quit: Ex-Chat)
[22:12:49] *** Joins: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2)
[22:34:37] *** Quits: voltron (~voltrin_@ip4d16bdc6.dynamic.kabel-deutschland.de) (Ping timeout: 240 seconds)
[23:33:15] *** Quits: adeliktas (~adeliktas@2001:16b8:22df:8100:ea0c:12d7:58ca:e4e2) (Ping timeout: 256 seconds)
[23:33:18] *** Joins: voltron (~voltrin_@ip4d16bdc6.dynamic.kabel-deutschland.de)
[23:45:43] *** Quits: voltron (~voltrin_@ip4d16bdc6.dynamic.kabel-deutschland.de) (Remote host closed the connection)
